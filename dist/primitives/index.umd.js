(function(l,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("react"),require("sanitize-html"),require("@stitches/react"),require("hls.js")):typeof define=="function"&&define.amd?define(["exports","react","sanitize-html","@stitches/react","hls.js"],n):(l=typeof globalThis<"u"?globalThis:l||self,n(l.CloverIIIFPrimitives={},l.React,l.sanitizeHtml,l.react,l.Hls))})(this,function(l,n,K,U,h){"use strict";const $=(e,t="none")=>{if(!e)return null;if(typeof e=="string")return[e];if(!e[t]){const r=Object.getOwnPropertyNames(e);if(r.length>0)return e[r[0]]}return!e[t]||!Array.isArray(e[t])?null:e[t]},v=(e,t="none",r=", ")=>{const s=$(e,t);return Array.isArray(s)?s.join(`${r}`):s};function B(e){return{__html:J(e)}}function f(e,t){const r=Object.keys(e).filter(i=>t.includes(i)?null:i),s=new Object;return r.forEach(i=>{s[i]=e[i]}),s}function J(e){return K(e,{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})}const M=209,Q={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:`hsl(${M} 100% 38.2%)`,accentMuted:`hsl(${M} 80% 61.8%)`,accentAlt:`hsl(${M} 80% 30%)`,secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},X={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:d,css:pe,keyframes:fe,createTheme:ve}=U.createStitches({theme:Q,media:X}),Y=d("span",{}),P=e=>{const{as:t,label:r}=e,i=f(e,["as","label"]);return n.createElement(Y,{as:t,...i},v(r,i.lang))},Z=(e,t="200,",r="full")=>{Array.isArray(e)&&(e=e[0]);const{id:s,service:i}=e;let a;if(!i)return s;if(Array.isArray(e.service)&&e.service.length>0&&(a=i[0]),a){if(a["@id"])return`${a["@id"]}/${r}/${t}/0/default.jpg`;if(a.id)return`${a.id}/${r}/${t}/0/default.jpg`}},L=d("img",{objectFit:"cover"}),k=e=>{const t=n.useRef(null),{contentResource:r,altAsLabel:s,region:i="full"}=e;let a;s&&(a=v(s));const p=f(e,["contentResource","altAsLabel"]),{type:y,id:m,width:T=200,height:V=200,duration:g}=r;n.useEffect(()=>{if(!m&&!t.current||["Image"].includes(y)||!m.includes("m3u8"))return;const u=new h;return t.current&&(u.attachMedia(t.current),u.on(h.Events.MEDIA_ATTACHED,function(){u.loadSource(m)})),u.on(h.Events.ERROR,function(x,E){if(E.fatal)switch(E.type){case h.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${x} network error encountered, try to recover`),u.startLoad();break;case h.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${x} media error encountered, try to recover`),u.recoverMediaError();break;default:u.destroy();break}}),()=>{u&&(u.detachMedia(),u.destroy())}},[m,y]);const A=n.useCallback(()=>{if(!t.current)return;let u=0,x=30;if(g&&(x=g),!m.split("#t=")&&g&&(u=g*.1),m.split("#t=").pop()){const G=m.split("#t=").pop();G&&(u=parseInt(G.split(",")[0]))}const E=t.current;E.autoplay=!0,E.currentTime=u,setTimeout(()=>A(),x*1e3)},[g,m]);n.useEffect(()=>A(),[A]);const de=Z(r,`${T},${V}`,i);switch(y){case"Image":return n.createElement(L,{as:"img",alt:a,css:{width:T,height:V},key:m,src:de,...p});case"Video":return n.createElement(L,{as:"video",css:{width:T,height:V},disablePictureInPicture:!0,key:m,loop:!0,muted:!0,onPause:A,ref:t,src:m});default:return console.warn(`Resource type: ${y} is not valid or not yet supported in Primitives.`),n.createElement(n.Fragment,null)}},R=d("a",{}),F=e=>{const{children:t,homepage:r}=e,i=f(e,["children","homepage"]);return n.createElement(n.Fragment,null,r&&r.map(a=>{const o=v(a.label,i.lang);return n.createElement(R,{"aria-label":t?o:void 0,href:a.id,key:a.id,...i},t||o)}))},ee={delimiter:", "},w=n.createContext(void 0),I=()=>{const e=n.useContext(w);if(e===void 0)throw new Error("usePrimitivesContext must be used with a PrimitivesProvider");return e},C=({children:e,initialState:t=ee})=>{const r=te(t,"delimiter");return n.createElement(w.Provider,{value:{delimiter:r}},e)},te=(e,t)=>Object.hasOwn(e,t)?e[t].toString():void 0,ne=d("span",{}),j=e=>{const{as:t,markup:r}=e,{delimiter:s}=I();if(!r)return n.createElement(n.Fragment,null);const a=f(e,["as","markup"]),o=B(v(r,a.lang,s));return n.createElement(ne,{as:t,...a,dangerouslySetInnerHTML:o})},b=e=>n.useContext(w)?n.createElement(j,{...e}):n.createElement(C,null,n.createElement(j,{...e})),O=({as:e="dd",lang:t,value:r})=>n.createElement(b,{markup:r,as:e,lang:t}),re=d("span",{}),ae=({as:e="dd",customValueContent:t,lang:r,value:s})=>{var o;const{delimiter:i}=I(),a=(o=$(s,r))==null?void 0:o.map(p=>n.cloneElement(t,{value:p}));return n.createElement(re,{as:e,lang:r},a==null?void 0:a.map((p,y)=>[y>0&&`${i}`,n.createElement(n.Fragment,{key:y},p)]))},S=e=>{var p;const{item:t,lang:r,customValueContent:s}=e,{label:i,value:a}=t,o=(p=v(i))==null?void 0:p.replace(" ","-").toLowerCase();return n.createElement("div",{role:"group","data-label":o},n.createElement(P,{as:"dt",label:i,lang:r}),s?n.createElement(ae,{as:"dd",customValueContent:s,value:a,lang:r}):n.createElement(O,{as:"dd",value:a,lang:r}))},q=(e,t)=>Object.hasOwn(e,t)?e[t].toString():void 0;function ie(e,t){const r=t.filter(s=>{const{matchingLabel:i}=s,a=Object.keys(s.matchingLabel)[0],o=v(i,a);if(v(e,a)===o)return!0}).map(s=>s.Content);if(Array.isArray(r))return r[0]}const se=d("dl",{}),z=e=>{const{as:t,customValueContent:r,metadata:s}=e;if(!Array.isArray(s))return n.createElement(n.Fragment,null);const i=q(e,"customValueDelimiter"),o=f(e,["as","customValueContent","customValueDelimiter","metadata"]);return n.createElement(C,{...typeof i=="string"?{initialState:{delimiter:i}}:void 0},s.length>0&&n.createElement(se,{as:t,...o},s.map((p,y)=>{const m=r?ie(p.label,r):void 0;return n.createElement(S,{customValueContent:m,item:p,key:y,lang:o==null?void 0:o.lang})})))},oe=d("li",{}),le=d("ul",{}),D=e=>{const{as:t,partOf:r}=e,i=f(e,["as","partOf"]);return n.createElement(le,{as:t},r&&r.map(a=>{const o=a.label?v(a.label,i.lang):void 0;return n.createElement(oe,{key:a.id},n.createElement("a",{href:a.id,...i},o||a.id))}))},ue=d("dl",{}),_=e=>{const{as:t,requiredStatement:r}=e;if(!r)return n.createElement(n.Fragment,null);const s=q(e,"customValueDelimiter"),a=f(e,["as","customValueDelimiter","requiredStatement"]);return n.createElement(C,{...typeof s=="string"?{initialState:{delimiter:s}}:void 0},n.createElement(ue,{as:t,...a},n.createElement(S,{item:r,lang:a.lang})))},ce=d("li",{}),me=d("ul",{}),H=e=>{const{as:t,seeAlso:r}=e,i=f(e,["as","seeAlso"]);return n.createElement(me,{as:t},r&&r.map(a=>{const o=v(a.label,i.lang);return n.createElement(ce,{key:a.id},n.createElement("a",{href:a.id,...i},o||a.id))}))},W=e=>{const{as:t,summary:r}=e,i=f(e,["as","customValueDelimiter","summary"]);return n.createElement(b,{as:t,markup:r,...i})},N=e=>{const{thumbnail:t,region:r}=e,i=f(e,["thumbnail"]);return n.createElement(n.Fragment,null,t&&t.map(a=>n.createElement(k,{contentResource:a,key:a.id,region:r,...i})))},c=()=>(console.log("Use dot notation to access Primitives.*, ex: Primitives.Label"),null);c.ContentResource=k,c.Homepage=F,c.Label=P,c.Markup=b,c.Metadata=z,c.MetadataItem=S,c.PartOf=D,c.RequiredStatement=_,c.SeeAlso=H,c.Summary=W,c.Thumbnail=N,c.Value=O,l.ContentResource=k,l.Homepage=F,l.Label=P,l.Markup=b,l.Metadata=z,l.MetadataItem=S,l.PartOf=D,l.RequiredStatement=_,l.SeeAlso=H,l.Summary=W,l.Thumbnail=N,l.Value=O,l.default=c,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=index.umd.js.map
