{"version":3,"file":"index.umd.js","sources":["../../src/lib/utils.ts","../../src/context/viewer-context.tsx","../../src/hooks/use-iiif/getAnnotationResources.ts","../../src/hooks/use-iiif/getCanvasByCriteria.ts","../../src/hooks/use-iiif/getLabel.ts","../../src/hooks/use-iiif/getPaintingResource.ts","../../src/hooks/use-iiif/getThumbnail.ts","../../src/lib/openseadragon-svg.ts","../../src/lib/annotation-helpers.ts","../../src/lib/openseadragon-helpers.ts","../../src/styles/stitches.config.tsx","../../src/components/Viewer/Viewer/ErrorFallback.styled.tsx","../../src/components/Viewer/Viewer/ErrorFallback.tsx","../../src/components/Viewer/Viewer/Viewer.styled.tsx","../../src/components/Viewer/InformationPanel/InformationPanel.styled.tsx","../../src/components/Viewer/InformationPanel/Annotation/Item.styled.tsx","../../src/components/Viewer/InformationPanel/Annotation/PlainText.tsx","../../src/components/Viewer/InformationPanel/Annotation/HTML.tsx","../../src/hooks/use-webvtt.ts","../../src/components/Viewer/InformationPanel/Annotation/VTT/Cue.styled.tsx","../../src/components/Viewer/InformationPanel/Annotation/VTT/Cue.tsx","../../src/components/Viewer/InformationPanel/Menu.styled.tsx","../../src/components/Viewer/InformationPanel/Menu.tsx","../../src/components/Viewer/InformationPanel/Annotation/VTT/VTT.tsx","../../src/components/Viewer/InformationPanel/Annotation/Image.tsx","../../src/components/Viewer/InformationPanel/Annotation/Item.tsx","../../src/components/Viewer/InformationPanel/Annotation/Page.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/Item.styled.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/PlainText.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/Item.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/Page.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/ContentSearchForm.tsx","../../src/components/Viewer/InformationPanel/ContentSearch/ContentSearch.tsx","../../src/components/Viewer/InformationPanel/About/About.styled.ts","../../src/lib/label-helpers.ts","../../src/lib/html-element.ts","../../src/components/Primitives/Label/Label.tsx","../../src/hooks/useGetImageResource.ts","../../src/components/Primitives/ContentResource/ContentResource.tsx","../../src/components/Primitives/Homepage/Homepage.tsx","../../src/context/primitives-context.tsx","../../src/components/Primitives/Markup/Markup.tsx","../../src/components/Primitives/Value/Value.tsx","../../src/components/Primitives/Value/CustomValue.tsx","../../src/components/Primitives/Metadata/Item.tsx","../../src/lib/custom.ts","../../src/components/Primitives/Metadata/Metadata.tsx","../../src/components/Primitives/PartOf/PartOf.tsx","../../src/components/Primitives/RequiredStatement/RequiredStatement.tsx","../../src/components/Primitives/SeeAlso/SeeAlso.tsx","../../src/components/Primitives/Summary/Summary.tsx","../../src/components/Primitives/Thumbnail/Thumbnail.tsx","../../src/components/Viewer/Properties/Homepage.tsx","../../src/components/Viewer/Properties/Id.tsx","../../src/components/Viewer/Properties/Metadata.tsx","../../src/components/Viewer/Properties/RequiredStatement.tsx","../../src/components/Viewer/Properties/Rights.tsx","../../src/components/Viewer/Properties/SeeAlso.tsx","../../src/components/Viewer/Properties/Summary.tsx","../../src/components/Viewer/Properties/Thumbnail.tsx","../../src/components/Viewer/InformationPanel/About/About.tsx","../../src/components/Viewer/InformationPanel/InformationPanel.tsx","../../src/components/Viewer/Media/Controls.styled.tsx","../../src/hooks/useKeyPress.ts","../../src/components/Viewer/Media/Controls.tsx","../../src/components/Viewer/Media/Media.styled.tsx","../../src/components/internal/Icons/Add.tsx","../../src/components/internal/Icons/Audio.tsx","../../src/components/internal/Icons/Close.tsx","../../src/components/internal/Icons/Image.tsx","../../src/components/internal/Icons/Video.tsx","../../src/components/internal/Icon/Icon.styled.tsx","../../src/components/internal/Icon/Icon.tsx","../../src/components/internal/Popover/Popover.styled.tsx","../../src/components/internal/Popover/Popover.tsx","../../src/components/internal/Tag/Tag.tsx","../../src/components/Viewer/Media/Thumbnail.styled.tsx","../../src/components/Viewer/Media/Thumbnail.tsx","../../src/hooks/use-iiif/getResourceType.ts","../../src/components/Viewer/Media/Media.tsx","../../src/components/Viewer/Painting/Placeholder.styled.tsx","../../src/components/Viewer/ImageViewer/Button.styled.tsx","../../src/components/Viewer/Painting/Toggle.styled.ts","../../src/components/Viewer/Painting/Painting.styled.tsx","../../src/components/internal/Select/Select.styled.tsx","../../src/components/internal/Select/Icon.tsx","../../src/components/internal/Select/Select.tsx","../../src/components/internal/Select/Option.tsx","../../src/components/Viewer/ImageViewer/ImageViewer.styled.tsx","../../src/components/Viewer/ImageViewer/Button.tsx","../../src/components/Viewer/ImageViewer/Controls.styled.tsx","../../src/components/Viewer/ImageViewer/Controls.tsx","../../src/lib/iiif.ts","../../src/components/Viewer/ImageViewer/OSD.tsx","../../src/components/Viewer/ImageViewer/ImageViewer.tsx","../../src/components/Viewer/Painting/Placeholder.tsx","../../src/components/Viewer/Player/AudioVisualizer.styled.tsx","../../src/components/Viewer/Player/AudioVisualizer.tsx","../../src/components/Viewer/Player/Player.styled.tsx","../../src/components/Viewer/Player/Track.tsx","../../src/components/Viewer/Player/Player.tsx","../../src/components/Viewer/Painting/Toggle.tsx","../../src/components/Viewer/Painting/Painting.tsx","../../src/components/Viewer/Viewer/Content.tsx","../../src/components/Viewer/Viewer/Header.styled.ts","../../src/components/Viewer/Collection/Collection.tsx","../../src/hooks/useCopyToClipboard.ts","../../src/components/Viewer/CopyText.tsx","../../src/components/Viewer/Viewer/IIIFBadge.tsx","../../src/components/Viewer/Viewer/Toggle.styled.ts","../../src/components/Viewer/Viewer/Toggle.tsx","../../src/hooks/useMediaQuery.ts","../../src/components/Viewer/Viewer/Header.tsx","../../src/hooks/useBodyLocked.ts","../../src/components/Viewer/Viewer/Viewer.tsx","../../src/lib/xhr.ts","../../src/components/Viewer/index.tsx"],"sourcesContent":["export const cleanTime = (standardNotation: string) => {\n  const array = standardNotation.toString().split(\":\");\n  const hours: number = Math.ceil(parseInt(array[0]));\n  const minutes: number = Math.ceil(parseInt(array[1]));\n  const seconds: string = zeroPad(Math.ceil(parseInt(array[2])), 2);\n\n  // Insure time with Hours is formatted as \"HH:MM:SS\"\n  const formattedMinutes =\n    hours !== 0 && minutes < 10 ? (minutes + \"\").padStart(2, \"0\") : minutes;\n\n  let time: string = `${formattedMinutes}:${seconds}`;\n\n  if (hours !== 0) {\n    time = `${hours}:${time}`;\n  }\n\n  return time;\n};\n\nexport const convertTime = (duration: number) => {\n  const standardNotation: string = new Date(duration * 1000)\n    .toISOString()\n    .substr(11, 8);\n  return cleanTime(standardNotation);\n};\n\nexport const convertTimeToSeconds = (standardNotation: string) => {\n  const hms: Array<string> = standardNotation.split(\":\");\n  const seconds: number = +hms[0] * 60 * 60 + +hms[1] * 60 + +hms[2];\n  return seconds;\n};\n\nexport const deepMerge = (target, source) => {\n  if (typeof target !== \"object\" || target === null) {\n    return source;\n  }\n\n  for (const key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      target[key] = deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n};\n\nexport const getRealPropertyValue = (\n  obj: { [key: string]: any },\n  property: string,\n) => {\n  const value = Object.hasOwn(obj, property)\n    ? obj[property].toString()\n    : undefined;\n  return value;\n};\n\nconst zeroPad = (num: number, places: number) =>\n  String(num).padStart(places, \"0\");\n","import React, { useReducer } from \"react\";\n\nimport { CollectionNormalized } from \"@iiif/presentation-3\";\nimport { IncomingHttpHeaders } from \"http\";\nimport OpenSeadragon, { Options as OpenSeadragonOptions } from \"openseadragon\";\nimport { Vault } from \"@iiif/vault\";\nimport { deepMerge } from \"src/lib/utils\";\n\nexport type ViewerConfigOptions = {\n  annotationOverlays?: {\n    backgroundColor?: string;\n    borderColor?: string;\n    borderType?: string;\n    borderWidth?: string;\n    opacity?: string;\n    renderOverlays?: boolean;\n    zoomLevel?: number;\n  };\n  background?: string;\n  canvasBackgroundColor?: string;\n  canvasHeight?: string;\n  contentSearch?: {\n    searchResultsLimit?: number;\n  };\n  ignoreCaptionLabels?: string[];\n  informationPanel?: {\n    open?: boolean;\n    renderAbout?: boolean;\n    renderSupplementing?: boolean;\n    renderToggle?: boolean;\n    renderAnnotation?: boolean;\n    renderContentSearch?: boolean;\n  };\n  openSeadragon?: OpenSeadragonOptions;\n  requestHeaders?: IncomingHttpHeaders;\n  showIIIFBadge?: boolean;\n  showTitle?: boolean;\n  withCredentials?: boolean;\n  localeText?: {\n    contentSearch?: {\n      tabLabel?: string;\n      formPlaceholder?: string;\n      noSearchResults?: string;\n      loading?: string;\n      moreResults?: string;\n    };\n  };\n};\n\nconst defaultConfigOptions = {\n  annotationOverlays: {\n    backgroundColor: \"#ff6666\",\n    borderColor: \"#990000\",\n    borderType: \"solid\",\n    borderWidth: \"1px\",\n    opacity: \"0.5\",\n    renderOverlays: true,\n    zoomLevel: 2,\n  },\n  background: \"transparent\",\n  canvasBackgroundColor: \"#6662\",\n  canvasHeight: \"61.8vh\",\n  contentSearch: {\n    searchResultsLimit: 20,\n  },\n  ignoreCaptionLabels: [],\n  informationPanel: {\n    open: true,\n    renderAbout: true,\n    renderSupplementing: true,\n    renderToggle: true,\n    renderAnnotation: true,\n    renderContentSearch: true,\n  },\n  openSeadragon: {},\n  requestHeaders: { \"Content-Type\": \"application/json\" },\n  showIIIFBadge: true,\n  showTitle: true,\n  withCredentials: false,\n  localeText: {\n    contentSearch: {\n      tabLabel: \"Search Results\",\n      formPlaceholder: \"Enter search words\",\n      noSearchResults: \"No search results\",\n      loading: \"Loading...\",\n      moreResults: \"more results\",\n    },\n  },\n};\n\nexport type CustomDisplay = {\n  display: {\n    component: React.ElementType;\n    componentProps?: Record<string, unknown>;\n  };\n  target: {\n    canvasId?: string[];\n    paintingFormat?: string[];\n  };\n};\n\nexport interface ViewerContextStore {\n  activeCanvas: string;\n  activeManifest: string;\n  collection?: CollectionNormalized | Record<string, never>;\n  configOptions: ViewerConfigOptions;\n  customDisplays: Array<CustomDisplay>;\n  informationOpen: boolean;\n  isLoaded: boolean;\n  vault: Vault;\n  contentSearchVault: Vault;\n  openSeadragonViewer: OpenSeadragon.Viewer | null;\n}\n\nexport interface ViewerAction {\n  type: string;\n  canvasId: string;\n  collection: CollectionNormalized;\n  configOptions: ViewerConfigOptions;\n  informationOpen: boolean;\n  isLoaded: boolean;\n  manifestId: string;\n  vault: Vault;\n  contentSearchVault: Vault;\n  openSeadragonViewer: OpenSeadragon.Viewer;\n}\n\nexport const defaultState: ViewerContextStore = {\n  activeCanvas: \"\",\n  activeManifest: \"\",\n  collection: {},\n  configOptions: defaultConfigOptions,\n  customDisplays: [],\n  informationOpen: defaultConfigOptions?.informationPanel?.open,\n  isLoaded: false,\n  vault: new Vault(),\n  contentSearchVault: new Vault(),\n  openSeadragonViewer: null,\n};\n\nconst ViewerStateContext =\n  React.createContext<ViewerContextStore>(defaultState);\nconst ViewerDispatchContext =\n  React.createContext<ViewerContextStore>(defaultState);\n\nfunction viewerReducer(state: ViewerContextStore, action: ViewerAction) {\n  switch (action.type) {\n    case \"updateActiveCanvas\": {\n      /**\n       * Set canvasId to empty string if it comes back undefined.\n       */\n      if (!action.canvasId) action.canvasId = \"\";\n      return {\n        ...state,\n        activeCanvas: action.canvasId,\n      };\n    }\n    case \"updateActiveManifest\": {\n      return {\n        ...state,\n        activeManifest: action.manifestId,\n      };\n    }\n    case \"updateCollection\": {\n      return {\n        ...state,\n        collection: action.collection,\n      };\n    }\n    case \"updateConfigOptions\": {\n      return {\n        ...state,\n        configOptions: deepMerge(state.configOptions, action.configOptions),\n      };\n    }\n    case \"updateInformationOpen\": {\n      return {\n        ...state,\n        informationOpen: action.informationOpen,\n      };\n    }\n    case \"updateIsLoaded\": {\n      return {\n        ...state,\n        isLoaded: action.isLoaded,\n      };\n    }\n    case \"updateOpenSeadragonViewer\": {\n      return {\n        ...state,\n        openSeadragonViewer: action.openSeadragonViewer,\n      };\n    }\n    default: {\n      throw new Error(`Unhandled action type: ${action.type}`);\n    }\n  }\n}\n\ninterface ViewerProviderProps {\n  initialState?: ViewerContextStore;\n  children: React.ReactNode;\n}\n\nconst ViewerProvider: React.FC<ViewerProviderProps> = ({\n  initialState = defaultState,\n  children,\n}) => {\n  const [state, dispatch] = useReducer<\n    React.Reducer<ViewerContextStore, ViewerAction>\n  >(viewerReducer, initialState);\n\n  return (\n    <ViewerStateContext.Provider value={state}>\n      <ViewerDispatchContext.Provider\n        value={dispatch as unknown as ViewerContextStore}\n      >\n        {children}\n      </ViewerDispatchContext.Provider>\n    </ViewerStateContext.Provider>\n  );\n};\n\nfunction useViewerState() {\n  const context = React.useContext(ViewerStateContext);\n  if (context === undefined) {\n    throw new Error(\"useViewerState must be used within a ViewerProvider\");\n  }\n  return context;\n}\n\nfunction useViewerDispatch() {\n  const context = React.useContext(ViewerDispatchContext);\n  if (context === undefined) {\n    throw new Error(\"useViewerDispatch must be used within a ViewerProvider\");\n  }\n  return context;\n}\n\nexport { ViewerProvider, useViewerState, useViewerDispatch };\n","import { AnnotationResources, AnnotationResource } from \"src/types/annotations\";\nimport { CanvasNormalized } from \"@iiif/presentation-3\";\n\nexport const getAnnotationResources = (\n  vault: any,\n  activeCanvas: string,\n): AnnotationResources => {\n  const canvas: CanvasNormalized = vault.get({\n    id: activeCanvas,\n    type: \"Canvas\",\n  });\n\n  if (!canvas?.annotations || !canvas.annotations[0]) return [];\n\n  const annotationPages: AnnotationResources = vault.get(canvas.annotations);\n\n  /**\n   * Filter out annotation pages that don't have any Annotations in the items array.\n   */\n  return annotationPages\n    .filter((annotationPage) => {\n      if (!annotationPage.items || !annotationPage.items.length) return false;\n      return annotationPage;\n    })\n    .map((annotationPage) => {\n      /**\n       * If the annotation page doesn't have a label, add a default label.\n       * Set this value in a CONFIG and not here.\n       */\n      const label = annotationPage.label || { none: [\"Annotations\"] };\n      return { ...annotationPage, label };\n    });\n};\n\nexport const getContentSearchResources = async (\n  contentSearchVault: any,\n  searchUrl: string,\n  tabLabel: string,\n): Promise<AnnotationResource> => {\n  let annotationPage;\n  try {\n    annotationPage = await contentSearchVault.load(searchUrl);\n  } catch (error) {\n    console.log(\"Could not load content search.\");\n    return {} as AnnotationResource;\n  }\n\n  if (annotationPage.label == undefined) {\n    annotationPage.label = { none: [tabLabel] };\n  }\n  return annotationPage;\n};\n","import {\n  Annotation,\n  AnnotationPageNormalized,\n  Canvas,\n  CanvasNormalized,\n  ContentResource,\n  ExternalResourceTypes,\n  IIIFExternalWebResource,\n} from \"@iiif/presentation-3\";\n\nexport interface CanvasEntity {\n  canvas: CanvasNormalized | undefined;\n  accompanyingCanvas: Canvas | undefined;\n  annotationPage: AnnotationPageNormalized | undefined;\n  annotations: Array<Annotation | undefined>;\n}\n\nexport const getCanvasByCriteria = (\n  vault: any,\n  item: Canvas,\n  motivation: string,\n  paintingType: Array<ExternalResourceTypes>,\n): CanvasEntity => {\n  const entity: CanvasEntity = {\n    canvas: undefined,\n    accompanyingCanvas: undefined,\n    annotationPage: undefined,\n    annotations: [],\n  };\n\n  const filterAnnotations = (annotation: Annotation) => {\n    if (annotation) {\n      // Handle invalid annotations\n      if (!annotation.body || !annotation.motivation) {\n        console.error(\n          `Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'`,\n          annotation,\n        );\n        return;\n      }\n\n      let annotationBody = annotation.body as\n        | ContentResource\n        | ContentResource[];\n\n      if (Array.isArray(annotationBody)) annotationBody = annotationBody[0];\n\n      // console.log(\"annotationBody\", annotationBody);\n\n      const resource: IIIFExternalWebResource = vault.get(annotationBody.id);\n\n      if (!resource) return;\n      switch (motivation) {\n        case \"painting\":\n          if (\n            annotation.target === item.id &&\n            annotation.motivation &&\n            annotation.motivation[0] === \"painting\" &&\n            paintingType.includes(resource.type)\n          )\n            annotation.body = resource;\n          return !!annotation;\n        case \"supplementing\":\n          return;\n        default: {\n          throw new Error(`Invalid annotation motivation.`);\n        }\n      }\n    }\n  };\n\n  entity.canvas = vault.get(item);\n\n  if (entity.canvas) {\n    entity.annotationPage = vault.get(entity.canvas.items[0]);\n    entity.accompanyingCanvas = entity.canvas?.accompanyingCanvas\n      ? vault.get(entity.canvas?.accompanyingCanvas)\n      : undefined;\n  }\n\n  /**\n   * get all annotations on an annotation page resource\n   * and add them to the annotations array on the canvas entity\n   */\n  if (entity.annotationPage) {\n    /**\n     * get all initial annotation page resources\n     */\n    const annotationPageResources = vault\n      .get(entity.annotationPage.items)\n      .map((item) => {\n        return {\n          body: vault.get(item.body[0].id),\n          motivation: item.motivation,\n          type: \"Annotation\",\n        };\n      });\n\n    const annotations: Annotation[] = [];\n    annotationPageResources.forEach((annotation) => {\n      /**\n       * determine if type is a choice of multiple annotations\n       * if so, add each annotation to the annotations array\n       */\n      if (annotation.body.type === \"Choice\") {\n        annotation.body.items.forEach((item) =>\n          annotations.push({\n            ...annotation,\n            id: item.id,\n            body: vault.get(item.id),\n          }),\n        );\n\n        /**\n         * if not, add the single annotation to the annotations array\n         */\n      } else {\n        annotations.push(annotation);\n      }\n    });\n\n    /**\n     * filter annotations and scrub invalid annotations\n     */\n    entity.annotations = annotations.filter(filterAnnotations);\n  }\n\n  return entity;\n};\n","import { InternationalString } from \"@iiif/presentation-3\";\n\n// Get string from a IIIF pres 3 label by language code\nexport const getLabel = (\n  label: InternationalString,\n  language: string = \"en\",\n) => {\n  /*\n   * If no label exists, return an empty string.\n   */\n  if (!label) return \"\";\n\n  /*\n   * If InternationalString code does not exist on label, then\n   * return what may be there, ex: label.none[0] OR label.fr[0]\n   */\n  if (!label[language]) {\n    const codes: Array<string> = Object.getOwnPropertyNames(label);\n    if (codes.length > 0) return label[codes[0]];\n  }\n\n  /*\n   * Return label value for InternationalString code `en`\n   */\n  return label[language];\n};\n","import { IIIFExternalWebResource } from \"@iiif/presentation-3\";\nimport { getCanvasByCriteria } from \"src/hooks/use-iiif\";\n\nexport const getPaintingResource = (\n  vault: any,\n  id: string,\n): IIIFExternalWebResource[] | undefined => {\n  const canvasEntity = getCanvasByCriteria(\n    vault,\n    { id, type: \"Canvas\" },\n    \"painting\",\n    [\"Image\", \"Sound\", \"Video\"],\n  );\n\n  if (canvasEntity.annotations.length === 0) return;\n\n  if (canvasEntity.annotations && canvasEntity.annotations)\n    return canvasEntity.annotations.map(\n      (item) => item?.body,\n    ) as IIIFExternalWebResource[];\n\n  return;\n};\n","import { CanvasEntity } from \"src/hooks/use-iiif/getCanvasByCriteria\";\nimport { IIIFExternalWebResource } from \"@iiif/presentation-3\";\n\nexport const getThumbnail = (\n  vault: any,\n  entity: CanvasEntity,\n  width: number,\n  height: number,\n) => {\n  /*\n   * 1. Initiate empty candidates array.\n   */\n  const candidates: Array<IIIFExternalWebResource> = [];\n\n  /*\n   * 2. Check if canvas has an explicitly assigned IIIF thumbnail.\n   */\n  if (entity.canvas)\n    if (entity.canvas.thumbnail.length > 0) {\n      const canvasThumbnail: IIIFExternalWebResource = vault.get(\n        entity.canvas.thumbnail[0],\n      );\n      candidates.push(canvasThumbnail);\n    }\n\n  if (entity.annotations[0]) {\n    /*\n     * 3. Check if painting annotation has an explicitly assigned IIIF thumbnail.\n     */\n    if (entity.annotations[0].thumbnail)\n      if (entity.annotations[0].thumbnail.length > 0) {\n        const annotationThumbnail: IIIFExternalWebResource = vault.get(\n          entity.annotations[0].thumbnail[0],\n        );\n        candidates.push(annotationThumbnail);\n      }\n\n    /*\n     * 4. Check if painting annotation is of type Image.\n     */\n    if (!entity.annotations[0].body) return;\n    const annotationBody = entity.annotations[0]\n      .body as IIIFExternalWebResource;\n\n    if (annotationBody.type === \"Image\") candidates.push(annotationBody);\n  }\n\n  /*\n   * 5. Validate candidates and make selection.\n   */\n  if (candidates.length === 0) return;\n\n  const selectedCandidate: IIIFExternalWebResource = {\n    id: candidates[0].id,\n    format: candidates[0].format,\n    type: candidates[0].type,\n    width: width,\n    height: height,\n  };\n\n  /*\n   * 6. Return (for time being crudely) constructed image object.\n   */\n  const thumbnailContent = selectedCandidate;\n\n  return thumbnailContent;\n};\n","// OpenSeadragon SVG Overlay plugin 0.0.5\n// https://github.com/openseadragon/svg-overlay/issues/34#issuecomment-1147992921\nimport OpenSeadragon from \"openseadragon\";\n\nlet $ = window.OpenSeadragon;\n\nif (!$) {\n  $ = OpenSeadragon;\n  if (!$) {\n    throw new Error(\"OpenSeadragon is missing.\");\n  }\n}\n\nconst svgNS = \"http://www.w3.org/2000/svg\";\n\n// ----------\nif ($.Viewer) {\n  // @ts-expect-error: svgOverlay does not exist on Viewer\n  $.Viewer.prototype.svgOverlay = function () {\n    if (this._svgOverlayInfo) {\n      return this._svgOverlayInfo;\n    }\n\n    this._svgOverlayInfo = new Overlay(this);\n    return this._svgOverlayInfo;\n  };\n}\n// ----------\nconst Overlay = function (viewer) {\n  // eslint-disable-next-line @typescript-eslint/no-this-alias\n  const self = this;\n\n  this._viewer = viewer;\n  this._containerWidth = 0;\n  this._containerHeight = 0;\n\n  this._svg = document.createElementNS(svgNS, \"svg\");\n  this._svg.style.position = \"absolute\";\n  this._svg.style.left = 0;\n  this._svg.style.top = 0;\n  this._svg.style.width = \"100%\";\n  this._svg.style.height = \"100%\";\n  this._viewer.canvas.appendChild(this._svg);\n\n  this._node = document.createElementNS(svgNS, \"g\");\n  this._svg.appendChild(this._node);\n\n  this._viewer.addHandler(\"animation\", function () {\n    self.resize();\n  });\n\n  this._viewer.addHandler(\"open\", function () {\n    self.resize();\n  });\n\n  this._viewer.addHandler(\"rotate\", function () {\n    self.resize();\n  });\n\n  this._viewer.addHandler(\"flip\", function () {\n    self.resize();\n  });\n\n  this._viewer.addHandler(\"resize\", function () {\n    self.resize();\n  });\n\n  this.resize();\n};\n\n// ----------\nOverlay.prototype = {\n  // ----------\n  node: function () {\n    return this._node;\n  },\n\n  // ----------\n  resize: function () {\n    if (this._containerWidth !== this._viewer.container.clientWidth) {\n      this._containerWidth = this._viewer.container.clientWidth;\n      this._svg.setAttribute(\"width\", this._containerWidth);\n    }\n\n    if (this._containerHeight !== this._viewer.container.clientHeight) {\n      this._containerHeight = this._viewer.container.clientHeight;\n      this._svg.setAttribute(\"height\", this._containerHeight);\n    }\n\n    const p = this._viewer.viewport.pixelFromPoint(new $.Point(0, 0), true);\n    const zoom = this._viewer.viewport.getZoom(true);\n    const rotation = this._viewer.viewport.getRotation();\n    const flipped = this._viewer.viewport.getFlip();\n    // TODO: Expose an accessor for _containerInnerSize in the OSD API so we don't have to use the private variable.\n    const containerSizeX = this._viewer.viewport._containerInnerSize.x;\n    let scaleX = containerSizeX * zoom;\n    const scaleY = scaleX;\n\n    if (flipped) {\n      // Makes the x component of the scale negative to flip the svg\n      scaleX = -scaleX;\n      // Translates svg back into the correct coordinates when the x scale is made negative.\n      p.x = -p.x + containerSizeX;\n    }\n\n    this._node.setAttribute(\n      \"transform\",\n      \"translate(\" +\n        p.x +\n        \",\" +\n        p.y +\n        \") scale(\" +\n        scaleX +\n        \",\" +\n        scaleY +\n        \") rotate(\" +\n        rotation +\n        \")\",\n    );\n  },\n  // ----------\n  onClick: function (node, handler) {\n    // TODO: Fast click for mobile browsers\n\n    new $.MouseTracker({\n      element: node,\n      clickHandler: handler,\n    }).setTracking(true);\n  },\n};\n\nexport const OsdSvgOverlay = (viewer) => {\n  return new Overlay(viewer);\n};\n","import { AnnotationTarget } from \"@iiif/presentation-3\";\nimport { ParsedAnnotationTarget } from \"src/types/annotations\";\n\ntype AnnotationTargetExtended = AnnotationTarget & {\n  selector?: any;\n  source?: string;\n  svg?: string;\n};\n\nconst parseAnnotationTarget = (target: AnnotationTargetExtended | string) => {\n  let parsedTarget: ParsedAnnotationTarget = {\n    id: typeof target === \"string\" ? target : target.source,\n  };\n\n  if (typeof target === \"string\") {\n    if (target.includes(\"#xywh=\")) {\n      const parts = target.split(\"#xywh=\");\n      if (parts && parts[1]) {\n        const [x, y, w, h] = parts[1].split(\",\").map((value) => Number(value));\n        parsedTarget = {\n          id: parts[0],\n          rect: {\n            x,\n            y,\n            w,\n            h,\n          },\n        };\n      }\n    } else if (target.includes(\"#t=\")) {\n      const parts = target.split(\"#t=\");\n      if (parts && parts[1]) {\n        parsedTarget = {\n          id: parts[0],\n          t: parts[1],\n        };\n      }\n    }\n  } else if (typeof target === \"object\") {\n    if (target.selector?.type === \"PointSelector\") {\n      parsedTarget = {\n        id: target.source,\n        point: {\n          x: target.selector.x!,\n          y: target.selector.y!,\n        },\n      };\n    } else if (target.selector?.type === \"SvgSelector\") {\n      parsedTarget = {\n        id: target.source,\n        svg: target.selector.value,\n      };\n    }\n  }\n\n  return parsedTarget;\n};\n\nexport { parseAnnotationTarget };\n","import {\n  Annotation,\n  AnnotationNormalized,\n  type CanvasNormalized,\n} from \"@iiif/presentation-3\";\nimport OpenSeadragon from \"openseadragon\";\nimport { type ViewerConfigOptions } from \"src/context/viewer-context\";\nimport { OsdSvgOverlay } from \"src/lib/openseadragon-svg\";\nimport { parseAnnotationTarget } from \"src/lib/annotation-helpers\";\n\nimport { ParsedAnnotationTarget } from \"src/types/annotations\";\n\nexport function addOverlaysToViewer(\n  viewer: OpenSeadragon.Viewer,\n  canvas: CanvasNormalized,\n  configOptions: ViewerConfigOptions,\n  annotations: Annotation[] | AnnotationNormalized[],\n  overlaySelector: string,\n): void {\n  if (!viewer) return;\n\n  const scale = 1 / canvas.width;\n\n  annotations.forEach((annotation) => {\n    if (!annotation.target) return;\n\n    const parsedAnnotationTarget = parseAnnotationTarget(annotation.target);\n    const { point, rect, svg } = parsedAnnotationTarget;\n\n    if (rect) {\n      const { x, y, w, h } = rect;\n      addRectangularOverlay(\n        viewer,\n        x * scale,\n        y * scale,\n        w * scale,\n        h * scale,\n        configOptions,\n        overlaySelector,\n      );\n    }\n\n    if (point) {\n      const { x, y } = point;\n      const svg = `\n        <svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n          <circle cx=\"${x}\" cy=\"${y}\" r=\"20\" />\n        </svg>\n      `;\n\n      addSvgOverlay(viewer, svg, configOptions, scale, overlaySelector);\n    }\n\n    if (svg) {\n      addSvgOverlay(viewer, svg, configOptions, scale, overlaySelector);\n    }\n  });\n}\n\nexport function createOpenSeadragonRect(\n  canvas: CanvasNormalized,\n  parsedAnnotationTarget: ParsedAnnotationTarget,\n  zoomLevel: number,\n) {\n  let x,\n    y,\n    w = 40,\n    h = 40;\n\n  if (parsedAnnotationTarget.rect) {\n    x = parsedAnnotationTarget.rect.x;\n    y = parsedAnnotationTarget.rect.y;\n    w = parsedAnnotationTarget.rect.w;\n    h = parsedAnnotationTarget.rect.h;\n  }\n\n  if (parsedAnnotationTarget.point) {\n    x = parsedAnnotationTarget.point.x;\n    y = parsedAnnotationTarget.point.y;\n  }\n\n  // TODO: How to handle SVG where no rect or point exists?\n  // @ts-ignore\n  if (parseAnnotationTarget.svg) {\n  }\n\n  const scale = 1 / canvas.width;\n  const rect = new OpenSeadragon.Rect(\n    x * scale - ((w * scale) / 2) * (zoomLevel - 1),\n    y * scale - ((h * scale) / 2) * (zoomLevel - 1),\n    w * scale * zoomLevel,\n    h * scale * zoomLevel,\n  );\n\n  return rect;\n}\n\n/**\n * Add a rectangular overlay to an OpenSeadragon viewer\n */\nfunction addRectangularOverlay(\n  viewer: OpenSeadragon.Viewer,\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n  configOptions: ViewerConfigOptions,\n  overlaySelector: string,\n): void {\n  const rect = new OpenSeadragon.Rect(x, y, w, h);\n  const div = document.createElement(\"div\");\n\n  if (configOptions.annotationOverlays) {\n    const { backgroundColor, opacity, borderType, borderColor, borderWidth } =\n      configOptions.annotationOverlays;\n\n    div.style.backgroundColor = backgroundColor as string;\n    div.style.opacity = opacity as string;\n    div.style.border = `${borderType} ${borderWidth} ${borderColor}`;\n    div.className = overlaySelector;\n  }\n\n  viewer.addOverlay(div, rect);\n}\n\nfunction convertSVGStringToHTML(svgString) {\n  if (!svgString) return null;\n  const template = document.createElement(\"template\");\n  template.innerHTML = svgString.trim();\n  const result = template.content.children;\n\n  return result[0];\n}\n\nexport function addSvgOverlay(\n  viewer: any,\n  svgString: string,\n  configOptions: ViewerConfigOptions,\n  scale: number,\n  overlaySelector: string,\n) {\n  const svgEl = convertSVGStringToHTML(svgString);\n  if (svgEl) {\n    for (const child of svgEl.children) {\n      svg_processChild(viewer, child, configOptions, scale, overlaySelector);\n    }\n  }\n}\n\nfunction svg_processChild(\n  viewer: any,\n  child: ChildNode,\n  configOptions: ViewerConfigOptions,\n  scale: number,\n  overlaySelector: string,\n) {\n  if (child.nodeName === \"#text\") {\n    svg_handleTextNode(child);\n  } else {\n    const newElement = svg_handleElementNode(child, configOptions, scale);\n    const overlay = OsdSvgOverlay(viewer);\n    overlay.node().append(newElement);\n    overlay._svg?.setAttribute(\"class\", overlaySelector);\n\n    // BUG: svg with children elements aren't formated correctly.\n    child.childNodes.forEach((child) => {\n      svg_processChild(viewer, child, configOptions, scale, overlaySelector);\n    });\n  }\n}\n\nexport function svg_handleElementNode(\n  child: any,\n  configOptions: ViewerConfigOptions,\n  scale: number,\n) {\n  let hasStrokeColor = false;\n  let hasStrokeWidth = false;\n  let hasFillColor = false;\n  let hasFillOpacity = false;\n\n  const newElement = document.createElementNS(\n    \"http://www.w3.org/2000/svg\",\n    child.nodeName,\n  );\n\n  if (child.attributes.length > 0) {\n    for (let index = 0; index < child.attributes.length; index++) {\n      const element = child.attributes[index];\n      switch (element.name) {\n        case \"fill\":\n          hasFillColor = true;\n          break;\n        case \"stroke\":\n          hasStrokeColor = true;\n          break;\n        case \"stroke-width\":\n          hasStrokeWidth = true;\n          break;\n        case \"fill-opacity\":\n          hasFillOpacity = true;\n          break;\n      }\n      newElement.setAttribute(element.name, element.textContent);\n    }\n  }\n\n  if (!hasStrokeColor) {\n    newElement.style.stroke = configOptions.annotationOverlays\n      ?.borderColor as string;\n  }\n  if (!hasStrokeWidth) {\n    newElement.style.strokeWidth = configOptions.annotationOverlays\n      ?.borderWidth as string;\n  }\n  if (!hasFillColor) {\n    newElement.style.fill = configOptions.annotationOverlays\n      ?.backgroundColor as string;\n  }\n  if (!hasFillOpacity) {\n    newElement.style.fillOpacity = configOptions.annotationOverlays\n      ?.opacity as string;\n  }\n  newElement.setAttribute(\"transform\", `scale(${scale})`);\n\n  return newElement;\n}\n\nfunction svg_handleTextNode(child: ChildNode) {\n  if (!child.textContent) {\n    return;\n  }\n  if (child.textContent.includes(\"\\n\")) {\n    return;\n  }\n  console.log(\n    \"nodeName:\",\n    child.nodeName,\n    \", textContent:\",\n    child.textContent,\n    \", childNodes.length\",\n    child.childNodes.length,\n  );\n}\n\nexport function removeOverlaysFromViewer(\n  viewer: OpenSeadragon.Viewer,\n  overlaySelector: string,\n) {\n  if (!viewer) return;\n\n  if (!overlaySelector.startsWith(\".\")) {\n    overlaySelector = \".\" + overlaySelector;\n  }\n  const elements = document.querySelectorAll(overlaySelector);\n  if (elements) {\n    elements.forEach((element) => viewer.removeOverlay(element));\n  }\n}\n","import { createStitches } from \"@stitches/react\";\n\nconst hue = 209;\n\nexport const theme = {\n  colors: {\n    /*\n     * Black and dark grays in a light theme.\n     * Must contrast to 4.5 or greater with `secondary`.\n     */\n    primary: \"#1a1d1e\",\n    primaryMuted: \"#26292b\",\n    primaryAlt: \"#151718\",\n\n    /*\n     * Key brand color(s).\n     * Must contrast to 4.5 or greater with `secondary`.\n     */\n    accent: `hsl(${hue} 100% 38.2%)`,\n    accentMuted: `hsl(${hue} 80% 61.8%)`,\n    accentAlt: `hsl(${hue} 80% 30%)`,\n\n    /*\n     * White and light grays in a light theme.\n     * Must contrast to 4.5 or greater with `primary` and  `accent`.\n     */\n    secondary: \"#FFFFFF\",\n    secondaryMuted: \"#e6e8eb\",\n    secondaryAlt: \"#c1c8cd\",\n  },\n  fontSizes: {\n    1: \"12px\",\n    2: \"13px\",\n    3: \"15px\",\n    4: \"17px\",\n    5: \"19px\",\n    6: \"21px\",\n    7: \"27px\",\n    8: \"35px\",\n    9: \"59px\",\n  },\n  lineHeights: {\n    1: \"12px\",\n    2: \"13px\",\n    3: \"15px\",\n    4: \"17px\",\n    5: \"19px\",\n    6: \"21px\",\n    7: \"27px\",\n    8: \"35px\",\n    9: \"59px\",\n  },\n  sizes: {\n    1: \"5px\",\n    2: \"10px\",\n    3: \"15px\",\n    4: \"20px\",\n    5: \"25px\",\n    6: \"35px\",\n    7: \"45px\",\n    8: \"65px\",\n    9: \"80px\",\n  },\n  space: {\n    1: \"5px\",\n    2: \"10px\",\n    3: \"15px\",\n    4: \"20px\",\n    5: \"25px\",\n    6: \"35px\",\n    7: \"45px\",\n    8: \"65px\",\n    9: \"80px\",\n  },\n  radii: {\n    1: \"4px\",\n    2: \"6px\",\n    3: \"8px\",\n    4: \"12px\",\n    round: \"50%\",\n    pill: \"9999px\",\n  },\n  transitions: {\n    all: \"all 300ms cubic-bezier(0.16, 1, 0.3, 1)\",\n  },\n  zIndices: {\n    1: \"100\",\n    2: \"200\",\n    3: \"300\",\n    4: \"400\",\n    max: \"999\",\n  },\n};\n\nexport const media = {\n  xxs: \"(max-width: 349px)\",\n  xs: \"(max-width: 575px)\",\n  sm: \"(max-width: 767px)\",\n  md: \"(max-width: 991px)\",\n  lg: \"(max-width: 90rem)\",\n  xl: \"(min-width: calc(90rem + 1px))\",\n};\n\nexport type { CSS, VariantProps } from \"@stitches/react\";\n\nexport const { styled, css, keyframes, createTheme } = createStitches({\n  theme,\n  media,\n});\n","import { styled } from \"src/styles/stitches.config\";\n\nconst ErrorFallbackStyled = styled(\"div\", {\n  display: \"flex\",\n  flexDirection: \"column\",\n  alignItems: \"center\",\n});\n\nconst Headline = styled(\"p\", {\n  fontWeight: \"bold\",\n  fontSize: \"x-large\",\n});\n\nconst ErrorBody = styled(\"span\", {\n  fontSize: \"medium\",\n});\n\nexport { ErrorFallbackStyled, ErrorBody, Headline };\n","import React from \"react\";\nimport {\n  ErrorFallbackStyled,\n  ErrorBody,\n  Headline,\n} from \"src/components/Viewer/Viewer/ErrorFallback.styled\";\n\ninterface ErrorFallbackProps {\n  error: Error;\n}\n\nconst ErrorFallback: React.FC<ErrorFallbackProps> = ({ error }) => {\n  const { message } = error;\n\n  return (\n    <ErrorFallbackStyled role=\"alert\">\n      <Headline data-testid=\"headline\">Something went wrong</Headline>\n      {message && <ErrorBody>{`Error message: ${message}`} </ErrorBody>}\n    </ErrorFallbackStyled>\n  );\n};\n\nexport default ErrorFallback;\n","import * as Collapsible from \"@radix-ui/react-collapsible\";\n\nimport { styled } from \"src/styles/stitches.config\";\n\nconst MediaWrapper = styled(\"div\", {\n  position: \"relative\",\n  zIndex: \"0\",\n});\n\nconst Content = styled(\"div\", {\n  display: \"flex\",\n  flexDirection: \"row\",\n  overflow: \"hidden\",\n\n  \"@sm\": {\n    flexDirection: \"column\",\n  },\n});\n\nconst Main = styled(\"div\", {\n  display: \"flex\",\n  flexDirection: \"column\",\n  flexGrow: \"1\",\n  flexShrink: \"1\",\n  width: \"61.8%\",\n\n  \"@sm\": {\n    width: \"100%\",\n  },\n});\n\nconst CollapsibleTrigger = styled(Collapsible.Trigger, {\n  display: \"none\",\n  border: \"none\",\n  padding: \"0\",\n  transition: \"$all\",\n  opacity: \"1\",\n  background: \"#6663\",\n  margin: \"1rem 0\",\n  borderRadius: \"6px\",\n\n  \"&[data-information-panel='false']\": {\n    opacity: \"0\",\n    marginTop: \"-59px\",\n  },\n\n  \"@sm\": {\n    display: \"flex\",\n\n    \"> span\": {\n      display: \"flex\",\n      flexGrow: \"1\",\n      fontSize: \"0.8333em\",\n      justifyContent: \"center\",\n      padding: \"0.5rem\",\n      fontFamily: \"inherit\",\n    },\n  },\n});\n\nconst CollapsibleContent = styled(Collapsible.Content, {\n  width: \"100%\",\n  display: \"flex\",\n});\n\nconst Aside = styled(\"aside\", {\n  display: \"flex\",\n  flexGrow: \"1\",\n  flexShrink: \"0\",\n  width: \"38.2%\",\n  maxHeight: \"100%\",\n\n  \"@sm\": {\n    width: \"100%\",\n  },\n});\n\nconst Wrapper = styled(\"div\", {\n  display: \"flex\",\n  flexDirection: \"column\",\n  fontSmooth: \"auto\",\n  webkitFontSmoothing: \"antialiased\",\n\n  \"> div\": {\n    display: \"flex\",\n    flexDirection: \"column\",\n    flexGrow: \"1\",\n    justifyContent: \"flex-start\",\n\n    \"@sm\": {\n      [`& ${Content}`]: {\n        flexGrow: \"1\",\n      },\n\n      [`& ${Main}`]: {\n        flexGrow: \"0\",\n      },\n    },\n  },\n\n  \"@sm\": {\n    padding: \"0\",\n  },\n\n  \"&[data-information-panel-open='true']\": {\n    \"@sm\": {\n      position: \"fixed\",\n      height: \"100%\",\n      width: \"100%\",\n      top: \"0\",\n      left: \"0\",\n      zIndex: \"2500000000\",\n\n      [`& ${MediaWrapper}`]: {\n        display: \"none\",\n      },\n\n      [`& ${CollapsibleTrigger}`]: {\n        margin: \"1rem\",\n      },\n\n      [`& ${CollapsibleContent}`]: {\n        height: \"100%\",\n      },\n    },\n  },\n});\n\nexport {\n  Wrapper,\n  Content,\n  Main,\n  MediaWrapper,\n  CollapsibleContent,\n  CollapsibleTrigger,\n  Aside,\n};\n","import * as Tabs from \"@radix-ui/react-tabs\";\n\nimport { styled } from \"src/styles/stitches.config\";\n\nconst Wrapper = styled(Tabs.Root, {\n  display: \"flex\",\n  flexDirection: \"column\",\n  width: \"100%\",\n  height: \"100%\",\n  flexGrow: \"1\",\n  flexShrink: \"0\",\n  position: \"relative\",\n  zIndex: \"1\",\n  maskImage: `linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% - 2rem), transparent 100%)`,\n\n  \"@sm\": {\n    marginTop: \"0.5rem\",\n    boxShadow: \"none\",\n  },\n});\n\nconst List = styled(Tabs.List, {\n  display: \"flex\",\n  flexGrow: \"0\",\n  margin: \"0 1.618rem\",\n  borderBottom: \"4px solid #6663\",\n\n  \"@sm\": {\n    margin: \"0 1rem\",\n  },\n});\n\nconst Trigger = styled(Tabs.Trigger, {\n  display: \"flex\",\n  position: \"relative\",\n  padding: \"0.5rem 1rem\",\n  background: \"none\",\n  backgroundColor: \"transparent\",\n  fontFamily: \"inherit\",\n  border: \"none\",\n  opacity: \"0.7\",\n  fontSize: \"1rem\",\n  marginRight: \"1rem\",\n  lineHeight: \"1rem\",\n  whiteSpace: \"nowrap\",\n  cursor: \"pointer\",\n  fontWeight: 400,\n  transition: \"$all\",\n\n  \"&::after\": {\n    width: \"0\",\n    height: \"4px\",\n    content: \"\",\n    position: \"absolute\",\n    bottom: \"-4px\",\n    left: \"0\",\n    transition: \"$all\",\n  },\n\n  \"&[data-state='active']\": {\n    opacity: \"1\",\n    fontWeight: 700,\n\n    \"&::after\": {\n      width: \"100%\",\n      backgroundColor: \"$accent\",\n    },\n  },\n});\n\nconst Content = styled(Tabs.Content, {\n  display: \"flex\",\n  flexGrow: \"1\",\n  flexShrink: \"0\",\n  position: \"absolute\",\n  top: \"0\",\n  left: \"0\",\n\n  \"&[data-state='active']\": {\n    width: \"100%\",\n    height: \"calc(100% - 2rem)\",\n    padding: \"1.618rem 0\",\n  },\n});\n\nconst Scroll = styled(\"div\", {\n  position: \"relative\",\n  height: \"100%\",\n  width: \"100%\",\n  overflowY: \"scroll\",\n});\n\nexport { Content, List, Scroll, Trigger, Wrapper };\n","import { CSS, styled } from \"src/styles/stitches.config\";\n\nconst annotationItemRow: CSS = {\n  position: \"relative\",\n  cursor: \"pointer\",\n  display: \"flex\",\n  width: \"100%\",\n  justifyContent: \"space-between\",\n  textAlign: \"left\",\n  margin: \"0\",\n  padding: \"0.5rem 1.618rem\",\n  fontFamily: \"inherit\",\n  lineHeight: \"1.25em\",\n  fontSize: \"1rem\",\n  color: \"inherit\",\n  border: \"none\",\n  background: \"none\",\n};\n\nconst ButtonStyled = styled(\"button\", {\n  textAlign: \"left\",\n\n  \"&:hover\": {\n    color: \"$accent\",\n  },\n});\n\nconst Group = styled(\"div\", {\n  display: \"flex\",\n  flexDirection: \"column\",\n  width: \"100%\",\n});\n\nconst Item = styled(\"div\", {\n  ...annotationItemRow,\n});\n\nconst ItemHTMLWrapper = styled(\"div\", {\n  \"&:hover\": {\n    color: \"$accent\",\n  },\n});\n\nexport { annotationItemRow, ButtonStyled, Group, Item, ItemHTMLWrapper };\n","import { ButtonStyled } from \"./Item.styled\";\nimport React from \"react\";\n\ntype AnnotationItemPlainTextProps = {\n  value: string;\n  handleClick: (e) => void;\n};\n\nconst AnnotationItemPlainText: React.FC<AnnotationItemPlainTextProps> = ({\n  value,\n  handleClick,\n}) => {\n  return <ButtonStyled onClick={handleClick}>{value}</ButtonStyled>;\n};\n\nexport default AnnotationItemPlainText;\n","import { ItemHTMLWrapper } from \"./Item.styled\";\nimport React from \"react\";\n\ntype AnnotationItemHTMLProps = {\n  value: string;\n  handleClick: (e) => void;\n};\n\nconst AnnotationItemHTML: React.FC<AnnotationItemHTMLProps> = ({\n  value,\n  handleClick,\n}) => {\n  return (\n    <ItemHTMLWrapper\n      dangerouslySetInnerHTML={{ __html: value }}\n      onClick={handleClick}\n    />\n  );\n};\n\nexport default AnnotationItemHTML;\n","// @ts-nocheck\n\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport interface NodeWebVttCue {\n  identifier?: string;\n  start: number;\n  end: number;\n  text: string;\n  styles?: string;\n  children?: Array<NodeWebVttCue>;\n}\nexport interface NodeWebVttCueNested extends NodeWebVttCue {\n  children?: Array<NodeWebVttCueNested>;\n}\n\nconst useWebVtt = () => {\n  function addIdentifiersToParsedCues(\n    cues: Array<NodeWebVttCue>,\n  ): Array<NodeWebVttCue> {\n    return cues.map((cue) => {\n      const identifier = cue.identifier || uuidv4();\n      return { ...cue, identifier };\n    });\n  }\n\n  /**\n   * This function takes an array of NodeWebVttCue items as input, where each item\n   * is an object with properties identifier, start, end, text, and styles. It\n   * iterates through the array of items and uses a stack to keep track of nested\n   * items. It compares the current item's start with the end of the items in the\n   * stack. If the current item's start is smaller than the end of the top item\n   * in the stack, it is considered a child of the top item and added to its\n   * children property. If the current item's start is greater than the end\n   * of the top item in the stack, it is considered a top-level item and added to\n   * the nestedItems array. The resulting nestedItems array contains the items\n   * organized into nested structures based on their start and end values.\n   */\n  function createNestedCues(flat: Array<NodeWebVttCue>): Array<NodeWebVttCue> {\n    const nestedItems = [];\n    const stack = [];\n\n    const cues = addIdentifiersToParsedCues(flat);\n\n    for (const item of cues) {\n      while (stack.length > 0 && stack[stack.length - 1].end <= item.start) {\n        stack.pop();\n      }\n\n      if (stack.length > 0) {\n        if (!stack[stack.length - 1].children) {\n          stack[stack.length - 1].children = [];\n        }\n        stack[stack.length - 1].children?.push(item);\n        stack.push(item);\n      } else {\n        nestedItems.push(item);\n        stack.push(item);\n      }\n    }\n\n    return nestedItems;\n  }\n\n  /**\n   * Is a cue a child of another cue\n   * @param cue Object\n   * @param cues Array\n   * @returns Boolean\n   */\n  function isChild(\n    cue: NodeWebVttCue,\n    cues: Array<NodeWebVttCue> = [],\n  ): boolean {\n    return cues.some(\n      (currentCue) =>\n        cue.start >= currentCue.start && cue.end <= currentCue.end,\n    );\n  }\n\n  /**\n   * Sort Cues by cue start time\n   * @param cues\n   * @returns Array\n   */\n  function orderCuesByTime(\n    cues: Array<NodeWebVttCue> = [],\n  ): Array<NodeWebVttCue> {\n    return cues.sort((cue1, cue2) => cue1.start - cue2.start);\n  }\n\n  return {\n    addIdentifiersToParsedCues,\n    createNestedCues,\n    isChild,\n    orderCuesByTime,\n  };\n};\n\nexport default useWebVtt;\n","import * as RadioGroup from \"@radix-ui/react-radio-group\";\n\nimport { keyframes, styled } from \"src/styles/stitches.config\";\n\nimport { annotationItemRow } from \"src/components/Viewer/InformationPanel/Annotation/Item.styled\";\n\nconst spin = keyframes({\n  from: { transform: \"rotate(360deg)\" },\n  to: { transform: \"rotate(0deg)\" },\n});\n\nexport const Group = styled(RadioGroup.Root, {\n  display: \"flex\",\n  flexDirection: \"column\",\n  width: \"100%\",\n});\n\nexport const Item = styled(RadioGroup.Item, {\n  ...annotationItemRow,\n\n  \"@sm\": {\n    padding: \"0.5rem 1rem\",\n    fontSize: \"0.8333rem\",\n  },\n\n  \"&::before\": {\n    content: \"\",\n    width: \"12px\",\n    height: \"12px\",\n    borderRadius: \"12px\",\n    position: \"absolute\",\n    backgroundColor: \"$primaryMuted\",\n    opacity: \"0\",\n    left: \"8px\",\n    marginTop: \"3px\",\n    boxSizing: \"content-box\",\n\n    \"@sm\": {\n      content: \"unset\",\n    },\n  },\n\n  \"&::after\": {\n    content: \"\",\n    width: \"4px\",\n    height: \"6px\",\n    position: \"absolute\",\n    backgroundColor: \"$secondary\",\n    opacity: \"0\",\n    clipPath: \"polygon(100% 50%, 0 100%, 0 0)\",\n    left: \"13px\",\n    marginTop: \"6px\",\n    boxSizing: \"content-box\",\n\n    \"@sm\": {\n      content: \"unset\",\n    },\n  },\n\n  strong: {\n    marginLeft: \"1rem\",\n  },\n\n  \"&:hover\": {\n    color: \"$accent\",\n\n    \"&::before\": {\n      backgroundColor: \"$accent\",\n      opacity: \"1\",\n    },\n\n    \"&::after\": {\n      content: \"\",\n      width: \"4px\",\n      height: \"6px\",\n      position: \"absolute\",\n      backgroundColor: \"$secondary\",\n      clipPath: \"polygon(100% 50%, 0 100%, 0 0)\",\n      opacity: \"1\",\n    },\n  },\n\n  \"&[aria-checked='true']\": {\n    backgroundColor: \"#6663\",\n\n    \"&::before\": {\n      content: \"\",\n      width: \"6px\",\n      height: \"6px\",\n      position: \"absolute\",\n      backgroundColor: \"transparent\",\n      border: \"3px solid $accentMuted\",\n      borderRadius: \"12px\",\n      left: \"8px\",\n      marginTop: \"4px\",\n      opacity: \"1\",\n      animation: \"1s linear infinite\",\n      animationName: spin,\n      boxSizing: \"content-box\",\n\n      \"@sm\": {\n        content: \"unset\",\n      },\n    },\n\n    \"&::after\": {\n      content: \"\",\n      width: \"6px\",\n      height: \"6px\",\n      position: \"absolute\",\n      backgroundColor: \"transparent\",\n      border: \"3px solid $accent\",\n      clipPath: \"polygon(100% 0, 100% 100%, 0 0)\",\n      borderRadius: \"12px\",\n      left: \"8px\",\n      marginTop: \"4px\",\n      opacity: \"1\",\n      animation: \"1.5s linear infinite\",\n      animationName: spin,\n      boxSizing: \"content-box\",\n\n      \"@sm\": {\n        content: \"unset\",\n      },\n    },\n  },\n});\n","import React, { useEffect, useState } from \"react\";\n\nimport { Item } from \"src/components/Viewer/InformationPanel/Annotation/VTT/Cue.styled\";\nimport { convertTime } from \"src/lib/utils\";\n\ninterface Props {\n  label: string;\n  start: number;\n  end: number;\n}\n\nconst Cue: React.FC<Props> = ({ label, start, end }) => {\n  const [isActive, updateIsActive] = useState(false);\n\n  const video = document.getElementById(\n    \"clover-iiif-video\",\n  ) as HTMLVideoElement;\n\n  useEffect(() => {\n    video?.addEventListener(\"timeupdate\", () => {\n      const { currentTime } = video;\n      updateIsActive(start <= currentTime && currentTime < end);\n    });\n\n    return () => document.removeEventListener(\"timeupdate\", () => {});\n  }, [end, start, video]);\n\n  const handleClick = () => {\n    if (video) {\n      video.pause();\n      video.currentTime = start;\n      video.play();\n    }\n  };\n\n  return (\n    <Item\n      aria-checked={isActive}\n      data-testid=\"information-panel-cue\"\n      onClick={handleClick}\n      value={label}\n    >\n      {label}\n      <strong>{convertTime(start)}</strong>\n    </Item>\n  );\n};\n\nexport default Cue;\n","import { Item } from \"src/components/Viewer/InformationPanel/Annotation/VTT/Cue.styled\";\nimport { styled } from \"src/styles/stitches.config\";\n\nexport const MenuStyled = styled(\"ul\", {\n  listStyle: \"none\",\n  paddingLeft: \"1rem\",\n  position: \"relative\",\n\n  \"&&:first-child\": {\n    paddingLeft: \"0\",\n  },\n\n  \"& li ul\": {\n    [`& ${Item}`]: {\n      backgroundColor: \"unset\",\n\n      \"&::before\": {\n        content: \"none\",\n      },\n      \"&::after\": {\n        content: \"none\",\n      },\n    },\n  },\n\n  \"&:first-child\": {\n    margin: \"0 0 1.618rem\",\n  },\n});\n","import Cue from \"src/components/Viewer/InformationPanel/Annotation/VTT/Cue\";\nimport { MenuStyled } from \"src/components/Viewer/InformationPanel/Menu.styled\";\nimport { NodeWebVttCueNested } from \"src/hooks/use-webvtt\";\nimport React from \"react\";\n\ninterface MenuProps {\n  items: Array<NodeWebVttCueNested>;\n}\nconst Menu: React.FC<MenuProps> = ({ items }) => {\n  return (\n    <MenuStyled>\n      {items.map((item) => {\n        const { text, start, end, children, identifier } = item;\n        return (\n          <li key={identifier}>\n            <Cue label={text} start={start} end={end} />\n            {children && <Menu items={children} />}\n          </li>\n        );\n      })}\n    </MenuStyled>\n  );\n};\nexport default Menu;\n","import React, { useEffect } from \"react\";\nimport useWebVtt, {\n  NodeWebVttCue,\n  NodeWebVttCueNested,\n} from \"src/hooks/use-webvtt\";\n\nimport { Group } from \"src/components/Viewer/InformationPanel/Annotation/VTT/Cue.styled\";\nimport { InternationalString } from \"@iiif/presentation-3\";\nimport Menu from \"src/components/Viewer/InformationPanel/Menu\";\nimport { getLabel } from \"src/hooks/use-iiif\";\nimport { parse } from \"node-webvtt\";\n\ntype AnnotationItemVTTProps = {\n  label: InternationalString | undefined;\n  vttUri: string;\n};\n\nconst AnnotationItemVTT: React.FC<AnnotationItemVTTProps> = ({\n  label,\n  vttUri,\n}) => {\n  const [cues, setCues] = React.useState<Array<NodeWebVttCueNested>>([]);\n  const { createNestedCues, orderCuesByTime } = useWebVtt();\n  const [isNetworkError, setIsNetworkError] = React.useState<Error>();\n\n  useEffect(() => {\n    if (vttUri)\n      fetch(vttUri, {\n        headers: {\n          \"Content-Type\": \"text/plain\",\n          Accept: \"application/json\",\n        },\n      })\n        .then((response) => response.text())\n        .then((data) => {\n          const flatCues = parse(data).cues as unknown as Array<NodeWebVttCue>;\n          const orderedCues = orderCuesByTime(flatCues);\n          const nestedCues = createNestedCues(orderedCues);\n          setCues(nestedCues);\n        })\n        .catch((error) => {\n          console.error(vttUri, error.toString());\n          setIsNetworkError(error);\n        });\n  }, [vttUri]); // NOTE: Do not include createNestedCues and orderCuesByTime in the dependency array as it will cause an infinite loop\n\n  return (\n    <Group\n      data-testid=\"annotation-item-vtt\"\n      aria-label={`navigate ${getLabel(label as InternationalString, \"en\")}`}\n    >\n      {isNetworkError && (\n        <div data-testid=\"error-message\">\n          Network Error: {isNetworkError.toString()}\n        </div>\n      )}\n      <Menu items={cues} />\n    </Group>\n  );\n};\n\nexport default AnnotationItemVTT;\n","import { ButtonStyled } from \"./Item.styled\";\nimport React from \"react\";\n\ntype AnnotationItemImageProps = {\n  caption: string;\n  handleClick: (e) => void;\n  imageUri: string;\n};\n\nconst AnnotationItemImage: React.FC<AnnotationItemImageProps> = ({\n  caption,\n  handleClick,\n  imageUri,\n}) => {\n  return (\n    <ButtonStyled onClick={handleClick}>\n      <img src={imageUri} alt={`A visual annotation for ${caption}`} />\n      <span>{caption}</span>\n    </ButtonStyled>\n  );\n};\n\nexport default AnnotationItemImage;\n","import React from \"react\";\nimport { Item as ItemStyled } from \"src/components/Viewer/InformationPanel/Annotation/Item.styled\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\nimport {\n  AnnotationNormalized,\n  type CanvasNormalized,\n  EmbeddedResource,\n  InternationalString,\n} from \"@iiif/presentation-3\";\nimport AnnotationItemPlainText from \"./PlainText\";\nimport AnnotationItemHTML from \"./HTML\";\nimport AnnotationItemVTT from \"./VTT/VTT\";\nimport { parseAnnotationTarget } from \"src/lib/annotation-helpers\";\nimport { createOpenSeadragonRect } from \"src/lib/openseadragon-helpers\";\nimport AnnotationItemImage from \"./Image\";\n\ntype Props = {\n  annotation: AnnotationNormalized;\n};\n\nexport const AnnotationItem: React.FC<Props> = ({ annotation }) => {\n  const { target } = annotation;\n\n  const viewerState: ViewerContextStore = useViewerState();\n  const { openSeadragonViewer, vault, activeCanvas, configOptions } =\n    viewerState;\n\n  const annotationBody: Array<\n    EmbeddedResource & {\n      label?: InternationalString;\n    }\n  > = annotation.body.map((body) => vault.get(body.id));\n\n  const annotationBodyFormat =\n    annotationBody.find((body) => body.format)?.format || \"\";\n\n  const annotationBodyValue =\n    annotationBody.find((body) => body.value)?.value || \"\";\n\n  const canvas: CanvasNormalized = vault.get({\n    id: activeCanvas,\n    type: \"Canvas\",\n  });\n\n  function handleClick() {\n    if (!target) return;\n\n    const zoomLevel = configOptions.annotationOverlays?.zoomLevel || 1;\n    // @ts-ignore\n    const parsedAnnotationTarget = parseAnnotationTarget(target);\n\n    const { point, rect, svg } = parsedAnnotationTarget;\n\n    if (point || rect || svg) {\n      const rect = createOpenSeadragonRect(\n        canvas,\n        parsedAnnotationTarget,\n        zoomLevel,\n      );\n      openSeadragonViewer?.viewport.fitBounds(rect);\n    }\n  }\n\n  function renderItemBody() {\n    switch (annotationBodyFormat) {\n      case \"text/plain\":\n        return (\n          <AnnotationItemPlainText\n            value={annotationBodyValue}\n            handleClick={handleClick}\n          />\n        );\n      case \"text/html\":\n        return (\n          <AnnotationItemHTML\n            value={annotationBodyValue}\n            handleClick={handleClick}\n          />\n        );\n      case \"text/vtt\":\n        return (\n          <AnnotationItemVTT\n            label={annotationBody[0].label}\n            vttUri={annotationBody[0].id || \"\"}\n          />\n        );\n      case annotationBodyFormat.match(/^image\\//)?.input:\n        const imageUri =\n          annotationBody.find((body) => !body.id?.includes(\"vault://\"))?.id ||\n          \"\";\n        return (\n          <AnnotationItemImage\n            caption={annotationBodyValue}\n            handleClick={handleClick}\n            imageUri={imageUri}\n          />\n        );\n      default:\n        return (\n          <AnnotationItemPlainText\n            value={annotationBodyValue}\n            handleClick={handleClick}\n          />\n        );\n    }\n  }\n\n  return <ItemStyled>{renderItemBody()}</ItemStyled>;\n};\n\nexport default AnnotationItem;\n","import {\n  AnnotationNormalized,\n  AnnotationPageNormalized,\n} from \"@iiif/presentation-3\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\n\nimport AnnotationItem from \"src/components/Viewer/InformationPanel/Annotation/Item\";\nimport { Group } from \"src/components/Viewer/InformationPanel/Annotation/Item.styled\";\nimport React from \"react\";\n\ntype Props = {\n  annotationPage: AnnotationPageNormalized;\n};\nexport const AnnotationPage: React.FC<Props> = ({ annotationPage }) => {\n  const viewerState: ViewerContextStore = useViewerState();\n  const { vault } = viewerState;\n\n  if (\n    !annotationPage ||\n    !annotationPage.items ||\n    annotationPage.items?.length === 0\n  )\n    return <></>;\n\n  const annotations = annotationPage.items.map((item) => {\n    return vault.get(item.id) as AnnotationNormalized;\n  });\n\n  if (!annotations) return <></>;\n\n  return (\n    <Group data-testid=\"annotation-page\">\n      {annotations?.map((annotation) => (\n        <AnnotationItem key={annotation.id} annotation={annotation} />\n      ))}\n    </Group>\n  );\n};\n\nexport default AnnotationPage;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst ButtonStyled = styled(\"button\", {\n  textAlign: \"left\",\n\n  \"&:hover\": {\n    color: \"$accent\",\n  },\n});\n\nconst Item = styled(\"li\", {\n  margin: \"0.25rem 0\",\n});\n\nconst List = styled(\"ol\", {\n  listStyleType: \"auto\",\n  marginBottom: \"1rem\",\n  listStylePosition: \"inside\",\n});\n\nconst FormStyled = styled(\"div\", {\n  marginBottom: \"1rem\",\n\n  input: {\n    background: \"#efefef\",\n    padding: \".25rem\",\n  },\n});\n\nconst Container = styled(\"div\", {\n  margin: \"0.5rem 1.618rem\",\n});\n\nconst ResultsHeader = styled(\"div\", {\n  fontWeight: \"bold\",\n});\n\nconst ResultsFooter = styled(\"div\", {\n  marginBottom: \"1rem\",\n});\n\nexport {\n  Item,\n  List,\n  ButtonStyled,\n  FormStyled,\n  Container,\n  ResultsHeader,\n  ResultsFooter,\n};\n","import { ButtonStyled } from \"./Item.styled\";\nimport React from \"react\";\n\ntype AnnotationItemPlainTextProps = {\n  value: string;\n  handleClick: (e) => void;\n  target: string;\n  canvas: string;\n};\n\nconst AnnotationItemPlainText: React.FC<AnnotationItemPlainTextProps> = ({\n  value,\n  handleClick,\n  target,\n  canvas,\n}) => {\n  return (\n    <ButtonStyled\n      onClick={handleClick}\n      data-target={target}\n      data-canvas={canvas}\n    >\n      {value}\n    </ButtonStyled>\n  );\n};\n\nexport default AnnotationItemPlainText;\n","import React, { useEffect } from \"react\";\nimport { Item as ItemStyled } from \"./Item.styled\";\n\nimport {\n  ViewerContextStore,\n  useViewerState,\n  useViewerDispatch,\n} from \"src/context/viewer-context\";\nimport {\n  type CanvasNormalized,\n  AnnotationNormalized,\n  EmbeddedResource,\n  InternationalString,\n} from \"@iiif/presentation-3\";\nimport { parseAnnotationTarget } from \"src/lib/annotation-helpers\";\nimport { createOpenSeadragonRect } from \"src/lib/openseadragon-helpers\";\nimport AnnotationItemPlainText from \"./PlainText\";\n\ntype Props = {\n  annotation: AnnotationNormalized;\n  activeTarget: string | undefined;\n  setActiveTarget: React.Dispatch<React.SetStateAction<string | undefined>>;\n};\n\nexport const ContentSearchItem: React.FC<Props> = ({\n  annotation,\n  activeTarget,\n  setActiveTarget,\n}) => {\n  const dispatch: any = useViewerDispatch();\n  const viewerState: ViewerContextStore = useViewerState();\n  const {\n    openSeadragonViewer,\n    vault,\n    contentSearchVault,\n    activeCanvas,\n    configOptions,\n  } = viewerState;\n\n  const canvas: CanvasNormalized = vault.get({\n    id: activeCanvas,\n    type: \"Canvas\",\n  });\n\n  const annotationBody: Array<\n    EmbeddedResource & {\n      label?: InternationalString;\n    }\n  > = annotation.body.map((body) => contentSearchVault.get(body.id));\n\n  const annotationBodyValue =\n    annotationBody.find((body) => body.value)?.value || \"\";\n\n  let annotationTarget;\n  if (annotation.target) {\n    if (typeof annotation.target === \"string\") {\n      annotationTarget = annotation.target;\n    }\n  }\n\n  let annotationCanvas;\n  if (annotationTarget) {\n    const parts = annotationTarget.split(\"#xywh\");\n    if (parts.length > 1) {\n      annotationCanvas = parts[0];\n    }\n  }\n\n  function panToTarget() {\n    const zoomLevel = configOptions.annotationOverlays?.zoomLevel || 1;\n\n    const parsedAnnotationTarget = parseAnnotationTarget(annotationTarget);\n\n    const { point, rect, svg } = parsedAnnotationTarget;\n\n    if (point || rect || svg) {\n      const rect = createOpenSeadragonRect(\n        canvas,\n        parsedAnnotationTarget,\n        zoomLevel,\n      );\n      openSeadragonViewer?.viewport.fitBounds(rect);\n    }\n  }\n\n  // when openSeadragonViewer changes, then zoom to target\n  useEffect(() => {\n    if (!openSeadragonViewer) return;\n    if (annotationTarget != activeTarget) return;\n\n    panToTarget();\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [openSeadragonViewer]);\n\n  function handleClick(e) {\n    if (!openSeadragonViewer) return;\n\n    const target = JSON.parse(e.target.dataset.target);\n    const canvasId = e.target.dataset.canvas;\n\n    // if activeCanvas does not change, then zoom to target\n    if (activeCanvas === canvasId) {\n      panToTarget();\n\n      // else activeCanvas does change, which will trigger rerendering <OSD />\n      // and creating new openseadragon viewer\n    } else {\n      dispatch({\n        type: \"updateActiveCanvas\",\n        canvasId: canvasId,\n      });\n      setActiveTarget(target);\n    }\n  }\n\n  const targetJson = JSON.stringify(annotationTarget);\n\n  return (\n    <ItemStyled>\n      <AnnotationItemPlainText\n        target={targetJson}\n        canvas={annotationCanvas}\n        value={annotationBodyValue}\n        handleClick={handleClick}\n      />\n    </ItemStyled>\n  );\n};\n\nexport default ContentSearchItem;\n","import React, { useState } from \"react\";\nimport {\n  AnnotationNormalized,\n  AnnotationPageNormalized,\n} from \"@iiif/presentation-3\";\nimport ContentSearchItem from \"./Item\";\nimport { List, ResultsHeader, ResultsFooter } from \"./Item.styled\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\nimport { getLabel } from \"src/hooks/use-iiif\";\n\ntype Props = {\n  annotationPage: AnnotationPageNormalized;\n};\ntype GroupedAnnotations = {\n  [k: string]: AnnotationNormalized[];\n};\nexport const ContentSearchPage: React.FC<Props> = ({ annotationPage }) => {\n  const viewerState: ViewerContextStore = useViewerState();\n  const { contentSearchVault, configOptions } = viewerState;\n\n  const [activeTarget, setActiveTarget] = useState<string | undefined>();\n\n  const searchResultsLimit = configOptions.contentSearch?.searchResultsLimit;\n  const searchText = configOptions.localeText?.contentSearch;\n\n  function formatAnnotationPage(annotationPage: AnnotationPageNormalized) {\n    const groupedAnnotations: GroupedAnnotations = {};\n    annotationPage.items.forEach((item) => {\n      const annotation = contentSearchVault.get(\n        item.id,\n      ) as AnnotationNormalized;\n      let label = \"\";\n      if (annotation.label) {\n        const internationalLabel = getLabel(annotation.label);\n        if (internationalLabel) {\n          label = internationalLabel[0];\n        }\n      }\n\n      if (groupedAnnotations[label] == undefined) {\n        groupedAnnotations[label] = [];\n      }\n      groupedAnnotations[label].push(annotation);\n    });\n    return groupedAnnotations;\n  }\n\n  function renderSearchResults(\n    annotations: AnnotationNormalized[],\n  ): React.JSX.Element[] {\n    const annotationsShown = searchResultsLimit\n      ? annotations.slice(0, searchResultsLimit)\n      : annotations;\n\n    return annotationsShown.map((annotation, i) => (\n      <ContentSearchItem\n        key={i}\n        annotation={annotation}\n        activeTarget={activeTarget}\n        setActiveTarget={setActiveTarget}\n      />\n    ));\n  }\n\n  function renderMoreResultsMessage(annotations: AnnotationNormalized[]) {\n    if (searchResultsLimit) {\n      const moreCount = annotations.length - searchResultsLimit;\n      if (moreCount > 0) {\n        return (\n          <ResultsFooter>\n            {moreCount} {searchText?.moreResults}\n          </ResultsFooter>\n        );\n      }\n    }\n  }\n\n  if (\n    !annotationPage ||\n    !annotationPage.items ||\n    annotationPage.items?.length === 0\n  )\n    return <p>{searchText?.noSearchResults}</p>;\n\n  return (\n    <>\n      {Object.entries(formatAnnotationPage(annotationPage)).map(\n        ([label, annotations], i) => {\n          return (\n            <div key={i}>\n              <ResultsHeader className=\"content-search-results-title\">\n                {label}\n              </ResultsHeader>\n              <List className=\"content-search-results\">\n                {renderSearchResults(annotations)}\n              </List>\n              {renderMoreResultsMessage(annotations)}\n            </div>\n          );\n        },\n      )}\n    </>\n  );\n};\n\nexport default ContentSearchPage;\n","import React, { useState } from \"react\";\nimport * as Form from \"@radix-ui/react-form\";\nimport { AnnotationPageNormalized } from \"@iiif/presentation-3\";\nimport { getContentSearchResources } from \"src/hooks/use-iiif\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\nimport { AnnotationResource } from \"src/types/annotations\";\nimport { FormStyled } from \"./Item.styled\";\n\ntype Props = {\n  searchServiceUrl?: string;\n  setContentSearchResource: React.Dispatch<\n    React.SetStateAction<AnnotationResource | undefined>\n  >;\n  activeCanvas: string;\n  setLoading: React.Dispatch<React.SetStateAction<boolean>>;\n};\n\nconst SearchContent: React.FC<Props> = ({\n  searchServiceUrl,\n  setContentSearchResource,\n  setLoading,\n}) => {\n  const [searchTerms, setSearchTerms] = useState<string | undefined>();\n\n  const viewerState: ViewerContextStore = useViewerState();\n  const { contentSearchVault, openSeadragonViewer, configOptions } =\n    viewerState;\n  const searchText = configOptions.localeText?.contentSearch;\n\n  async function searchSubmitHandler(e) {\n    e.preventDefault();\n    const tabLabel = searchText?.tabLabel as string;\n\n    if (!openSeadragonViewer) return;\n    if (!searchTerms || searchTerms.trim() === \"\") {\n      // must return a label because Information Panel tab requires a label\n      setContentSearchResource({\n        label: { none: [tabLabel] },\n      } as unknown as AnnotationPageNormalized);\n      return;\n    }\n\n    setLoading(true);\n\n    const url = searchServiceUrl + \"?q=\" + searchTerms.trim();\n    getContentSearchResources(contentSearchVault, url, tabLabel).then(\n      (resources) => {\n        setContentSearchResource(resources);\n        setLoading(false);\n      },\n    );\n  }\n\n  const handleChange = (e: any) => {\n    e.preventDefault();\n    setSearchTerms(e.target.value);\n  };\n\n  return (\n    <FormStyled>\n      <Form.Root onSubmit={searchSubmitHandler} className=\"content-search-form\">\n        <Form.Field name=\"searchTerms\" onChange={handleChange}>\n          <Form.Control placeholder={searchText?.formPlaceholder} />\n        </Form.Field>\n      </Form.Root>\n    </FormStyled>\n  );\n};\n\nexport default SearchContent;\n","import React, { useState } from \"react\";\nimport ContentSearchAnnotationPage from \"src/components/Viewer/InformationPanel/ContentSearch/Page\";\nimport { AnnotationPageNormalized } from \"@iiif/presentation-3\";\nimport ContentSearchForm from \"src/components/Viewer/InformationPanel/ContentSearch/ContentSearchForm\";\nimport { AnnotationResource } from \"src/types/annotations\";\nimport { Container } from \"./Item.styled\";\n\ntype ContentSearchProps = {\n  searchServiceUrl?: string;\n  setContentSearchResource: React.Dispatch<\n    React.SetStateAction<AnnotationPageNormalized | undefined>\n  >;\n  activeCanvas: string;\n  annotationPage: AnnotationResource;\n};\n\nconst ContentSearch: React.FC<ContentSearchProps> = ({\n  searchServiceUrl,\n  setContentSearchResource,\n  activeCanvas,\n  annotationPage,\n}) => {\n  const [loading, setLoading] = useState(false);\n\n  return (\n    <Container>\n      <ContentSearchForm\n        searchServiceUrl={searchServiceUrl}\n        setContentSearchResource={setContentSearchResource}\n        activeCanvas={activeCanvas}\n        setLoading={setLoading}\n      />\n      {!loading && (\n        <ContentSearchAnnotationPage annotationPage={annotationPage} />\n      )}\n      {loading && <span>Loading...</span>}\n    </Container>\n  );\n};\n\nexport default ContentSearch;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst AboutContent = styled(\"div\", {\n  padding: \" 0 1.618rem 2rem\",\n  display: \"flex\",\n  flexDirection: \"column\",\n  overflow: \"scroll\",\n  position: \"absolute\",\n  fontWeight: \"400\",\n  fontSize: \"1rem\",\n  zIndex: \"0\",\n\n  img: {\n    maxWidth: \"100px\",\n    maxHeight: \"100px\",\n    objectFit: \"contain\",\n    color: \"transparent\",\n    margin: \"0 0 1rem\",\n    borderRadius: \"3px\",\n    backgroundColor: \"$secondaryMuted\",\n  },\n\n  video: {\n    display: \"none\",\n  },\n\n  \"a, a:visited\": {\n    color: \"$accent\",\n  },\n\n  p: {\n    fontSize: \"1rem\",\n    lineHeight: \"1.45em\",\n    margin: \"0\",\n  },\n\n  dl: {\n    margin: \"0\",\n\n    dt: {\n      fontWeight: \"700\",\n      margin: \"1rem 0 0.25rem\",\n    },\n\n    dd: {\n      margin: \"0\",\n    },\n  },\n\n  \".manifest-property-title\": {\n    fontWeight: \"700\",\n    margin: \"1rem 0 0.25rem\",\n  },\n\n  \"ul, ol\": {\n    padding: \"0\",\n    margin: \"0\",\n\n    li: {\n      fontSize: \"1rem\",\n      lineHeight: \"1.45em\",\n      listStyle: \"none\",\n      margin: \"0.25rem 0 0.25rem\",\n    },\n  },\n});\n\nconst AboutStyled = styled(\"div\", {\n  position: \"relative\",\n  width: \"100%\",\n  height: \"100%\",\n  zIndex: \"0\",\n});\n\nexport { AboutContent, AboutStyled };\n","import { InternationalString } from \"@iiif/presentation-3\";\n\nexport const getLabelEntries = (\n  label?: InternationalString,\n  lang: string = \"none\",\n) => {\n  /*\n   * If no label exists, return an empty string.\n   */\n  if (!label) return null;\n\n  /*\n   * If label is not a IIIF Presentation API 3.0 shape, return the string\n   */\n  if (typeof label === \"string\") return [label];\n\n  /*\n   * If InternationalString code does not exist on label, then\n   * return what may be there, ex: label.none[0] OR label.fr[0]\n   */\n  if (!label[lang]) {\n    const codes: Array<string> = Object.getOwnPropertyNames(label);\n    if (codes.length > 0) return label[codes[0]];\n  }\n\n  /*\n   * Return label value for InternationalString code `en`\n   */\n  if (!label[lang]) return null;\n  if (!Array.isArray(label[lang])) return null;\n\n  return label[lang] as string[];\n};\n\nexport const getLabelAsString = (\n  label: InternationalString | undefined,\n  lang: string = \"none\",\n  delimiter: string = \", \",\n) => {\n  const entries = getLabelEntries(label, lang);\n  return Array.isArray(entries) ? entries.join(`${delimiter}`) : entries;\n};\n","import sanitizeHtml from \"sanitize-html\";\n\nfunction createMarkup(html: string) {\n  return { __html: sanitizeHTML(html) };\n}\n\nfunction sanitizeAttributes(props: any, remove: string[]) {\n  const entries = Object.keys(props).filter((key) =>\n    !remove.includes(key) ? key : null,\n  );\n\n  const attributes = new Object();\n  entries.forEach((key) => {\n    attributes[key] = props[key];\n  });\n\n  return attributes as React.HTMLAttributes<HTMLElement>;\n}\n\nfunction sanitizeHTML(html: string) {\n  return sanitizeHtml(html, {\n    allowedAttributes: {\n      a: [\"href\"],\n      img: [\"alt\", \"src\", \"height\", \"width\"],\n    },\n    allowedSchemes: [\"http\", \"https\", \"mailto\"],\n    allowedTags: [\n      \"a\",\n      \"b\",\n      \"br\",\n      \"i\",\n      \"img\",\n      \"p\",\n      \"small\",\n      \"span\",\n      \"sub\",\n      \"sup\",\n    ],\n  });\n}\n\nexport { createMarkup, sanitizeAttributes, sanitizeHTML };\n","import { PrimitivesLabel } from \"src/types/primitives\";\nimport React from \"react\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledLabel = styled(\"span\", {});\n\nconst Label: React.FC<PrimitivesLabel> = (props) => {\n  const { as, label } = props;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"label\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <StyledLabel as={as} {...attributes}>\n      {getLabelAsString(label, attributes.lang as string) as string}\n    </StyledLabel>\n  );\n};\n\nexport default Label;\n","import { IIIFExternalWebResource, ImageService } from \"@iiif/presentation-3\";\n\nexport const useGetImageResource = (\n  resource: IIIFExternalWebResource,\n  size: string = \"200,\",\n  region: string = \"full\",\n) => {\n  /**\n   * defenseively ensure resource is not an array\n   */\n  if (Array.isArray(resource)) resource = resource[0];\n\n  const { id, service } = resource;\n\n  let imageService: ImageService | undefined;\n\n  /**\n   * return resource id if service does not exist\n   */\n  if (!service) return id;\n\n  if (Array.isArray(resource.service) && resource.service.length > 0)\n    imageService = service[0] as ImageService;\n\n  if (imageService) {\n    if (imageService[\"@id\"])\n      return `${imageService[\"@id\"]}/${region}/${size}/0/default.jpg`;\n\n    if (imageService.id)\n      return `${imageService.id}/${region}/${size}/0/default.jpg`;\n  }\n};\n","import React, { useCallback, useEffect, useRef } from \"react\";\n\nimport Hls from \"hls.js\";\nimport { PrimitivesContentResource } from \"src/types/primitives\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { useGetImageResource } from \"src/hooks/useGetImageResource\";\n\nconst StyledResource = styled(\"img\", { objectFit: \"cover\" });\n\nconst ContentResource: React.FC<PrimitivesContentResource> = (props) => {\n  const mediaRef = useRef(null);\n  const { contentResource, altAsLabel, region = \"full\" } = props;\n\n  let alt: string | undefined;\n  if (altAsLabel) alt = getLabelAsString(altAsLabel) as string;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"contentResource\", \"altAsLabel\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  const { type, id, width = 200, height = 200, duration } = contentResource;\n\n  useEffect(() => {\n    /**\n     * Check that IIIF content resource ID exists and\n     * we have a reffed <video> for attaching HLS\n     */\n    if (!id && !mediaRef.current) return;\n    if ([\"Image\"].includes(type)) return;\n\n    /**\n     * Eject HLS attachment if file extension from\n     * the IIIF content resource ID is not .m3u8\n     */\n    if (!id.includes(\"m3u8\")) return;\n\n    // Bind hls.js package to our <video /> element and then load the media source\n    const hls = new Hls();\n\n    if (mediaRef.current) {\n      hls.attachMedia(mediaRef.current);\n      hls.on(Hls.Events.MEDIA_ATTACHED, function () {\n        hls.loadSource(id as string);\n      });\n    }\n\n    // Handle errors\n    hls.on(Hls.Events.ERROR, function (event, data) {\n      if (data.fatal) {\n        switch (data.type) {\n          case Hls.ErrorTypes.NETWORK_ERROR:\n            // try to recover network error\n            console.error(\n              `fatal ${event} network error encountered, try to recover`,\n            );\n            hls.startLoad();\n            break;\n          case Hls.ErrorTypes.MEDIA_ERROR:\n            console.error(\n              `fatal ${event} media error encountered, try to recover`,\n            );\n            hls.recoverMediaError();\n            break;\n          default:\n            // cannot recover\n            hls.destroy();\n            break;\n        }\n      }\n    });\n\n    return () => {\n      if (hls) {\n        hls.detachMedia();\n        hls.destroy();\n      }\n    };\n  }, [id, type]);\n\n  const playLoop = useCallback(() => {\n    if (!mediaRef.current) return;\n\n    let startTime = 0;\n    let loopTime = 30;\n\n    if (duration) loopTime = duration;\n    if (!id.split(\"#t=\") && duration) startTime = duration * 0.1;\n\n    if (id.split(\"#t=\").pop()) {\n      const fragment = id.split(\"#t=\").pop();\n      if (fragment) startTime = parseInt(fragment.split(\",\")[0]);\n    }\n\n    const media: HTMLVideoElement = mediaRef.current;\n    media.autoplay = true;\n    media.currentTime = startTime;\n\n    setTimeout(() => playLoop(), loopTime * 1000);\n  }, [duration, id]);\n\n  useEffect(() => playLoop(), [playLoop]);\n\n  const imgSrc = useGetImageResource(\n    contentResource,\n    `${width},${height}`,\n    region,\n  );\n\n  switch (type) {\n    case \"Image\":\n      return (\n        <StyledResource\n          as=\"img\"\n          alt={alt}\n          css={{ width: width, height: height }}\n          key={id}\n          src={imgSrc}\n          {...attributes}\n        />\n      );\n\n    case \"Video\":\n      return (\n        <StyledResource\n          as=\"video\"\n          css={{ width: width, height: height }}\n          disablePictureInPicture\n          key={id}\n          loop\n          muted\n          onPause={playLoop}\n          ref={mediaRef}\n          src={id}\n        />\n      );\n\n    default:\n      console.warn(\n        `Resource type: ${type} is not valid or not yet supported in Primitives.`,\n      );\n      return <></>;\n  }\n};\n\nexport default ContentResource;\n","import React from \"react\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { PrimitivesHomepage } from \"src/types/primitives\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\n\nconst StyledHomepage = styled(\"a\", {});\n\nconst Homepage: React.FC<PrimitivesHomepage> = (props) => {\n  const { children, homepage } = props;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"children\", \"homepage\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <>\n      {homepage &&\n        homepage.map((resource) => {\n          const label = getLabelAsString(\n            resource.label,\n            attributes.lang,\n          ) as string;\n          return (\n            <StyledHomepage\n              aria-label={children ? label : undefined}\n              href={resource.id}\n              key={resource.id}\n              {...attributes}\n            >\n              {children ? children : label}\n            </StyledHomepage>\n          );\n        })}\n    </>\n  );\n};\n\nexport default Homepage;\n","import { createContext, useContext } from \"react\";\n\nimport React from \"react\";\n\ntype PrimitivesContextStore =\n  | {\n      delimiter: string; // Separator for multi-value items\n    }\n  | undefined;\ninterface ProviderProps {\n  children: React.ReactNode;\n  initialState?: PrimitivesContextStore;\n}\n\nconst defaultState = {\n  delimiter: \", \",\n};\n\nconst PrimitivesContext = createContext<PrimitivesContextStore>(undefined);\n\nconst usePrimitivesContext = () => {\n  const context = useContext(PrimitivesContext);\n  if (context === undefined) {\n    throw new Error(\n      \"usePrimitivesContext must be used with a PrimitivesProvider\",\n    );\n  }\n  return context;\n};\n\nconst PrimitivesProvider: React.FC<ProviderProps> = ({\n  children,\n  initialState = defaultState,\n}) => {\n  const delimiter = getRealPropertyValue(initialState, \"delimiter\");\n\n  return (\n    <PrimitivesContext.Provider value={{ delimiter }}>\n      {children}\n    </PrimitivesContext.Provider>\n  );\n};\n\nconst getRealPropertyValue = (\n  obj: { [key: string]: any },\n  property: string,\n) => {\n  const value = Object.hasOwn(obj, property)\n    ? obj[property].toString()\n    : undefined;\n  return value;\n};\n\nexport {\n  PrimitivesContext,\n  PrimitivesProvider,\n  getRealPropertyValue,\n  usePrimitivesContext,\n};\n","import {\n  PrimitivesContext,\n  PrimitivesProvider,\n  usePrimitivesContext,\n} from \"src/context/primitives-context\";\nimport { createMarkup, sanitizeAttributes } from \"src/lib/html-element\";\n\nimport { PrimitivesMarkup } from \"src/types/primitives\";\nimport React from \"react\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledMarkup = styled(\"span\", {});\n\nconst Markup: React.FC<PrimitivesMarkup> = (props) => {\n  const { as, markup } = props;\n  const { delimiter } = usePrimitivesContext();\n\n  if (!markup) return <></>;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"markup\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  const html = createMarkup(\n    getLabelAsString(markup, attributes.lang as string, delimiter) as string,\n  );\n\n  return (\n    <StyledMarkup as={as} {...attributes} dangerouslySetInnerHTML={html} />\n  );\n};\n\nconst MarkupWrapper: React.FC<PrimitivesMarkup> = (props) => {\n  const context = React.useContext(PrimitivesContext);\n\n  return context ? (\n    <Markup {...props} />\n  ) : (\n    <PrimitivesProvider>\n      <Markup {...props} />\n    </PrimitivesProvider>\n  );\n};\n\nexport default MarkupWrapper;\n","import React from \"react\";\nimport { PrimitivesValue } from \"src/types/primitives\";\nimport Markup from \"src/components/Primitives/Markup/Markup\";\n\nconst Value: React.FC<PrimitivesValue> = ({ as = \"dd\", lang, value }) => (\n  <Markup markup={value} as={as} lang={lang} />\n);\n\nexport default Value;\n","import React, { Fragment, cloneElement } from \"react\";\n\nimport { PrimitivesCustomValue } from \"src/types/primitives\";\nimport { getLabelEntries } from \"src/lib/label-helpers\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { usePrimitivesContext } from \"src/context/primitives-context\";\n\nconst StyledCustomValue = styled(\"span\", {});\n\nconst CustomValue: React.FC<PrimitivesCustomValue> = ({\n  as = \"dd\",\n  customValueContent,\n  lang,\n  value,\n}) => {\n  const { delimiter } = usePrimitivesContext();\n\n  const entries = getLabelEntries(value, lang)?.map((entry) => {\n    return cloneElement(customValueContent, {\n      value: entry,\n    });\n  });\n\n  return (\n    <StyledCustomValue as={as} lang={lang}>\n      {entries?.map((entry, index) => [\n        index > 0 && `${delimiter}`,\n        <Fragment key={index}>{entry}</Fragment>,\n      ])}\n    </StyledCustomValue>\n  );\n};\n\nexport default CustomValue;\n","import React from \"react\";\nimport Label from \"../Label/Label\";\nimport Value from \"../Value/Value\";\nimport { PrimitivesMetadataItem } from \"src/types/primitives\";\nimport CustomValue from \"../Value/CustomValue\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\n\nconst MetadataItem: React.FC<PrimitivesMetadataItem> = (props) => {\n  const { item, lang, customValueContent } = props;\n  const { label, value } = item;\n\n  /**\n   * Create value for data-label attribute for use as a selector\n   */\n  const dataAttribute = getLabelAsString(label)\n    ?.replace(\" \", \"-\")\n    .toLowerCase();\n\n  return (\n    <div role=\"group\" data-label={dataAttribute}>\n      <Label as=\"dt\" label={label} lang={lang} />\n      {customValueContent ? (\n        <CustomValue\n          as=\"dd\"\n          customValueContent={customValueContent}\n          value={value}\n          lang={lang}\n        />\n      ) : (\n        <Value as=\"dd\" value={value} lang={lang} />\n      )}\n    </div>\n  );\n};\n\nexport default MetadataItem;\n","import { InternationalString } from \"@iiif/presentation-3\";\nimport { PrimitivesCustomValueContent } from \"../types/primitives\";\nimport { getLabelAsString } from \"./label-helpers\";\n\nexport function parseCustomContent(\n  label: InternationalString,\n  valueArray: PrimitivesCustomValueContent[],\n) {\n  const customContent = valueArray\n    .filter((entry) => {\n      const { matchingLabel } = entry;\n      const lang = Object.keys(entry.matchingLabel)[0];\n      const labelPattern = getLabelAsString(matchingLabel, lang);\n\n      if (getLabelAsString(label, lang) === labelPattern) return true;\n    })\n    .map((entry) => entry.Content);\n\n  if (!Array.isArray(customContent)) return;\n\n  return customContent[0];\n}\n","import MetadataItem from \"src/components/Primitives/Metadata/Item\";\nimport { PrimitivesMetadata } from \"src/types/primitives\";\nimport { PrimitivesProvider } from \"src/context/primitives-context\";\nimport React from \"react\";\nimport { getRealPropertyValue } from \"src/lib/utils\";\nimport { parseCustomContent } from \"src/lib/custom\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledMetadata = styled(\"dl\", {});\n\nconst Metadata: React.FC<PrimitivesMetadata> = (props) => {\n  const { as, customValueContent, metadata } = props;\n\n  if (!Array.isArray(metadata)) return <></>;\n\n  const delimiter = getRealPropertyValue(props, \"customValueDelimiter\");\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\n    \"as\",\n    \"customValueContent\",\n    \"customValueDelimiter\",\n    \"metadata\",\n  ];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <PrimitivesProvider\n      {...(typeof delimiter === \"string\"\n        ? { initialState: { delimiter: delimiter as string } }\n        : undefined)}\n    >\n      {metadata.length > 0 && (\n        <StyledMetadata as={as} {...attributes}>\n          {metadata.map((item, index) => {\n            const customValue = customValueContent\n              ? parseCustomContent(item.label, customValueContent)\n              : undefined;\n\n            return (\n              <MetadataItem\n                customValueContent={customValue}\n                item={item}\n                key={index}\n                lang={attributes?.lang}\n              />\n            );\n          })}\n        </StyledMetadata>\n      )}\n    </PrimitivesProvider>\n  );\n};\n\nexport default Metadata;\n","import React from \"react\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { PrimitivesPartOf } from \"src/types/primitives\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\n\nconst StyledPartOf = styled(\"li\", {});\nconst StyledWrapper = styled(\"ul\", {});\n\nconst PartOf: React.FC<PrimitivesPartOf> = (props) => {\n  const { as, partOf } = props;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"partOf\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <StyledWrapper as={as}>\n      {partOf &&\n        partOf.map((resource) => {\n          const label = resource.label\n            ? (getLabelAsString(resource.label, attributes.lang) as string)\n            : undefined;\n          return (\n            <StyledPartOf key={resource.id}>\n              <a href={resource.id} {...attributes}>\n                {label ? label : resource.id}\n              </a>\n            </StyledPartOf>\n          );\n        })}\n    </StyledWrapper>\n  );\n};\n\nexport default PartOf;\n","import MetadataItem from \"src/components/Primitives/Metadata/Item\";\nimport { PrimitivesProvider } from \"src/context/primitives-context\";\nimport { PrimitivesRequiredStatement } from \"src/types/primitives\";\nimport React from \"react\";\nimport { getRealPropertyValue } from \"src/lib/utils\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledRequiredStatement = styled(\"dl\", {});\n\nconst RequiredStatement: React.FC<PrimitivesRequiredStatement> = (props) => {\n  const { as, requiredStatement } = props;\n\n  if (!requiredStatement) return <></>;\n\n  const delimiter = getRealPropertyValue(props, \"customValueDelimiter\");\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"customValueDelimiter\", \"requiredStatement\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <PrimitivesProvider\n      {...(typeof delimiter === \"string\"\n        ? { initialState: { delimiter: delimiter as string } }\n        : undefined)}\n    >\n      <StyledRequiredStatement as={as} {...attributes}>\n        <MetadataItem item={requiredStatement} lang={attributes.lang} />\n      </StyledRequiredStatement>\n    </PrimitivesProvider>\n  );\n};\n\nexport default RequiredStatement;\n","import React from \"react\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { getLabelAsString } from \"src/lib/label-helpers\";\nimport { PrimitivesSeeAlso } from \"src/types/primitives\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\n\nconst StyledSeeAlso = styled(\"li\", {});\nconst StyledWrapper = styled(\"ul\", {});\n\nconst SeeAlso: React.FC<PrimitivesSeeAlso> = (props) => {\n  const { as, seeAlso } = props;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"seeAlso\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <StyledWrapper as={as}>\n      {seeAlso &&\n        seeAlso.map((resource) => {\n          const label = getLabelAsString(\n            resource.label,\n            attributes.lang,\n          ) as string;\n          return (\n            <StyledSeeAlso key={resource.id}>\n              <a href={resource.id} {...attributes}>\n                {label ? label : resource.id}\n              </a>\n            </StyledSeeAlso>\n          );\n        })}\n    </StyledWrapper>\n  );\n};\n\nexport default SeeAlso;\n","import Markup from \"src/components/Primitives/Markup/Markup\";\nimport { PrimitivesSummary } from \"src/types/primitives\";\nimport React from \"react\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\n\nconst Summary: React.FC<PrimitivesSummary> = (props) => {\n  const { as, summary } = props;\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"as\", \"customValueDelimiter\", \"summary\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return <Markup as={as} markup={summary} {...attributes} />;\n};\n\nexport default Summary;\n","import {\n  PrimitivesExternalWebResource,\n  PrimitivesThumbnail,\n} from \"src/types/primitives\";\n\nimport ContentResource from \"src/components/Primitives/ContentResource/ContentResource\";\nimport React from \"react\";\nimport { sanitizeAttributes } from \"src/lib/html-element\";\n\nconst Thumbnail: React.FC<PrimitivesThumbnail> = (props) => {\n  const { thumbnail, region } = props;\n\n  /**\n   * Create attributes and remove React props\n   */\n  const remove = [\"thumbnail\"];\n  const attributes = sanitizeAttributes(props, remove);\n\n  return (\n    <>\n      {thumbnail &&\n        thumbnail.map((contentResource) => (\n          <ContentResource\n            contentResource={contentResource as PrimitivesExternalWebResource}\n            key={contentResource.id}\n            region={region}\n            {...attributes}\n          />\n        ))}\n    </>\n  );\n};\n\nexport default Thumbnail;\n","import { Homepage } from \"src/components/Primitives\";\nimport { PrimitivesExternalWebResource } from \"src/types/primitives\";\nimport React from \"react\";\n\ninterface PropertiesHomepageProps {\n  homepage: PrimitivesExternalWebResource[];\n}\n\nconst PropertiesHomepage: React.FC<PropertiesHomepageProps> = ({\n  homepage,\n}) => {\n  if (homepage?.length === 0) return <></>;\n\n  return (\n    <>\n      <span className=\"manifest-property-title\">Homepage</span>\n      <Homepage homepage={homepage} />\n    </>\n  );\n};\n\nexport default PropertiesHomepage;\n","import React from \"react\";\n\ninterface PropertiesIdProps {\n  id: string;\n  htmlLabel: string;\n  parent?: \"manifest\" | \"canvas\";\n}\n\nconst PropertiesId: React.FC<PropertiesIdProps> = ({\n  id,\n  htmlLabel,\n  parent = \"manifest\",\n}) => {\n  return (\n    <>\n      <span className=\"manifest-property-title\">{htmlLabel}</span>\n      <a href={id} target=\"_blank\" id={`iiif-${parent}-id`}>\n        {id}\n      </a>\n    </>\n  );\n};\n\nexport default PropertiesId;\n","import { MetadataItem } from \"@iiif/presentation-3\";\nimport React from \"react\";\nimport { Metadata } from \"src/components/Primitives\";\n\ninterface PropertiesMetadataProps {\n  metadata: MetadataItem[] | null;\n  parent?: \"manifest\" | \"canvas\";\n}\n\nconst PropertiesMetadata: React.FC<PropertiesMetadataProps> = ({\n  metadata,\n  parent = \"manifest\",\n}) => {\n  if (!metadata) return <></>;\n\n  return (\n    <>\n      <Metadata metadata={metadata} id={`iiif-${parent}-metadata`} />\n    </>\n  );\n};\n\nexport default PropertiesMetadata;\n","import { MetadataItem } from \"@iiif/presentation-3\";\nimport React from \"react\";\nimport { RequiredStatement } from \"src/components/Primitives\";\n\ninterface PropertiesSummaryProps {\n  requiredStatement: MetadataItem | null;\n  parent?: \"manifest\" | \"canvas\";\n}\n\nconst PropertiesRequiredStatement: React.FC<PropertiesSummaryProps> = ({\n  requiredStatement,\n  parent = \"manifest\",\n}) => {\n  if (!requiredStatement) return <></>;\n\n  return (\n    <>\n      <RequiredStatement\n        requiredStatement={requiredStatement}\n        id={`iiif-${parent}-required-statement`}\n      />\n    </>\n  );\n};\n\nexport default PropertiesRequiredStatement;\n","import React from \"react\";\n\ninterface PropertiesRightsProps {\n  rights: string | null;\n}\n\nconst PropertiesRights: React.FC<PropertiesRightsProps> = ({ rights }) => {\n  if (!rights) return <></>;\n\n  return (\n    <>\n      <span className=\"manifest-property-title\">Rights</span>\n      <a href={rights} target=\"_blank\">\n        {rights}\n      </a>\n    </>\n  );\n};\n\nexport default PropertiesRights;\n","import { PrimitivesExternalWebResource } from \"src/types/primitives\";\nimport { SeeAlso } from \"src/components/Primitives\";\nimport React from \"react\";\n\ninterface PropertiesSeeAlsoProps {\n  seeAlso: PrimitivesExternalWebResource[];\n}\n\nconst PropertiesSeeAlso: React.FC<PropertiesSeeAlsoProps> = ({ seeAlso }) => {\n  if (seeAlso?.length === 0) return <></>;\n\n  return (\n    <>\n      <span className=\"manifest-property-title\">See Also</span>\n      <SeeAlso seeAlso={seeAlso} />\n    </>\n  );\n};\n\nexport default PropertiesSeeAlso;\n","import { InternationalString } from \"@iiif/presentation-3\";\nimport React from \"react\";\nimport { Summary } from \"src/components/Primitives\";\n\ninterface PropertiesSummaryProps {\n  summary: InternationalString | null;\n  parent?: \"manifest\" | \"canvas\";\n}\n\nconst PropertiesSummary: React.FC<PropertiesSummaryProps> = ({\n  summary,\n  parent = \"manifest\",\n}) => {\n  if (!summary) return <></>;\n\n  return (\n    <>\n      <Summary summary={summary} as=\"p\" id={`iiif-${parent}-summary`} />\n    </>\n  );\n};\n\nexport default PropertiesSummary;\n","import {\n  IIIFExternalWebResource,\n  InternationalString,\n} from \"@iiif/presentation-3\";\n\nimport React from \"react\";\nimport { Thumbnail } from \"src/components/Primitives\";\n\ninterface PropertiesThumbnailProps {\n  label: InternationalString | null;\n  thumbnail: IIIFExternalWebResource[];\n}\n\nconst PropertiesThumbnail: React.FC<PropertiesThumbnailProps> = ({\n  label,\n  thumbnail,\n}) => {\n  if (thumbnail?.length === 0) return <></>;\n\n  return (\n    <>\n      <Thumbnail\n        altAsLabel={label ? label : { none: [\"resource\"] }}\n        thumbnail={thumbnail}\n        style={{ backgroundColor: \"#6663\", objectFit: \"cover\" }}\n      />\n    </>\n  );\n};\n\nexport default PropertiesThumbnail;\n","import {\n  AboutContent,\n  AboutStyled,\n} from \"src/components/Viewer/InformationPanel/About/About.styled\";\nimport {\n  Homepage,\n  Id,\n  Metadata,\n  RequiredStatement,\n  Rights,\n  SeeAlso,\n  Summary,\n  Thumbnail,\n} from \"src/components/Viewer/Properties\";\nimport {\n  IIIFExternalWebResource,\n  ManifestNormalized,\n} from \"@iiif/presentation-3\";\nimport React, { useEffect, useState } from \"react\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\n\nimport { PrimitivesExternalWebResource } from \"src/types/primitives\";\n\nconst About: React.FC = () => {\n  const viewerState: ViewerContextStore = useViewerState();\n  const { activeManifest, vault } = viewerState;\n\n  const [manifest, setManifest] = useState<ManifestNormalized>();\n\n  const [homepage, setHomepage] = useState<IIIFExternalWebResource[]>([]);\n  const [seeAlso, setSeeAlso] = useState<IIIFExternalWebResource[]>([]);\n  const [thumbnail, setThumbnail] = useState<IIIFExternalWebResource[]>([]);\n\n  useEffect(() => {\n    const data: ManifestNormalized = vault.get(activeManifest);\n    setManifest(data);\n\n    if (data.homepage?.length > 0) setHomepage(vault.get(data.homepage));\n    if (data.seeAlso?.length > 0) setSeeAlso(vault.get(data.seeAlso));\n    if (data.thumbnail?.length > 0) setThumbnail(vault.get(data.thumbnail));\n  }, [activeManifest, vault]);\n\n  if (!manifest) return <></>;\n\n  return (\n    <AboutStyled>\n      <AboutContent>\n        <Thumbnail thumbnail={thumbnail} label={manifest.label} />\n        <Summary summary={manifest.summary} />\n        <Metadata metadata={manifest.metadata} />\n        <RequiredStatement requiredStatement={manifest.requiredStatement} />\n        <Rights rights={manifest.rights} />\n        <Homepage\n          homepage={homepage as unknown as PrimitivesExternalWebResource[]}\n        />\n        <SeeAlso\n          seeAlso={seeAlso as unknown as PrimitivesExternalWebResource[]}\n        />\n        <Id id={manifest.id} htmlLabel=\"IIIF Manifest\" />\n      </AboutContent>\n    </AboutStyled>\n  );\n};\n\nexport default About;\n","import {\n  Content,\n  List,\n  Scroll,\n  Trigger,\n  Wrapper,\n} from \"src/components/Viewer/InformationPanel/InformationPanel.styled\";\nimport React, { useEffect, useState } from \"react\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\nimport AnnotationPage from \"src/components/Viewer/InformationPanel/Annotation/Page\";\nimport ContentSearch from \"src/components/Viewer/InformationPanel/ContentSearch/ContentSearch\";\nimport { AnnotationResources, AnnotationResource } from \"src/types/annotations\";\nimport Information from \"src/components/Viewer/InformationPanel/About/About\";\nimport {\n  InternationalString,\n  AnnotationPageNormalized,\n} from \"@iiif/presentation-3\";\nimport { Label } from \"src/components/Primitives\";\n\ninterface NavigatorProps {\n  activeCanvas: string;\n  annotationResources?: AnnotationResources;\n  searchServiceUrl?: string;\n  setContentSearchResource: React.Dispatch<\n    React.SetStateAction<AnnotationPageNormalized | undefined>\n  >;\n  contentSearchResource?: AnnotationResource;\n}\n\nexport const InformationPanel: React.FC<NavigatorProps> = ({\n  activeCanvas,\n  annotationResources,\n  searchServiceUrl,\n  setContentSearchResource,\n  contentSearchResource,\n}) => {\n  const viewerState: ViewerContextStore = useViewerState();\n  const {\n    configOptions: { informationPanel },\n  } = viewerState;\n\n  const [activeResource, setActiveResource] = useState<string>();\n\n  const renderAbout = informationPanel?.renderAbout;\n  const renderAnnotation = informationPanel?.renderAnnotation;\n  const renderContentSearch = informationPanel?.renderContentSearch;\n\n  useEffect(() => {\n    if (activeResource) {\n      return;\n    } else if (renderContentSearch) {\n      setActiveResource(\"manifest-content-search\");\n    } else if (renderAbout) {\n      setActiveResource(\"manifest-about\");\n    } else if (\n      annotationResources &&\n      annotationResources?.length > 0 &&\n      !renderAbout\n    ) {\n      setActiveResource(annotationResources[0].id);\n    }\n  }, [\n    activeCanvas,\n    activeResource,\n    renderAbout,\n    renderContentSearch,\n    annotationResources,\n    contentSearchResource,\n  ]);\n\n  const handleValueChange = (value: string) => {\n    setActiveResource(value);\n  };\n\n  return (\n    <Wrapper\n      data-testid=\"information-panel\"\n      defaultValue={activeResource}\n      onValueChange={handleValueChange}\n      orientation=\"horizontal\"\n      value={activeResource}\n      className=\"clover-viewer-information-panel\"\n    >\n      <List aria-label=\"select chapter\" data-testid=\"information-panel-list\">\n        {renderContentSearch && contentSearchResource && (\n          <Trigger value=\"manifest-content-search\">\n            <Label label={contentSearchResource.label as InternationalString} />\n          </Trigger>\n        )}\n        {renderAbout && <Trigger value=\"manifest-about\">About</Trigger>}\n        {renderAnnotation &&\n          annotationResources &&\n          annotationResources.map((resource, i) => (\n            <Trigger key={i} value={resource.id}>\n              <Label label={resource.label as InternationalString} />\n            </Trigger>\n          ))}\n      </List>\n      <Scroll>\n        {renderContentSearch && contentSearchResource && (\n          <Content value=\"manifest-content-search\">\n            <ContentSearch\n              searchServiceUrl={searchServiceUrl}\n              setContentSearchResource={setContentSearchResource}\n              activeCanvas={activeCanvas}\n              annotationPage={contentSearchResource}\n            />\n          </Content>\n        )}\n        {renderAbout && (\n          <Content value=\"manifest-about\">\n            <Information />\n          </Content>\n        )}\n        {renderAnnotation &&\n          annotationResources &&\n          annotationResources.map((annotationPage) => {\n            return (\n              <Content key={annotationPage.id} value={annotationPage.id}>\n                <AnnotationPage annotationPage={annotationPage} />\n              </Content>\n            );\n          })}\n      </Scroll>\n    </Wrapper>\n  );\n};\n\nexport default InformationPanel;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst Form = styled(\"div\", {\n  position: \"absolute\",\n  right: \"1rem\",\n  top: \"1rem\",\n  display: \"flex\",\n  justifyContent: \"flex-end\",\n  zIndex: \"1\",\n});\n\nconst Input = styled(\"input\", {\n  flexGrow: \"1\",\n  border: \"none\",\n  backgroundColor: \"$secondaryMuted\",\n  color: \"$primary\",\n  marginRight: \"1rem\",\n  height: \"2rem\",\n  padding: \"0 1rem\",\n  borderRadius: \"2rem\",\n  fontFamily: \"inherit\",\n  fontSize: \"1rem\",\n  lineHeight: \"1rem\",\n  boxShadow: \"inset 1px 1px 2px #0003\",\n\n  \"&::placeholder\": {\n    color: \"$primaryMuted\",\n  },\n});\n\nconst Button = styled(\"button\", {\n  display: \"flex\",\n  background: \"none\",\n  border: \"none\",\n  width: \"2rem !important\",\n  height: \"2rem !important\",\n  padding: \"0\",\n  margin: \"0\",\n  fontWeight: \"700\",\n  borderRadius: \"2rem\",\n  backgroundColor: \"$accent\",\n  color: \"$secondary\",\n  cursor: \"pointer\",\n  boxSizing: \"content-box !important\",\n  transition: \"$all\",\n\n  svg: {\n    height: \"60%\",\n    width: \"60%\",\n    padding: \"20%\",\n    fill: \"$secondary\",\n    stroke: \"$secondary\",\n    opacity: \"1\",\n    filter: \"drop-shadow(5px 5px 5px #000D)\",\n    boxSizing: \"inherit\",\n    transition: \"$all\",\n  },\n\n  \"&:disabled\": {\n    backgroundColor: \"transparent\",\n    boxShadow: \"none\",\n    svg: { opacity: \"0.25\" },\n  },\n});\n\nconst Direction = styled(\"div\", {\n  display: \"flex\",\n  marginRight: \"0.618rem\",\n  backgroundColor: \"$accentAlt\",\n  borderRadius: \"2rem\",\n  boxShadow: \"5px 5px 5px #0003\",\n  color: \"$secondary\",\n  alignItems: \"center\",\n\n  \"> span\": {\n    display: \"flex\",\n    margin: \"0 0.5rem\",\n    fontSize: \"0.7222rem\",\n  },\n});\n\nconst Wrapper = styled(\"div\", {\n  display: \"flex\",\n  position: \"relative\",\n  zIndex: \"1\",\n  width: \"100%\",\n  padding: \"0\",\n  transition: \"$all\",\n\n  variants: {\n    isToggle: {\n      true: {\n        paddingTop: \"2.618rem\",\n\n        [`& ${Form}`]: {\n          width: \"calc(100% - 2rem)\",\n\n          \"@sm\": {\n            width: \"calc(100% - 2rem)\",\n          },\n        },\n      },\n    },\n  },\n});\n\nexport { Button, Direction, Form, Input, Wrapper };\n","import { useEffect } from \"react\";\n/**\n * useKeyPress\n * @param {string} key - the name of the key to respond to, compared against event.key\n * @param {function} action - the action to perform on key press\n */\nconst useKeyPress = (key: string, action: () => void) => {\n  useEffect(() => {\n    function onKeyup(e: KeyboardEvent) {\n      if (e.key === key) action();\n    }\n    window.addEventListener(\"keyup\", onKeyup);\n    return () => window.removeEventListener(\"keyup\", onKeyup);\n  }, []);\n};\n\nexport default useKeyPress;\n","import {\n  Button,\n  Direction,\n  Form,\n  Input,\n  Wrapper,\n} from \"src/components/Viewer/Media/Controls.styled\";\nimport React, { useEffect, useState } from \"react\";\n\nimport useKeyPress from \"src/hooks/useKeyPress\";\n\ninterface Props {\n  handleCanvasToggle: (arg0: -1 | 1) => void;\n  handleFilter: (arg0: string) => void;\n  activeIndex: number;\n  canvasLength: number;\n}\nconst PreviousIcon: React.FC = () => {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n      <title>Arrow Back</title>\n      <path\n        fill=\"none\"\n        stroke=\"currentColor\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeMiterlimit=\"10\"\n        strokeWidth=\"45\"\n        d=\"M244 400L100 256l144-144M120 256h292\"\n      />\n    </svg>\n  );\n};\n\nconst NextIcon: React.FC = () => {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n      <title>Arrow Forward</title>\n      <path\n        fill=\"none\"\n        stroke=\"currentColor\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeMiterlimit=\"10\"\n        strokeWidth=\"45\"\n        d=\"M268 112l144 144-144 144M392 256H100\"\n      />\n    </svg>\n  );\n};\n\nconst CloseIcon: React.FC = () => {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n      <title>Close</title>\n      <path d=\"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z\" />\n    </svg>\n  );\n};\n\nconst SearchIcon: React.FC = () => {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\">\n      <title>Search</title>\n      <path d=\"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z\" />\n    </svg>\n  );\n};\n\nconst Controls: React.FC<Props> = ({\n  handleCanvasToggle,\n  handleFilter,\n  activeIndex,\n  canvasLength,\n}) => {\n  const [toggleFilter, setToggleFilter] = useState<boolean>(false);\n  const [isNextDisabled, setIsNextDisabled] = useState<boolean>(false);\n  const [isPreviousDisabled, setIsPreviousDisabled] = useState<boolean>(false);\n\n  useEffect(() => {\n    activeIndex === 0\n      ? setIsPreviousDisabled(true)\n      : setIsPreviousDisabled(false);\n    activeIndex === canvasLength - 1\n      ? setIsNextDisabled(true)\n      : setIsNextDisabled(false);\n  }, [activeIndex, canvasLength]);\n\n  /**\n   * dismiss filtering if Escape key is pressed\n   */\n  useKeyPress(\"Escape\", () => {\n    setToggleFilter(false);\n    handleFilter(\"\");\n  });\n\n  /**\n   * reset filtering on manual toggle button press\n   */\n  const handleFilterToggle = () => {\n    setToggleFilter((prevToggleFilter) => !prevToggleFilter);\n    handleFilter(\"\");\n  };\n\n  /**\n   * handle value changes on Input\n   */\n  const handleFilterChange = (event: React.ChangeEvent<HTMLInputElement>) =>\n    handleFilter(event.target.value);\n\n  return (\n    <Wrapper isToggle={toggleFilter}>\n      <Form>\n        {toggleFilter && (\n          <Input autoFocus onChange={handleFilterChange} placeholder=\"Search\" />\n        )}\n        {!toggleFilter && (\n          <Direction>\n            <Button\n              onClick={() => handleCanvasToggle(-1)}\n              disabled={isPreviousDisabled}\n              type=\"button\"\n            >\n              <PreviousIcon />\n            </Button>\n            <span>\n              {activeIndex + 1} of {canvasLength}\n            </span>\n            <Button\n              onClick={() => handleCanvasToggle(1)}\n              disabled={isNextDisabled}\n              type=\"button\"\n            >\n              <NextIcon />\n            </Button>\n          </Direction>\n        )}\n        <Button onClick={handleFilterToggle} type=\"button\">\n          {toggleFilter ? <CloseIcon /> : <SearchIcon />}\n        </Button>\n      </Form>\n    </Wrapper>\n  );\n};\n\nexport default Controls;\n","import * as RadioGroup from \"@radix-ui/react-radio-group\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst Group = styled(RadioGroup.Root, {\n  display: \"flex\",\n  flexDirection: \"row\",\n  flexGrow: \"1\",\n  padding: \"1.618rem\",\n  overflowX: \"scroll\",\n  position: \"relative\",\n  zIndex: \"0\",\n});\n\nexport { Group };\n","import React from \"react\";\n\nconst Add: React.FC = () => (\n  <path\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    strokeWidth=\"32\"\n    d=\"M256 112v288M400 256H112\"\n  />\n);\n\nexport default Add;\n","import React from \"react\";\n\nconst Audio: React.FC = () => (\n  <>\n    <path d=\"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z\" />\n    <path d=\"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z\" />\n    <path d=\"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z\" />\n  </>\n);\n\nexport default Audio;\n","import React from \"react\";\n\nconst Close: React.FC = () => (\n  <path d=\"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z\" />\n);\n\nexport default Close;\n","import React from \"react\";\n\nconst Image: React.FC = () => (\n  <path d=\"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z\" />\n);\n\nexport default Image;\n","import React from \"react\";\n\nconst Video: React.FC = () => (\n  <path d=\"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z\" />\n);\n\nexport default Video;\n","import { styled } from \"src/styles/stitches.config\";\n\nexport const StyledIcon = styled(\"svg\", {\n  display: \"inline-flex\",\n\n  variants: {\n    isLarge: {\n      true: {\n        height: \"4rem\",\n        width: \"4rem\",\n      },\n    },\n    isMedium: {\n      true: {\n        height: \"2rem\",\n        width: \"2rem\",\n      },\n    },\n    isSmall: {\n      true: {\n        height: \"1rem\",\n        width: \"1rem\",\n      },\n    },\n  },\n});\n","import { Add, Audio, Close, Image, Video } from \"src/components/internal/Icons\";\nimport { type CSS, type VariantProps } from \"src/styles/stitches.config\";\n\nimport React from \"react\";\nimport { StyledIcon } from \"./Icon.styled\";\n\n/**\n * Define SVG subelement <title>\n */\ntype TitleShape = {\n  children: React.ReactNode;\n};\n\nconst Title: React.FC<TitleShape> = ({ children }) => {\n  return <title>{children}</title>;\n};\n\n/**\n * Define <svg>\n */\n\ntype IconShape = {\n  children: React.ReactNode | React.ReactNode[];\n};\ninterface IconComposition {\n  Add: React.FC;\n  Audio: React.FC;\n  Close: React.FC;\n  Image: React.FC;\n  Title: React.FC<TitleShape>;\n  Video: React.FC;\n}\n\ntype VariantComponentProps = React.SVGAttributes<SVGElement>;\ntype IconVariants = VariantProps<typeof StyledIcon>;\ntype IconProps = VariantComponentProps &\n  IconVariants & { css?: CSS } & IconShape;\n\nconst Icon: React.FC<IconProps> & IconComposition = (props) => {\n  return (\n    <StyledIcon\n      {...props}\n      data-testid=\"icon-svg\"\n      role=\"img\"\n      viewBox=\"0 0 512 512\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      {props.children}\n    </StyledIcon>\n  );\n};\n\n/**\n * Title\n */\nIcon.Title = Title;\n\n/**\n * Path\n */\nIcon.Add = Add;\nIcon.Audio = Audio;\nIcon.Close = Close;\nIcon.Image = Image;\nIcon.Video = Video;\n\nexport { Icon };\n","import * as Popover from \"@radix-ui/react-popover\";\n\nimport { keyframes, styled } from \"src/styles/stitches.config\";\n\nconst slideDown = keyframes({\n  \"0%\": { opacity: 0, transform: \"translateY(1rem)\" },\n  \"100%\": { opacity: 1, transform: \"translateY(0)\" },\n});\n\nconst slideUp = keyframes({\n  \"0%\": { opacity: 0, transform: \"translateY(1rem)\" },\n  \"100%\": { opacity: 1, transform: \"translateY(0)\" },\n});\n\nconst StyledArrow = styled(Popover.Arrow, {\n  fill: \"$secondaryAlt\",\n});\n\nconst StyledClose = styled(Popover.Close, {\n  position: \"absolute\",\n  right: \"0\",\n  top: \"0\",\n  padding: \"0.5rem\",\n  margin: \"0\",\n  cursor: \"pointer\",\n  border: \"none\",\n  background: \"none\",\n  fill: \"inherit\",\n\n  \"&:hover\": {\n    opacity: \"0.75\",\n  },\n});\n\nconst StyledContent = styled(Popover.Content, {\n  border: \"none\",\n  backgroundColor: \"white\",\n  fill: \"inhrerit\",\n  padding: \"1rem 2rem 1rem 1rem\",\n  width: \"auto\",\n  minWidth: \"200px\",\n  maxWidth: \"350px\",\n  borderRadius: \"3px\",\n  boxShadow: \"5px 5px 13px #0002\",\n\n  /**\n   * Animate toggle\n   */\n  animationDuration: \"0.3s\",\n  animationTimingFunction: \"cubic-bezier(0.16, 1, 0.3, 1)\",\n  '&[data-side=\"top\"]': { animationName: slideUp },\n  '&[data-side=\"bottom\"]': { animationName: slideDown },\n\n  /**\n   *\n   */\n  '&[data-align=\"end\"]': {\n    [`& ${StyledArrow}`]: {\n      margin: \"0 0.7rem\",\n    },\n  },\n});\n\nconst StyledTrigger = styled(Popover.Trigger, {\n  display: \"inline-flex\",\n  padding: \"0.5rem 0\",\n  margin: \"0 0.5rem 0 0\",\n  cursor: \"pointer\",\n  border: \"none\",\n  background: \"none\",\n\n  \"> button, > span\": {\n    margin: \"0\",\n  },\n});\n\nconst StyledPopover = styled(Popover.Root, {\n  boxSizing: \"content-box\",\n});\n\nexport {\n  StyledArrow,\n  StyledClose,\n  StyledContent,\n  StyledPopover,\n  StyledTrigger,\n};\n","import { CSS, VariantProps } from \"src/styles/stitches.config\";\nimport {\n  StyledArrow,\n  StyledClose,\n  StyledContent,\n  StyledPopover,\n  StyledTrigger,\n} from \"./Popover.styled\";\n\nimport { Icon } from \"../Icon/Icon\";\nimport React from \"react\";\n\n/**\n *\n */\ntype TriggerShape = {\n  children: React.ReactNode;\n  \"aria-controls\"?: string;\n};\n\ntype TriggerComponentProps = React.ButtonHTMLAttributes<HTMLButtonElement>;\ntype TriggerProps = TriggerComponentProps & TriggerShape & { css?: CSS };\n\nconst Trigger: React.FC<TriggerProps> = (props) => {\n  return <StyledTrigger {...props}>{props.children}</StyledTrigger>;\n};\n\n/**\n *\n */\ntype ContentShape = {\n  children: React.ReactNode | React.ReactNode[];\n  id?: string;\n};\n\ntype ContentComponentProps = React.HTMLAttributes<HTMLDivElement>;\ntype ContentVariants = VariantProps<typeof StyledContent>;\ntype ContentProps = ContentComponentProps &\n  ContentShape &\n  ContentVariants & { css?: CSS };\n\nconst Content: React.FC<ContentProps> = (props) => {\n  return (\n    <StyledContent {...props}>\n      <StyledArrow />\n      <StyledClose>\n        <Icon isSmall>\n          <Icon.Close />\n        </Icon>\n      </StyledClose>\n      {props.children}\n    </StyledContent>\n  );\n};\n\n/**\n *\n */\ntype PopoverShape = {\n  children: React.ReactChild | React.ReactChild[];\n};\n\ninterface PopoverComposition {\n  Content: React.FC<ContentShape & ContentVariants>;\n  Trigger: React.FC<TriggerShape>;\n}\n\ntype PopoverProps = PopoverShape & { css?: CSS };\n\nconst Popover: React.FC<PopoverProps> & PopoverComposition = ({ children }) => {\n  return <StyledPopover>{children}</StyledPopover>;\n};\n\nPopover.Trigger = Trigger;\nPopover.Content = Content;\n\nexport { Popover };\n","import { StyledIcon } from \"../Icon/Icon.styled\";\nimport { styled } from \"src/styles/stitches.config\";\n\nexport const Tag = styled(\"div\", {\n  // Reset\n  boxSizing: \"border-box\",\n\n  // Custom\n  display: \"inline-flex\",\n  alignItems: \"center\",\n  borderRadius: \"5px\",\n  padding: \"$1\",\n  marginBottom: \"$2\",\n  marginRight: \"$2\",\n  backgroundColor: \"$lightGrey\",\n  color: \"$richBlack50\",\n  textTransform: \"uppercase\",\n  fontSize: \"$2\",\n  objectFit: \"contain\",\n  lineHeight: \"1em !important\",\n\n  \"&:last-child\": {\n    marginRight: \"0\",\n  },\n\n  [`${StyledIcon}`]: {\n    position: \"absolute\",\n    left: \"$1\",\n    height: \"$3\",\n    width: \"$3\",\n  },\n\n  variants: {\n    isIcon: {\n      true: { position: \"relative\", paddingLeft: \"$5\" },\n    },\n  },\n});\n","import * as RadioGroup from \"@radix-ui/react-radio-group\";\n\nimport { Tag } from \"src/components/internal\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst Type = styled(\"span\", {\n  display: \"flex\",\n});\n\nconst Spacer = styled(\"span\", {\n  display: \"flex\",\n  width: \"1.2111rem\",\n  height: \"0.7222rem\",\n});\n\nconst Duration = styled(\"span\", {\n  display: \"inline-flex\",\n  marginLeft: \"5px\",\n  marginBottom: \"-1px\",\n});\n\nconst Item = styled(RadioGroup.Item, {\n  display: \"flex\",\n  flexShrink: \"0\",\n  margin: \"0 1.618rem 0 0\",\n  padding: \"0\",\n  cursor: \"pointer\",\n  background: \"none\",\n  border: \"none\",\n  fontFamily: \"inherit\",\n  lineHeight: \"1.25em\",\n  fontSize: \"1rem\",\n  textAlign: \"left\",\n\n  \"&:last-child\": {\n    marginRight: \"1rem\",\n  },\n\n  figure: {\n    margin: \"0\",\n    width: \"161.8px\",\n\n    \"> div\": {\n      position: \"relative\",\n      display: \"flex\",\n      backgroundColor: \"$secondaryAlt\",\n      width: \"inherit\",\n      height: \"100px\",\n      overflow: \"hidden\",\n      borderRadius: \"3px\",\n      transition: \"$all\",\n\n      img: {\n        width: \"100%\",\n        height: \"100%\",\n        objectFit: \"cover\",\n        filter: \"blur(0)\",\n        transform: \"scale3d(1, 1, 1)\",\n        transition: \"$all\",\n        color: \"transparent\",\n      },\n\n      [`& ${Type}`]: {\n        position: \"absolute\",\n        right: \"0\",\n        bottom: \"0\",\n\n        [`& ${Tag}`]: {\n          margin: \"0\",\n          paddingLeft: \"0\",\n          fontSize: \"0.7222rem\",\n          backgroundColor: \"#000d\",\n          color: \"$secondary\",\n          fill: \"$secondary\",\n          borderBottomLeftRadius: \"0\",\n          borderTopRightRadius: \"0\",\n        },\n      },\n    },\n\n    figcaption: {\n      marginTop: \"0.5rem\",\n      fontWeight: \"400\",\n      fontSize: \"0.8333rem\",\n      display: \"-webkit-box\",\n      overflow: \"hidden\",\n      MozBoxOrient: \"vertical\",\n      WebkitBoxOrient: \"vertical\",\n      WebkitLineClamp: \"5\",\n\n      \"@sm\": {\n        fontSize: \"0.8333rem\",\n      },\n    },\n  },\n\n  \"&[aria-checked='true']\": {\n    figure: {\n      \"> div\": {\n        backgroundColor: \"$primaryAlt\",\n\n        \"&::before\": {\n          position: \"absolute\",\n          zIndex: \"1\",\n          color: \"$secondaryMuted\",\n          content: \"Active Item\",\n          textTransform: \"uppercase\",\n          fontWeight: \"700\",\n          fontSize: \"0.6111rem\",\n          letterSpacing: \"0.03rem\",\n          display: \"flex\",\n          width: \"100%\",\n          height: \"100%\",\n          flexDirection: \"column\",\n          justifyContent: \"center\",\n          textAlign: \"center\",\n          textShadow: \"5px 5px 5px #0003\",\n        },\n\n        img: {\n          opacity: \"0.3\",\n          transform: \"scale3d(1.1, 1.1, 1.1)\",\n          filter: \"blur(2px)\",\n        },\n\n        [`& ${Type}`]: {\n          [`& ${Tag}`]: {\n            backgroundColor: \"$accent\",\n          },\n        },\n      },\n    },\n\n    figcaption: {\n      fontWeight: \"700\",\n    },\n  },\n});\n\nexport { Duration, Item, Spacer, Type };\n","import {\n  CanvasNormalized,\n  IIIFExternalWebResource,\n} from \"@iiif/presentation-3\";\nimport {\n  Duration,\n  Item,\n  Spacer,\n  Type,\n} from \"src/components/Viewer/Media/Thumbnail.styled\";\nimport { Icon, Tag } from \"src/components/internal\";\n\nimport { Label } from \"src/components/Primitives\";\nimport React from \"react\";\nimport { convertTime } from \"src/lib/utils\";\nimport { getLabel } from \"src/hooks/use-iiif\";\n\n/**\n * Determine appropriate icon by resource type\n */\ninterface IconPathProps {\n  type: string;\n}\n\nconst IconPath: React.FC<IconPathProps> = ({ type }) => {\n  switch (type) {\n    case \"Sound\":\n      return <Icon.Audio />;\n    case \"Image\":\n      return <Icon.Image />;\n    case \"Video\":\n      return <Icon.Video />;\n    default:\n      return <Icon.Image />;\n  }\n};\n\n/**\n * Render thumbnail for IIIF canvas item\n */\nexport interface ThumbnailProps {\n  canvas: CanvasNormalized;\n  canvasIndex: number;\n  isActive: boolean;\n  thumbnail?: IIIFExternalWebResource;\n  type: string;\n  handleChange: (arg0: string) => void;\n}\n\nconst Thumbnail: React.FC<ThumbnailProps> = ({\n  canvas,\n  canvasIndex,\n  isActive,\n  thumbnail,\n  type,\n  handleChange,\n}) => {\n  return (\n    <Item\n      aria-checked={isActive}\n      data-testid=\"media-thumbnail\"\n      data-canvas={canvasIndex}\n      onClick={() => handleChange(canvas.id)}\n      value={canvas.id}\n    >\n      <figure>\n        <div>\n          {thumbnail?.id && (\n            <img\n              src={thumbnail.id}\n              alt={canvas?.label ? (getLabel(canvas.label) as string) : \"\"}\n            />\n          )}\n\n          <Type>\n            <Tag isIcon data-testid=\"thumbnail-tag\">\n              <Spacer />\n              <Icon aria-label={type}>\n                <IconPath type={type} />\n              </Icon>\n              {[\"Video\", \"Sound\"].includes(type) && (\n                <Duration>{convertTime(canvas.duration as number)}</Duration>\n              )}\n            </Tag>\n          </Type>\n        </div>\n        {canvas?.label && (\n          <figcaption data-testid=\"fig-caption\">\n            <Label label={canvas.label} />\n          </figcaption>\n        )}\n      </figure>\n    </Item>\n  );\n};\n\nexport default Thumbnail;\n","export const getResourceType = (annotation: any): string => {\n  if (!annotation.body) return \"Image\";\n\n  return annotation.body.type;\n};\n","import {\n  Canvas,\n  CanvasNormalized,\n  ExternalResourceTypes,\n} from \"@iiif/presentation-3\";\nimport React, { useEffect, useState } from \"react\";\nimport {\n  ViewerContextStore,\n  useViewerDispatch,\n  useViewerState,\n} from \"src/context/viewer-context\";\nimport {\n  getCanvasByCriteria,\n  getLabel,\n  getThumbnail,\n} from \"src/hooks/use-iiif\";\n\nimport { CanvasEntity } from \"src/hooks/use-iiif/getCanvasByCriteria\";\nimport Controls from \"src/components/Viewer/Media/Controls\";\nimport { Group } from \"src/components/Viewer/Media/Media.styled\";\nimport Thumbnail from \"src/components/Viewer/Media/Thumbnail\";\nimport { getResourceType } from \"src/hooks/use-iiif/getResourceType\";\n\ninterface MediaProps {\n  items: Canvas[];\n  activeItem: number;\n}\n\nconst Media: React.FC<MediaProps> = ({ items }) => {\n  const dispatch: any = useViewerDispatch();\n  const state: ViewerContextStore = useViewerState();\n  const { activeCanvas, vault } = state;\n\n  const [filter, setFilter] = useState<string>(\"\");\n  const [mediaItems, setMediaItems] = useState<Array<CanvasEntity>>([]);\n  const [activeIndex, setActiveIndex] = useState<number>(0);\n\n  const scrollRef = React.useRef<HTMLDivElement>(null);\n\n  const motivation = \"painting\";\n\n  const handleChange = (canvasId: string) => {\n    if (activeCanvas !== canvasId)\n      dispatch({\n        type: \"updateActiveCanvas\",\n        canvasId: canvasId,\n      });\n  };\n\n  useEffect(() => {\n    if (!mediaItems.length) {\n      const paintingType: ExternalResourceTypes[] = [\"Image\", \"Sound\", \"Video\"];\n      const entities: CanvasEntity[] = items\n        .map((item) =>\n          getCanvasByCriteria(vault, item, motivation, paintingType),\n        )\n        .filter((canvasEntity) => canvasEntity.annotations.length > 0);\n      setMediaItems(entities);\n    }\n  }, [items, mediaItems.length, vault]);\n\n  useEffect(() => {\n    mediaItems.forEach((item, index) => {\n      if (item?.canvas)\n        if (item.canvas.id === activeCanvas) setActiveIndex(index);\n    });\n  }, [activeCanvas, mediaItems]);\n\n  useEffect(() => {\n    const element = document.querySelector<HTMLElement>(\n      `[data-canvas=\"${activeIndex}\"]`,\n    ) as Element;\n\n    if (element instanceof HTMLElement && scrollRef.current) {\n      const leftPos =\n        element.offsetLeft -\n        scrollRef.current.offsetWidth / 2 +\n        element.offsetWidth / 2;\n      scrollRef.current.scrollTo({ left: leftPos, behavior: \"smooth\" });\n    }\n  }, [activeIndex]);\n\n  const handleFilter = (value: string) => setFilter(value);\n\n  const handleCanvasToggle = (step: -1 | 1) => {\n    const canvasEntity = mediaItems[activeIndex + step];\n    if (canvasEntity?.canvas) handleChange(canvasEntity.canvas.id);\n  };\n\n  return (\n    <>\n      <Controls\n        handleFilter={handleFilter}\n        handleCanvasToggle={handleCanvasToggle}\n        activeIndex={activeIndex}\n        canvasLength={mediaItems.length}\n      />\n      <Group aria-label=\"select item\" data-testid=\"media\" ref={scrollRef}>\n        {mediaItems\n          .filter((item) => {\n            if (item.canvas?.label) {\n              const label = getLabel(item.canvas.label);\n              if (Array.isArray(label))\n                return label[0].toLowerCase().includes(filter.toLowerCase());\n            }\n          })\n          .map((item, index) => (\n            <Thumbnail\n              canvas={item.canvas as CanvasNormalized}\n              canvasIndex={index}\n              handleChange={handleChange}\n              isActive={activeCanvas === item?.canvas?.id ? true : false}\n              key={item?.canvas?.id}\n              thumbnail={getThumbnail(vault, item, 200, 200)}\n              type={getResourceType(item.annotations[0])}\n            />\n          ))}\n      </Group>\n    </>\n  );\n};\n\nexport default Media;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst PlaceholderStyled = styled(\"button\", {\n  background: \"none\",\n  border: \"none\",\n  cursor: \"zoom-in\",\n  width: \"100%\",\n  height: \"100%\",\n  margin: \"0\",\n  padding: \"0\",\n  transition: \"$all\",\n\n  \"& img\": {\n    width: \"100%\",\n    height: \"100%\",\n    objectFit: \"contain\",\n    color: \"transparent\",\n    transition: \"$all\",\n  },\n\n  variants: {\n    isMedia: {\n      true: {\n        cursor: \"pointer\",\n      },\n    },\n  },\n});\n\nexport { PlaceholderStyled };\n","import { styled } from \"src/styles/stitches.config\";\n\nconst Item = styled(\"button\", {\n  display: \"flex\",\n  height: \"2rem\",\n  width: \"2rem\",\n  borderRadius: \"2rem\",\n  padding: \"0\",\n  margin: \"0\",\n  fontFamily: \"inherit\",\n  background: \"none\",\n  border: \"none\",\n  color: \"white\",\n  cursor: \"pointer\",\n  marginLeft: \"0.618rem\",\n  backgroundColor: \"$primary\",\n  filter: \"drop-shadow(2px 2px 5px #0003)\",\n  transition: \"$all\",\n  boxSizing: \"content-box !important\",\n\n  \"&:first-child\": {\n    marginLeft: \"0\",\n  },\n\n  \"@xs\": {\n    marginBottom: \"0.618rem\",\n    marginLeft: \"0\",\n\n    \"&:last-child\": {\n      marginBottom: \"0\",\n    },\n  },\n\n  svg: {\n    height: \"60%\",\n    width: \"60%\",\n    padding: \"20%\",\n    fill: \"$secondary\",\n    stroke: \"$secondary\",\n    filter: \"drop-shadow(2px 2px 5px #0003)\",\n    transition: \"$all\",\n    boxSizing: \"inherit\",\n  },\n\n  \"&:hover, &:focus\": {\n    backgroundColor: \"$accent\",\n  },\n\n  \"&#rotateRight\": {\n    \"&:hover, &:focus\": {\n      svg: {\n        rotate: \"45deg\",\n      },\n    },\n  },\n\n  \"&#rotateLeft\": {\n    transform: \"scaleX(-1)\",\n\n    \"&:hover, &:focus\": {\n      svg: {\n        rotate: \"45deg\",\n      },\n    },\n  },\n\n  \"&#reset\": {\n    \"&:hover, &:focus\": {\n      svg: {\n        rotate: \"-15deg\",\n      },\n    },\n  },\n});\n\nexport { Item };\n","import { styled } from \"src/styles/stitches.config\";\nimport { Item as ButtonStyled } from \"src/components/Viewer/ImageViewer/Button.styled\";\n\nconst ToggleStyled = styled(ButtonStyled, {\n  position: \"absolute\",\n  width: \"2rem\",\n  top: \"1rem\",\n  right: \"1rem\",\n  zIndex: 100,\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n  textAlign: \"center\",\n  transition: \"$all\",\n  borderRadius: \"50%\",\n  backgroundColor: \"$accent\",\n  cursor: \"pointer\",\n\n  \"&:hover, &:focus\": {\n    backgroundColor: \"$accent !important\",\n  },\n\n  variants: {\n    isInteractive: {\n      true: {\n        \"&:hover\": {\n          opacity: \"1\",\n        },\n      },\n      false: {},\n    },\n    isMedia: {\n      true: {\n        cursor: \"pointer !important\",\n      },\n    },\n  },\n\n  compoundVariants: [\n    {\n      isInteractive: false,\n      isMedia: true,\n      css: {\n        top: \"50%\",\n        right: \"50%\",\n        width: \"4rem\",\n        height: \"4rem\",\n        transform: \"translate(50%,-50%)\",\n      },\n    },\n  ],\n});\n\nexport { ToggleStyled };\n","import { PlaceholderStyled } from \"./Placeholder.styled\";\nimport { ToggleStyled } from \"src/components/Viewer/Painting/Toggle.styled\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst PaintingStyled = styled(\"div\", {\n  position: \"relative\",\n  zIndex: \"0\",\n  display: \"flex\",\n  flexDirection: \"column\",\n  gap: \"1rem\",\n\n  \"&:hover\": {\n    [`${ToggleStyled}`]: {\n      backgroundColor: \"$accent\",\n    },\n\n    [`${PlaceholderStyled}`]: {\n      backgroundColor: \"#6662\",\n\n      img: {\n        filter: \"brightness(0.85)\",\n      },\n    },\n  },\n});\n\nconst PaintingCanvas = styled(\"div\", {});\n\nexport { PaintingCanvas, PaintingStyled, ToggleStyled };\n","import * as Select from \"@radix-ui/react-select\";\n\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledSelectIcon = styled(\"svg\", {\n  height: \"19px\",\n  color: \"$accent\",\n  fill: \"$accent\",\n  stroke: \"$accent\",\n  display: \"flex\",\n  margin: \"0.25rem 0.85rem\",\n});\n\nconst StyledSelectButton = styled(Select.Trigger, {\n  fontSize: \"1.25rem\",\n  fontWeight: \"400\",\n  fontFamily: \"inherit\",\n  alignSelf: \"flex-start\",\n  flexGrow: \"1\",\n  cursor: \"pointer\",\n  transition: \"$all\",\n  border: \"1px solid #6663\",\n  boxShadow: \"2px 2px 5px #0001\",\n  borderRadius: \"3px\",\n  display: \"flex\",\n  alignItems: \"center\",\n  paddingLeft: \"0.5rem\",\n  width: \"100%\",\n\n  \"@sm\": {\n    fontSize: \"1rem\",\n  },\n});\n\nconst StyledSelectContent = styled(Select.Content, {\n  borderRadius: \"3px\",\n  boxShadow: \"3px 3px 8px #0003\",\n  backgroundColor: \"$secondary\",\n  marginTop: \"2.25rem\",\n  marginLeft: \"6px\",\n  paddingBottom: \"0.25rem\",\n  maxHeight: \"calc(61.8vh - 2.5rem) !important\",\n  borderTopLeftRadius: \"0\",\n  border: \"1px solid $secondaryMuted\",\n  maxWidth: \"90vw\",\n});\n\nconst StyledSelectItem = styled(Select.Item, {\n  display: \"flex\",\n  alignItems: \"center\",\n  fontFamily: \"inherit\",\n  padding: \"0.25rem 0.5rem\",\n  color: \"$primary\",\n  fontWeight: \"400\",\n  fontSize: \"0.8333rem\",\n  cursor: \"pointer\",\n  backgroundColor: \"$secondary\",\n  width: \"calc(100% - 1rem)\",\n\n  \"> span\": {\n    whiteSpace: \"nowrap\",\n    textOverflow: \"ellipsis\",\n    overflow: \"hidden\",\n  },\n\n  '&[data-state=\"checked\"]': {\n    fontWeight: \"700\",\n    color: \"$primary !important\",\n  },\n\n  \"&:hover\": {\n    color: \"$accent\",\n  },\n\n  img: {\n    width: \"31px\",\n    height: \"31px\",\n    marginRight: \"0.5rem\",\n    borderRadius: \"3px\",\n  },\n});\n\nconst StyledSelectLabel = styled(Select.Label, {\n  color: \"$primaryMuted\",\n  fontFamily: \"inherit\",\n  fontSize: \"0.85rem\",\n  padding: \"0.5rem 1rem 0.5rem 0.5rem\",\n  display: \"flex\",\n  alignItems: \"center\",\n  marginBottom: \"0.25rem\",\n  borderRadius: \"3px\",\n  borderTopLeftRadius: \"0\",\n  borderBottomLeftRadius: \"0\",\n  borderBottomRightRadius: \"0\",\n  backgroundColor: \"$secondaryMuted\",\n});\n\nconst StyledSelect = styled(Select.Root, {\n  position: \"relative\",\n  zIndex: \"5\",\n  width: \"100%\",\n});\n\nexport {\n  StyledSelectButton,\n  StyledSelectContent,\n  StyledSelectItem,\n  StyledSelectLabel,\n  StyledSelectIcon,\n  StyledSelect,\n};\n","import React from \"react\";\nimport { StyledSelectIcon } from \"./Select.styled\";\n\ninterface SelectIconProps {\n  direction: \"up\" | \"down\";\n  title: string;\n}\n\nconst SelectIcon: React.FC<SelectIconProps> = ({ direction, title }) => {\n  const CaretUp = () => {\n    return (\n      <path d=\"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z\" />\n    );\n  };\n\n  const CaretDown = () => {\n    return (\n      <path d=\"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z\" />\n    );\n  };\n\n  return (\n    <StyledSelectIcon\n      xmlns=\"http://www.w3.org/2000/svg\"\n      focusable=\"false\"\n      viewBox=\"0 0 512 512\"\n      role=\"img\"\n    >\n      <title>{title}</title>\n      {direction === \"up\" && <CaretUp />}\n      {direction === \"down\" && <CaretDown />}\n    </StyledSelectIcon>\n  );\n};\n\nexport default SelectIcon;\n","import {\n  SelectProps as RadixSelectProps,\n  SelectGroup,\n  SelectIcon,\n  SelectPortal,\n  SelectScrollDownButton,\n  SelectScrollUpButton,\n  SelectValue,\n  SelectViewport,\n} from \"@radix-ui/react-select\";\nimport React, { ReactNode } from \"react\";\nimport {\n  StyledSelect,\n  StyledSelectButton,\n  StyledSelectContent,\n  StyledSelectLabel,\n} from \"src/components/internal/Select/Select.styled\";\n\nimport Icon from \"./Icon\";\nimport { InternationalString } from \"@iiif/presentation-3\";\nimport { Label } from \"src/components/Primitives\";\n\ninterface SelectProps extends RadixSelectProps {\n  children?: ReactNode[] | ReactNode;\n  label?: InternationalString;\n  maxHeight: string;\n}\n\n/**\n * generic select component\n */\nconst Select: React.FC<SelectProps> = ({\n  children,\n  label,\n  maxHeight,\n  onValueChange,\n  value,\n}) => {\n  return (\n    <StyledSelect onValueChange={onValueChange} value={value}>\n      <StyledSelectButton data-testid=\"select-button\">\n        <SelectValue data-testid=\"select-button-value\" />\n        <SelectIcon>\n          <Icon direction=\"down\" title=\"select\" />\n        </SelectIcon>\n      </StyledSelectButton>\n      <SelectPortal>\n        <StyledSelectContent\n          css={{ maxHeight: `${maxHeight} !important` }}\n          data-testid=\"select-content\"\n        >\n          <SelectScrollUpButton>\n            <Icon direction=\"up\" title=\"scroll up for more\" />\n          </SelectScrollUpButton>\n          <SelectViewport>\n            <SelectGroup>\n              {label && (\n                <StyledSelectLabel>\n                  <Label data-testid=\"select-label\" label={label} />\n                </StyledSelectLabel>\n              )}\n              {children}\n            </SelectGroup>\n          </SelectViewport>\n          <SelectScrollDownButton>\n            <Icon direction=\"down\" title=\"scroll down for more\" />\n          </SelectScrollDownButton>\n        </StyledSelectContent>\n      </SelectPortal>\n    </StyledSelect>\n  );\n};\n\nexport default Select;\n","import {\n  IIIFExternalWebResource,\n  InternationalString,\n} from \"@iiif/presentation-3\";\nimport { Label, Thumbnail } from \"src/components/Primitives\";\nimport {\n  SelectItemIndicator,\n  SelectItemProps,\n  SelectItemText,\n} from \"@radix-ui/react-select\";\n\nimport React from \"react\";\nimport { StyledSelectItem } from \"./Select.styled\";\n\nexport interface SelectOptionProps extends SelectItemProps {\n  label: InternationalString;\n  thumbnail?: IIIFExternalWebResource[];\n}\n\nconst SelectOption = (props) => (\n  <StyledSelectItem {...props}>\n    {props.thumbnail && <Thumbnail thumbnail={props.thumbnail} />}\n    <SelectItemText>\n      <Label label={props.label} />\n    </SelectItemText>\n    <SelectItemIndicator />\n  </StyledSelectItem>\n);\n\nexport default SelectOption;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst Navigator = styled(\"div\", {\n  position: \"absolute !important\",\n  zIndex: \"1\",\n  top: \"1rem\",\n  left: \"1rem\",\n  width: \"161.8px\",\n  height: \"100px\",\n  backgroundColor: \"#000D\",\n  boxShadow: \"5px 5px 5px #0002\",\n  borderRadius: \"3px\",\n\n  \".displayregion\": {\n    border: \" 3px solid $accent !important\",\n    boxShadow: \"0 0 3px #0006\",\n  },\n\n  \"@sm\": {\n    width: \"123px\",\n    height: \"76px\",\n  },\n\n  \"@xs\": {\n    width: \"100px\",\n    height: \"61.8px\",\n  },\n});\n\nconst Viewport = styled(\"div\", {\n  position: \"relative\",\n  width: \"100%\",\n  height: \"100%\",\n  zIndex: \"0\",\n});\n\nconst Wrapper = styled(\"div\", {\n  width: \"100%\",\n  height: \"61.8vh\",\n  maxHeight: \"100vh\",\n  background: \"black\",\n  backgroundSize: \"contain\",\n  color: \"white\",\n  position: \"relative\",\n  zIndex: \"1\",\n  overflow: \"hidden\",\n});\n\nexport { Navigator, Viewport, Wrapper };\n","import React from \"react\";\nimport { Item } from \"src/components/Viewer/ImageViewer/Button.styled\";\n\ninterface ButtonProps {\n  id: string;\n  label: string;\n  children: React.ReactChild;\n}\n\nconst Button: React.FC<ButtonProps> = ({ id, label, children }) => {\n  return (\n    <Item id={id} data-testid=\"openseadragon-button\">\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-labelledby={`${id}-svg-title`}\n        data-testid=\"openseadragon-button-svg\"\n        focusable=\"false\"\n        viewBox=\"0 0 512 512\"\n        role=\"img\"\n      >\n        <title id={`${id}-svg-title`}>{label}</title>\n        {children}\n      </svg>\n    </Item>\n  );\n};\n\nexport default Button;\n","import { styled } from \"src/styles/stitches.config\";\n\nconst Wrapper = styled(\"div\", {\n  position: \"absolute\",\n  zIndex: \"1\",\n  top: \"1rem\",\n  display: \"flex\",\n\n  \"@xs\": {\n    flexDirection: \"column\",\n    zIndex: \"2\",\n  },\n\n  variants: {\n    hasPlaceholder: {\n      true: {\n        right: \"3.618rem\",\n\n        \"@xs\": {\n          top: \"3.618rem\",\n          right: \"1rem\",\n        },\n      },\n\n      false: {\n        right: \"1rem\",\n\n        \"@xs\": {\n          top: \"1rem\",\n          right: \"1rem\",\n        },\n      },\n    },\n  },\n});\n\nexport { Wrapper };\n","import Button from \"src/components/Viewer/ImageViewer/Button\";\nimport { Options } from \"openseadragon\";\nimport React from \"react\";\nimport { Wrapper } from \"src/components/Viewer/ImageViewer/Controls.styled\";\n\nconst ZoomIn = () => {\n  return (\n    <path\n      strokeLinecap=\"round\"\n      strokeMiterlimit=\"10\"\n      strokeWidth=\"45\"\n      d=\"M256 112v288M400 256H112\"\n    />\n  );\n};\n\nconst ZoomOut = () => {\n  return (\n    <path\n      strokeLinecap=\"round\"\n      strokeMiterlimit=\"10\"\n      strokeWidth=\"45\"\n      d=\"M400 256H112\"\n    />\n  );\n};\n\nconst ZoomFullScreen = () => {\n  return (\n    <path\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth=\"32\"\n      d=\"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304\"\n    />\n  );\n};\n\nconst Reset = () => {\n  return (\n    <path d=\"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z\" />\n  );\n};\n\nconst Rotate = () => {\n  return (\n    <>\n      <path\n        fill=\"none\"\n        strokeLinecap=\"round\"\n        strokeMiterlimit=\"10\"\n        strokeWidth=\"45\"\n        d=\"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128\"\n      />\n      <path d=\"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z\" />\n    </>\n  );\n};\n\nconst Controls = ({\n  hasPlaceholder,\n  options,\n}: {\n  hasPlaceholder: boolean;\n  options: Options;\n}) => {\n  return (\n    <Wrapper\n      data-testid=\"openseadragon-controls\"\n      hasPlaceholder={hasPlaceholder}\n      id=\"openseadragon-controls\"\n    >\n      {options.showZoomControl && (\n        <>\n          <Button id=\"zoomIn\" label=\"zoom in\">\n            <ZoomIn />\n          </Button>\n          <Button id=\"zoomOut\" label=\"zoom out\">\n            <ZoomOut />\n          </Button>\n        </>\n      )}\n      {options.showFullPageControl && (\n        <Button id=\"fullPage\" label=\"full page\">\n          <ZoomFullScreen />\n        </Button>\n      )}\n      {options.showRotationControl && (\n        <>\n          <Button id=\"rotateRight\" label=\"rotate right\">\n            <Rotate />\n          </Button>\n          <Button id=\"rotateLeft\" label=\"rotate left\">\n            <Rotate />\n          </Button>\n        </>\n      )}\n      {options.showHomeControl && (\n        <Button id=\"reset\" label=\"reset\">\n          <Reset />\n        </Button>\n      )}\n    </Wrapper>\n  );\n};\n\nexport default Controls;\n","import {\n  Canvas,\n  IIIFExternalWebResource,\n  ImageService,\n  Service,\n} from \"@iiif/presentation-3\";\n\nexport const getCanvasResource = (canvas: Canvas) => {\n  if (canvas?.items) {\n    const annotationPage = canvas?.items[0];\n    if (annotationPage?.items) {\n      const resource = annotationPage?.items[0].body as IIIFExternalWebResource;\n      if (resource?.hasOwnProperty(\"id\")) {\n        return resource.id as string;\n      }\n    }\n  }\n};\n\nexport const getInfoResponse = (id: string) =>\n  fetch(`${id.replace(/\\/$/, \"\")}/info.json`)\n    .then((response) => response.json())\n    .then((json) => json)\n    .catch((error: any) => {\n      console.error(\n        `The IIIF tilesource ${id.replace(\n          /\\/$/,\n          \"\",\n        )}/info.json failed to load: ${error}`,\n      );\n    });\n\nexport const getImageServiceURI = (service: Service[] | undefined) => {\n  let imageService: ImageService;\n  let imageServiceURI: string | undefined;\n\n  if (Array.isArray(service)) {\n    imageService = service[0] as ImageService;\n    if (imageService) {\n      let id: string | undefined;\n      \"@id\" in imageService\n        ? (id = imageService[\"@id\"])\n        : (id = imageService.id);\n\n      imageServiceURI = id;\n    }\n  }\n\n  return imageServiceURI;\n};\n","import {\n  Navigator,\n  Viewport,\n  Wrapper,\n} from \"src/components/Viewer/ImageViewer/ImageViewer.styled\";\nimport OpenSeadragon, { Options } from \"openseadragon\";\nimport React, { useEffect, useState } from \"react\";\nimport {\n  ViewerContextStore,\n  useViewerState,\n  useViewerDispatch,\n} from \"src/context/viewer-context\";\n\nimport Controls from \"src/components/Viewer/ImageViewer/Controls\";\nimport { getInfoResponse } from \"src/lib/iiif\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { addOverlaysToViewer } from \"src/lib/openseadragon-helpers\";\nimport {\n  AnnotationNormalized,\n  type CanvasNormalized,\n} from \"@iiif/presentation-3\";\nimport { AnnotationResources } from \"src/types/annotations\";\n\nexport type osdImageTypes = \"tiledImage\" | \"simpleImage\" | undefined;\n\ninterface OSDProps {\n  uri: string | undefined;\n  hasPlaceholder: boolean;\n  imageType: osdImageTypes;\n  annotationResources: AnnotationResources;\n}\n\nconst OSD: React.FC<OSDProps> = ({\n  uri,\n  hasPlaceholder,\n  imageType,\n  annotationResources,\n}) => {\n  const [osdUri, setOsdUri] = useState<string>();\n  const [osdInstance, setOsdInstance] = useState<string>();\n  const viewerState: ViewerContextStore = useViewerState();\n  const { configOptions, vault, activeCanvas } = viewerState;\n  const dispatch: any = useViewerDispatch();\n  const canvas: CanvasNormalized = vault.get({\n    id: activeCanvas,\n    type: \"Canvas\",\n  });\n\n  const config: Options = {\n    id: `openseadragon-viewport-${osdInstance}`,\n    loadTilesWithAjax: true,\n    fullPageButton: \"fullPage\",\n    homeButton: \"reset\",\n    rotateLeftButton: \"rotateLeft\",\n    rotateRightButton: \"rotateRight\",\n    zoomInButton: \"zoomIn\",\n    zoomOutButton: \"zoomOut\",\n    showNavigator: true,\n    showFullPageControl: true,\n    showHomeControl: true,\n    showRotationControl: true,\n    showZoomControl: true,\n    navigatorBorderColor: \"transparent\",\n    navigatorId: `openseadragon-navigator-${osdInstance}`,\n    gestureSettingsMouse: {\n      clickToZoom: true,\n      dblClickToZoom: true,\n      pinchToZoom: true,\n      scrollToZoom: true,\n    },\n    ...configOptions.openSeadragon,\n    ajaxWithCredentials: configOptions.withCredentials,\n  };\n\n  const annotations: Array<AnnotationNormalized> = [];\n\n  annotationResources[0]?.items?.forEach((item) => {\n    const annotationResource = vault.get(item.id);\n    annotations.push(annotationResource as unknown as AnnotationNormalized);\n  });\n\n  useEffect(() => {\n    if (uri !== osdUri) {\n      setOsdUri(uri);\n      setOsdInstance(uuidv4());\n    }\n  }, [osdUri, uri]);\n\n  useEffect(() => {\n    if (osdUri) {\n      switch (imageType) {\n        case \"simpleImage\":\n          const viewer = OpenSeadragon(config);\n          viewer.addSimpleImage({\n            url: osdUri,\n          });\n          dispatch({\n            type: \"updateOpenSeadragonViewer\",\n            openSeadragonViewer: viewer,\n          });\n          if (configOptions.annotationOverlays?.renderOverlays) {\n            addOverlaysToViewer(\n              viewer,\n              canvas,\n              configOptions,\n              annotations,\n              \"annotation-overlay\",\n            );\n          }\n          break;\n        case \"tiledImage\":\n          getInfoResponse(osdUri).then((tileSource) => {\n            const viewer = OpenSeadragon(config);\n            viewer.addTiledImage({\n              tileSource: tileSource,\n            });\n            dispatch({\n              type: \"updateOpenSeadragonViewer\",\n              openSeadragonViewer: viewer,\n            });\n            if (configOptions.annotationOverlays?.renderOverlays) {\n              addOverlaysToViewer(\n                viewer,\n                canvas,\n                configOptions,\n                annotations,\n                \"annotation-overlay\",\n              );\n            }\n          });\n          break;\n        default:\n          console.warn(\n            `Unable to render ${osdUri} in OpenSeadragon as type: \"${imageType}\"`,\n          );\n          break;\n      }\n    }\n  }, [osdUri]);\n\n  if (!osdInstance) return null;\n\n  return (\n    <Wrapper\n      css={{\n        backgroundColor: configOptions.canvasBackgroundColor,\n        height: configOptions.canvasHeight,\n      }}\n      className=\"clover-viewer-osd-wrapper\"\n      data-testid=\"clover-viewer-osd-wrapper\"\n    >\n      <Controls hasPlaceholder={hasPlaceholder} options={config} />\n      <Navigator id={`openseadragon-navigator-${osdInstance}`} />\n      <Viewport id={`openseadragon-viewport-${osdInstance}`} />\n    </Wrapper>\n  );\n};\n\nexport default OSD;\n","import OSD, { osdImageTypes } from \"src/components/Viewer/ImageViewer/OSD\";\nimport React, { useEffect, useState } from \"react\";\n\nimport { AnnotationResources } from \"src/types/annotations\";\nimport { LabeledIIIFExternalWebResource } from \"src/types/presentation-3\";\nimport { getImageServiceURI } from \"src/lib/iiif\";\n\ninterface ImageViewerProps {\n  painting: LabeledIIIFExternalWebResource;\n  hasPlaceholder: boolean;\n  annotationResources: AnnotationResources;\n}\n\nconst ImageViewer: React.FC<ImageViewerProps> = ({\n  painting,\n  hasPlaceholder,\n  annotationResources,\n}) => {\n  const [imageType, setImageType] = useState<osdImageTypes>();\n  const [uri, setUri] = useState<string | undefined>();\n\n  useEffect(() => {\n    if (Array.isArray(painting?.service) && painting?.service.length > 0) {\n      setImageType(\"tiledImage\");\n      setUri(getImageServiceURI(painting?.service));\n    } else {\n      setImageType(\"simpleImage\");\n      setUri(painting?.id);\n    }\n  }, [painting]);\n\n  return (\n    <OSD\n      uri={uri}\n      key={uri}\n      hasPlaceholder={hasPlaceholder}\n      imageType={imageType}\n      annotationResources={annotationResources}\n    />\n  );\n};\n\nexport default ImageViewer;\n","import { getLabel, getPaintingResource } from \"src/hooks/use-iiif\";\n\nimport { InternationalString } from \"@iiif/presentation-3\";\nimport { PlaceholderStyled } from \"./Placeholder.styled\";\nimport React from \"react\";\nimport { useViewerState } from \"src/context/viewer-context\";\n\ninterface Props {\n  isMedia: boolean;\n  label: InternationalString | null;\n  placeholderCanvas: string;\n  setIsInteractive: (arg0: boolean) => void;\n}\n\nconst PaintingPlaceholder: React.FC<Props> = ({\n  isMedia,\n  label,\n  placeholderCanvas,\n  setIsInteractive,\n}) => {\n  const { vault } = useViewerState();\n\n  const painting = getPaintingResource(vault, placeholderCanvas);\n\n  const placeholder = painting ? painting[0] : undefined;\n  const labelAsArray = label\n    ? (getLabel(label) as string[])\n    : [\"placeholder image\"];\n\n  return (\n    <PlaceholderStyled\n      onClick={() => setIsInteractive(true)}\n      isMedia={isMedia}\n      className=\"clover-viewer-placeholder\"\n    >\n      <img\n        src={placeholder?.id || \"\"}\n        alt={labelAsArray.join()}\n        height={placeholder?.height}\n        width={placeholder?.width}\n      />\n    </PlaceholderStyled>\n  );\n};\n\nexport default PaintingPlaceholder;\n","import { styled } from \"src/styles/stitches.config\";\n\nexport const AudioVisualizerWrapper = styled(\"canvas\", {\n  position: \"absolute\",\n  width: \"100%\",\n  height: \"100%\",\n  zIndex: \"0\",\n});\n","/* eslint-disable react/display-name */\n\nimport React, { useCallback } from \"react\";\n\nimport { AudioVisualizerWrapper } from \"src/components/Viewer/Player/AudioVisualizer.styled\";\n\nconst AudioVisualizer = React.forwardRef(\n  (_props, ref: React.RefObject<HTMLVideoElement>) => {\n    const canvasRef = React.useRef<HTMLCanvasElement>(null);\n\n    const audioVisualizer = useCallback(() => {\n      // Block re-initialization if audio is already playing\n      if (ref.current?.currentTime && ref.current?.currentTime > 0) return;\n\n      const video = ref.current;\n      if (!video) return;\n\n      const context = new AudioContext();\n      const src = context.createMediaElementSource(video);\n      const analyser = context.createAnalyser();\n\n      const canvas = canvasRef.current;\n      if (!canvas) return;\n      canvas.width = video.offsetWidth;\n      canvas.height = video.offsetHeight;\n      const ctx = canvas.getContext(\"2d\");\n\n      src.connect(analyser);\n      analyser.connect(context.destination);\n\n      analyser.fftSize = 256;\n\n      const bufferLength = analyser.frequencyBinCount;\n      const dataArray = new Uint8Array(bufferLength);\n\n      setInterval(function () {\n        renderFrame(\n          analyser,\n          ctx,\n          bufferLength,\n          dataArray,\n          canvas.width,\n          canvas.height,\n        );\n      }, 20);\n    }, [ref]);\n\n    React.useEffect(() => {\n      if (!ref || !ref.current) return;\n      // Add a callback fn to the `<video>` onplay event\n\n      ref.current.onplay = audioVisualizer;\n    }, [audioVisualizer, ref]);\n\n    function renderFrame(\n      analyser: any,\n      ctx: any,\n      bufferLength: number,\n      dataArray: Uint8Array,\n      width: number,\n      height: number,\n    ) {\n      const barWidth = (width / bufferLength) * 2.6;\n      let barHeight: number;\n      let x = 0;\n\n      analyser.getByteFrequencyData(dataArray);\n\n      ctx.fillStyle = \"#000000\";\n      ctx.fillRect(0, 0, width, height);\n\n      for (let i = 0; i < bufferLength; i++) {\n        barHeight = dataArray[i] * 2;\n        ctx.fillStyle = `rgba(${78}, 42, 132, 1)`;\n        ctx.fillRect(x, height - barHeight, barWidth, barHeight);\n\n        x += barWidth + 6;\n      }\n    }\n\n    return <AudioVisualizerWrapper ref={canvasRef} role=\"presentation\" />;\n  },\n);\n\nexport default AudioVisualizer;\n","import { styled } from \"src/styles/stitches.config\";\n\nexport const PlayerWrapper = styled(\"div\", {\n  position: \"relative\",\n  backgroundColor: \"$primaryAlt\",\n  display: \"flex\",\n  flexGrow: \"0\",\n  flexShrink: \"1\",\n  maxHeight: \"500px\",\n  zIndex: \"1\",\n\n  video: {\n    backgroundColor: \"transparent\",\n    objectFit: \"contain\",\n    width: \"100%\",\n    height: \"100%\",\n    position: \"relative\",\n    zIndex: \"1\",\n  },\n});\n","import { InternationalString } from \"@iiif/presentation-3\";\nimport { LabeledIIIFExternalWebResource } from \"src/types/presentation-3\";\nimport React from \"react\";\nimport { getLabel } from \"src/hooks/use-iiif\";\n\nexport interface TrackProps {\n  resource: LabeledIIIFExternalWebResource;\n  ignoreCaptionLabels: string[];\n}\n\nconst Track: React.FC<TrackProps> = ({ resource, ignoreCaptionLabels }) => {\n  const label = getLabel(resource.label as InternationalString, \"en\");\n\n  const isIgnored =\n    Array.isArray(label) &&\n    label.some((value: string) => ignoreCaptionLabels.includes(value));\n\n  if (isIgnored) return null;\n\n  return (\n    <track\n      key={resource.id}\n      src={resource.id as string}\n      label={Array.isArray(label) ? label[0] : label}\n      srcLang=\"en\"\n      data-testid=\"player-track\"\n    />\n  );\n};\n\nexport default Track;\n","import { AnnotationNormalized, CanvasNormalized } from \"@iiif/presentation-3\";\nimport Hls, { HlsConfig } from \"hls.js\";\nimport React, { useEffect } from \"react\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\n\nimport { AnnotationResources } from \"src/types/annotations\";\nimport AudioVisualizer from \"src/components/Viewer/Player/AudioVisualizer\";\nimport { LabeledIIIFExternalWebResource } from \"src/types/presentation-3\";\nimport { PlayerWrapper } from \"src/components/Viewer/Player/Player.styled\";\nimport Track from \"src/components/Viewer/Player/Track\";\nimport { getPaintingResource } from \"src/hooks/use-iiif\";\n\n// Set referrer header as a NU domain: ie. meadow.rdc-staging.library.northwestern.edu\n\ninterface PlayerProps {\n  allSources: LabeledIIIFExternalWebResource[];\n  annotationResources: AnnotationResources;\n  painting: LabeledIIIFExternalWebResource;\n}\n\nconst Player: React.FC<PlayerProps> = ({\n  allSources,\n  annotationResources,\n  painting,\n}) => {\n  const [currentTime, setCurrentTime] = React.useState<number>(0);\n  const [poster, setPoster] = React.useState<string | undefined>();\n  const playerRef = React.useRef<HTMLVideoElement>(null);\n  const isAudio = painting?.type === \"Sound\";\n\n  const viewerState: ViewerContextStore = useViewerState();\n  const { activeCanvas, configOptions, vault } = viewerState;\n\n  /**\n   * HLS.js binding for .m3u8 files\n   * STAGING and PRODUCTION environments only\n   */\n  useEffect(() => {\n    /**\n     * Check that IIIF content resource ID exists and\n     * we have a reffed <video> for attaching HLS\n     */\n    if (!painting.id || !playerRef.current) return;\n\n    if (playerRef?.current) {\n      const video: HTMLVideoElement = playerRef.current;\n      video.src = painting.id as string;\n      video.load();\n    }\n\n    /**\n     * Eject HLS attachment if file extension from\n     * the IIIF content resource ID is not .m3u8\n     */\n    if (painting.id.split(\".\").pop() !== \"m3u8\") return;\n\n    // Construct HLS.js config\n    const config = {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      xhrSetup: function (xhr, url) {\n        xhr.withCredentials = !!configOptions.withCredentials;\n      },\n    } as HlsConfig;\n\n    // Bind hls.js package to our <video /> element and then load the media source\n    const hls = new Hls(config);\n    hls.attachMedia(playerRef.current);\n    hls.on(Hls.Events.MEDIA_ATTACHED, function () {\n      hls.loadSource(painting.id as string);\n    });\n\n    // Handle errors\n    hls.on(Hls.Events.ERROR, function (event, data) {\n      if (data.fatal) {\n        switch (data.type) {\n          case Hls.ErrorTypes.NETWORK_ERROR:\n            // try to recover network error\n            console.error(\n              `fatal ${event} network error encountered, try to recover`,\n            );\n            hls.startLoad();\n            break;\n          case Hls.ErrorTypes.MEDIA_ERROR:\n            console.error(\n              `fatal ${event} media error encountered, try to recover`,\n            );\n            hls.recoverMediaError();\n            break;\n          default:\n            // cannot recover\n            hls.destroy();\n            break;\n        }\n      }\n    });\n\n    return () => {\n      if (hls && playerRef.current) {\n        const video: HTMLVideoElement = playerRef.current;\n        hls.detachMedia();\n        hls.destroy();\n        video.currentTime = 0;\n      }\n    };\n  }, [configOptions.withCredentials, painting.id]);\n\n  useEffect(() => {\n    const canvas: CanvasNormalized = vault.get(activeCanvas);\n    const accompanyingCanvas = canvas.accompanyingCanvas?.id\n      ? getPaintingResource(vault, canvas.accompanyingCanvas?.id)\n      : null;\n\n    const placeholderCanvas = canvas.placeholderCanvas?.id\n      ? getPaintingResource(vault, canvas.placeholderCanvas?.id)\n      : null;\n\n    const conflictingCanvas = !!(accompanyingCanvas && placeholderCanvas);\n\n    if (conflictingCanvas) {\n      currentTime === 0\n        ? setPoster(placeholderCanvas[0].id)\n        : setPoster(accompanyingCanvas[0].id);\n    } else {\n      if (accompanyingCanvas) setPoster(accompanyingCanvas[0].id);\n      if (placeholderCanvas) setPoster(placeholderCanvas[0].id);\n    }\n  }, [activeCanvas, currentTime, vault]);\n\n  useEffect(() => {\n    if (playerRef?.current) {\n      const video: HTMLVideoElement = playerRef.current;\n      video?.addEventListener(\"timeupdate\", () =>\n        setCurrentTime(video.currentTime),\n      );\n\n      return () => document.removeEventListener(\"timeupdate\", () => {});\n    }\n  }, []);\n\n  return (\n    <PlayerWrapper\n      css={{\n        backgroundColor: configOptions.canvasBackgroundColor,\n        maxHeight: configOptions.canvasHeight,\n        position: \"relative\",\n      }}\n      data-testid=\"player-wrapper\"\n      className=\"clover-viewer-player-wrapper\"\n    >\n      <video\n        id=\"clover-iiif-video\"\n        key={painting.id}\n        ref={playerRef}\n        controls\n        height={painting.height}\n        width={painting.width}\n        crossOrigin=\"anonymous\"\n        poster={poster}\n        style={{\n          maxHeight: configOptions.canvasHeight,\n          position: \"relative\",\n          zIndex: \"1\",\n        }}\n      >\n        {allSources.map((painting) => (\n          <source src={painting.id} type={painting.format} key={painting.id} />\n        ))}\n        {annotationResources?.length > 0 &&\n          annotationResources.map((annotationPage) => {\n            const annotationBodies: LabeledIIIFExternalWebResource[] = [];\n\n            annotationPage.items.forEach((annotation) => {\n              const annotationNormalized = vault.get(\n                annotation.id,\n              ) as AnnotationNormalized;\n\n              annotationNormalized.body.forEach((body) => {\n                const annotationBody = vault.get(\n                  body.id,\n                ) as LabeledIIIFExternalWebResource;\n                annotationBodies.push(annotationBody);\n              });\n            });\n\n            return annotationBodies.map((body) => {\n              return (\n                <Track\n                  resource={body}\n                  ignoreCaptionLabels={configOptions.ignoreCaptionLabels || []}\n                  key={body.id}\n                />\n              );\n            });\n          })}\n        Sorry, your browser doesn&apos;t support embedded videos.\n      </video>\n\n      {isAudio && <AudioVisualizer ref={playerRef} />}\n    </PlayerWrapper>\n  );\n};\n\nexport default Player;\n","import React from \"react\";\nimport { ToggleStyled } from \"./Painting.styled\";\n\ninterface ToggleProps {\n  handleToggle: () => void;\n  isInteractive: boolean;\n  isMedia: boolean;\n}\n\nconst CloseIcon = () => {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      aria-labelledby=\"close-svg-title\"\n      focusable=\"false\"\n      viewBox=\"0 0 512 512\"\n      role=\"img\"\n    >\n      <title id=\"close-svg-title\">close</title>\n      <path d=\"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z\" />\n    </svg>\n  );\n};\n\nconst OpenIcon = ({ isMedia }: { isMedia: boolean }) => {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      aria-labelledby=\"open-svg-title\"\n      focusable=\"false\"\n      viewBox=\"0 0 512 512\"\n      role=\"img\"\n    >\n      <title id=\"open-svg-title\">open</title>\n\n      {isMedia ? (\n        <path d=\"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z\" />\n      ) : (\n        <>\n          <path d=\"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z\" />\n          <path d=\"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z\" />\n        </>\n      )}\n    </svg>\n  );\n};\n\nconst Toggle: React.FC<ToggleProps> = ({\n  handleToggle,\n  isInteractive,\n  isMedia,\n}) => {\n  return (\n    <ToggleStyled\n      onClick={handleToggle}\n      isInteractive={isInteractive}\n      isMedia={isMedia}\n      data-testid=\"placeholder-toggle\"\n    >\n      {isInteractive ? <CloseIcon /> : <OpenIcon isMedia={isMedia} />}\n    </ToggleStyled>\n  );\n};\n\nexport default Toggle;\n","import { PaintingCanvas, PaintingStyled } from \"./Painting.styled\";\nimport { Select, SelectOption } from \"src/components/internal/Select\";\n\nimport { AnnotationResources } from \"src/types/annotations\";\nimport { CanvasNormalized } from \"@iiif/presentation-3\";\nimport ImageViewer from \"src/components/Viewer/ImageViewer/ImageViewer\";\nimport { LabeledIIIFExternalWebResource } from \"src/types/presentation-3\";\nimport PaintingPlaceholder from \"./Placeholder\";\nimport Player from \"src/components/Viewer/Player/Player\";\nimport React from \"react\";\nimport Toggle from \"./Toggle\";\nimport { useViewerState } from \"src/context/viewer-context\";\n\ninterface PaintingProps {\n  activeCanvas: string;\n  annotationResources: AnnotationResources;\n  isMedia: boolean;\n  painting: LabeledIIIFExternalWebResource[];\n}\n\nconst Painting: React.FC<PaintingProps> = ({\n  activeCanvas,\n  annotationResources,\n  isMedia,\n  painting,\n}) => {\n  const [annotationIndex, setAnnotationIndex] = React.useState<number>(0);\n  const [isInteractive, setIsInteractive] = React.useState(false);\n  const { configOptions, customDisplays, vault } = useViewerState();\n\n  const normalizedCanvas: CanvasNormalized = vault.get(activeCanvas);\n\n  const placeholderCanvas = normalizedCanvas?.placeholderCanvas?.id;\n  const hasPlaceholder = Boolean(placeholderCanvas);\n  const hasChoice = Boolean(painting?.length > 1);\n  const showPlaceholder = placeholderCanvas && !isInteractive && !isMedia;\n\n  const handleToggle = () => setIsInteractive(!isInteractive);\n\n  const handleChoiceChange = (value) => {\n    const index = painting.findIndex((resource) => resource.id === value);\n    setAnnotationIndex(index);\n  };\n\n  /**\n   * Determine whether a custom display should be used for the current canvas.\n   */\n  const customDisplay = customDisplays.find((customDisplay) => {\n    let match = false;\n    const { canvasId, paintingFormat } = customDisplay.target;\n\n    if (Array.isArray(canvasId) && canvasId.length > 0) {\n      match = canvasId.includes(activeCanvas);\n    }\n\n    if (Array.isArray(paintingFormat) && paintingFormat.length > 0) {\n      const format = painting[annotationIndex]?.format || \"\";\n      match = Boolean(format && paintingFormat.includes(format));\n    }\n    return match;\n  });\n\n  const CustomComponent = customDisplay?.display\n    ?.component as unknown as React.ElementType;\n\n  return (\n    <PaintingStyled className=\"clover-viewer-painting\">\n      <PaintingCanvas\n        style={{\n          backgroundColor: configOptions.canvasBackgroundColor,\n          maxHeight: configOptions.canvasHeight,\n        }}\n      >\n        {placeholderCanvas && !isMedia && (\n          <Toggle\n            handleToggle={handleToggle}\n            isInteractive={isInteractive}\n            isMedia={isMedia}\n          />\n        )}\n        {showPlaceholder && !isMedia && (\n          <PaintingPlaceholder\n            isMedia={isMedia}\n            label={normalizedCanvas?.label}\n            placeholderCanvas={placeholderCanvas}\n            setIsInteractive={setIsInteractive}\n          />\n        )}\n\n        {/* Standard Viewer displays */}\n        {!showPlaceholder &&\n          !customDisplay &&\n          (isMedia ? (\n            <Player\n              allSources={painting}\n              painting={painting[annotationIndex]}\n              annotationResources={annotationResources}\n            />\n          ) : (\n            painting && (\n              <ImageViewer\n                painting={painting[annotationIndex]}\n                hasPlaceholder={hasPlaceholder}\n                key={activeCanvas}\n                annotationResources={annotationResources}\n              />\n            )\n          ))}\n\n        {/* Custom display */}\n        {!showPlaceholder && CustomComponent && (\n          <CustomComponent\n            id={activeCanvas}\n            annotationBody={painting[annotationIndex]}\n            {...customDisplay?.display.componentProps}\n          />\n        )}\n      </PaintingCanvas>\n\n      {hasChoice && (\n        <Select\n          value={painting[annotationIndex]?.id}\n          onValueChange={handleChoiceChange}\n          maxHeight={\"200px\"}\n        >\n          {painting?.map((resource) => (\n            <SelectOption\n              value={resource?.id}\n              key={resource?.id}\n              label={resource?.label}\n            />\n          ))}\n        </Select>\n      )}\n    </PaintingStyled>\n  );\n};\n\nexport default Painting;\n","import {\n  Aside,\n  CollapsibleContent,\n  CollapsibleTrigger,\n  Content,\n  Main,\n  MediaWrapper,\n} from \"src/components/Viewer/Viewer/Viewer.styled\";\nimport {\n  Canvas,\n  IIIFExternalWebResource,\n  AnnotationPageNormalized,\n} from \"@iiif/presentation-3\";\n\nimport { AnnotationResources, AnnotationResource } from \"src/types/annotations\";\nimport InformationPanel from \"src/components/Viewer/InformationPanel/InformationPanel\";\nimport Media from \"src/components/Viewer/Media/Media\";\nimport Painting from \"../Painting/Painting\";\nimport React from \"react\";\nimport { useViewerState } from \"src/context/viewer-context\";\n\ninterface ViewerContentProps {\n  activeCanvas: string;\n  annotationResources: AnnotationResources;\n  searchServiceUrl?: string;\n  setContentSearchResource: React.Dispatch<\n    React.SetStateAction<AnnotationPageNormalized | undefined>\n  >;\n  contentSearchResource?: AnnotationResource;\n  painting: IIIFExternalWebResource[];\n  items: Canvas[];\n  isAudioVideo: boolean;\n}\n\nconst ViewerContent: React.FC<ViewerContentProps> = ({\n  activeCanvas,\n  annotationResources,\n  searchServiceUrl,\n  setContentSearchResource,\n  contentSearchResource,\n  isAudioVideo,\n  items,\n  painting,\n}) => {\n  const { informationOpen, configOptions } = useViewerState();\n  const { informationPanel } = configOptions;\n\n  /**\n   * The information panel should be rendered if toggled true and if\n   * there is content (About or Supplementing Resources) to display.\n   */\n\n  const isAside =\n    informationPanel?.renderAbout ||\n    (informationPanel?.renderAnnotation && annotationResources.length > 0) ||\n    contentSearchResource;\n\n  return (\n    <Content\n      className=\"clover-viewer-content\"\n      data-testid=\"clover-viewer-content\"\n    >\n      <Main>\n        <Painting\n          activeCanvas={activeCanvas}\n          annotationResources={annotationResources}\n          isMedia={isAudioVideo}\n          painting={painting}\n        />\n\n        {isAside && (\n          <CollapsibleTrigger>\n            <span>{informationOpen ? \"View Items\" : \"More Information\"}</span>\n          </CollapsibleTrigger>\n        )}\n\n        {items.length > 1 && (\n          <MediaWrapper className=\"clover-viewer-media-wrapper\">\n            <Media items={items} activeItem={0} />\n          </MediaWrapper>\n        )}\n      </Main>\n      {informationOpen && isAside && (\n        <Aside>\n          <CollapsibleContent>\n            <InformationPanel\n              activeCanvas={activeCanvas}\n              annotationResources={annotationResources}\n              searchServiceUrl={searchServiceUrl}\n              setContentSearchResource={setContentSearchResource}\n              contentSearchResource={contentSearchResource}\n            />\n          </CollapsibleContent>\n        </Aside>\n      )}\n    </Content>\n  );\n};\n\nexport default ViewerContent;\n","import { Popover } from \"src/components/internal\";\nimport { StyledSelect } from \"src/components/internal/Select/Select.styled\";\nimport { styled } from \"src/styles/stitches.config\";\n\nconst IIIFBadgeButton = styled(Popover.Trigger, {\n  width: \"30px\",\n  padding: \"5px\",\n});\n\nconst IIIFBadgeContent = styled(Popover.Content, {\n  display: \"flex\",\n  flexDirection: \"column\",\n  fontSize: \"0.8333rem\",\n  border: \"none\",\n  boxShadow: \"2px 2px 5px #0003\",\n  zIndex: \"2\",\n\n  button: {\n    display: \"flex\",\n    textDecoration: \"none\",\n    marginBottom: \"0.5em\",\n    color: \"$accentAlt\",\n    cursor: \"pointer\",\n    background: \"$secondary\",\n    border: \"none\",\n\n    [\"&:last-child\"]: {\n      marginBottom: \"0\",\n    },\n  },\n});\n\nconst ManifestLabel = styled(\"span\", {\n  fontSize: \"1.33rem\",\n  alignSelf: \"flex-start\",\n  flexGrow: \"0\",\n  flexShrink: \"1\",\n  padding: \"1rem\",\n\n  \"@sm\": {\n    fontSize: \"1rem\",\n  },\n\n  \"&.visually-hidden\": {\n    position: \"absolute\",\n    width: \"1px\",\n    height: \"1px\",\n    padding: \"0\",\n    margin: \"-1px\",\n    overflow: \"hidden\",\n    clip: \"rect(0, 0, 0, 0)\",\n    whiteSpace: \"nowrap\",\n    border: \"0\",\n  },\n});\n\nconst Header = styled(\"header\", {\n  display: \"flex\",\n  backgroundColor: \"transparent !important\",\n  justifyContent: \"space-between\",\n  alignItems: \"flex-start\",\n  width: \"100%\",\n\n  [`> ${StyledSelect}`]: {\n    flexGrow: \"1\",\n    flexShrink: \"0\",\n  },\n\n  form: {\n    flexGrow: \"0\",\n    flexShrink: \"1\",\n  },\n});\n\nconst HeaderOptions = styled(\"div\", {\n  display: \"flex\",\n  alignItems: \"flex-end\",\n  justifyContent: \"flex-end\",\n  padding: \"1rem\",\n  flexShrink: \"0\",\n  flexGrow: \"1\",\n});\n\nexport {\n  Header,\n  HeaderOptions,\n  IIIFBadgeButton,\n  IIIFBadgeContent,\n  ManifestLabel,\n};\n","import { Select, SelectOption } from \"src/components/internal/Select\";\nimport { useViewerDispatch, useViewerState } from \"src/context/viewer-context\";\n\nimport { CollectionItems } from \"@iiif/presentation-3\";\nimport React from \"react\";\n\nconst Collection: React.FC = () => {\n  const dispatch: any = useViewerDispatch();\n  const viewerState: any = useViewerState();\n\n  const { activeManifest, collection, configOptions, vault } = viewerState;\n  const maxHeight = configOptions?.canvasHeight;\n\n  const handleValueChange = (manifestId: string) => {\n    dispatch({\n      type: \"updateActiveManifest\",\n      manifestId: manifestId,\n    });\n  };\n\n  return (\n    <div style={{ margin: \"0.75rem\" }}>\n      <Select\n        label={collection.label}\n        maxHeight={maxHeight}\n        value={activeManifest}\n        onValueChange={handleValueChange}\n      >\n        {collection?.items?.map((item: CollectionItems) => (\n          <SelectOption\n            value={item.id}\n            key={item.id}\n            thumbnail={item?.thumbnail ? vault.get(item?.thumbnail) : undefined}\n            label={item.label}\n          />\n        ))}\n      </Select>\n    </div>\n  );\n};\n\nexport default Collection;\n","import { useCallback, useEffect, useState } from \"react\";\n\nexport type CopyStatus = undefined | \"copied\" | \"failed\";\n\nexport const useCopyToClipboard = (\n  text: string,\n  notifyTimeout = 2500,\n): [CopyStatus, () => void] => {\n  const [copyStatus, setCopyStatus] = useState<CopyStatus>();\n  const copy = useCallback(() => {\n    navigator.clipboard.writeText(text).then(\n      () => setCopyStatus(\"copied\"),\n      () => setCopyStatus(\"failed\"),\n    );\n  }, [text]);\n\n  useEffect(() => {\n    if (!copyStatus) {\n      return;\n    }\n\n    const timeoutId = setTimeout(() => setCopyStatus(undefined), notifyTimeout);\n\n    return () => clearTimeout(timeoutId);\n  }, [copyStatus]);\n\n  return [copyStatus, copy];\n};\n","import React from \"react\";\nimport { styled } from \"src/styles/stitches.config\";\nimport { useCopyToClipboard, CopyStatus } from \"src/hooks/useCopyToClipboard\";\n\nconst Status = styled(\"span\", {\n  display: \"flex\",\n  alignContent: \"center\",\n  alignItems: \"center\",\n  padding: \"0.125rem 0.25rem 0\",\n  marginTop: \"-0.125rem\",\n  marginLeft: \"0.5rem\",\n  backgroundColor: \"$accent\",\n  color: \"$secondary\",\n  borderRadius: \"3px\",\n  fontSize: \"0.6111rem\",\n  textTransform: \"uppercase\",\n  lineHeight: \"1em\",\n});\n\nconst CopyTextStatus: React.FC<{ status: CopyStatus }> = ({ status }) => {\n  if (!status) return null;\n\n  return <Status data-copy-status={status}>{status}</Status>;\n};\n\nexport const CopyText: React.FC<{ textPrompt: string; textToCopy: string }> = ({\n  textPrompt,\n  textToCopy,\n}) => {\n  const [copyStatus, copyText] = useCopyToClipboard(textToCopy);\n  return (\n    <button onClick={copyText}>\n      {textPrompt} <CopyTextStatus status={copyStatus} />\n    </button>\n  );\n};\n\nexport default CopyText;\n","import React from \"react\";\n\nconst IIIFBadge: React.FC = () => {\n  const red = \"#ed1d33\";\n  const blue = \"#2873ab\";\n\n  return (\n    <svg viewBox=\"0 0 493.35999 441.33334\" id=\"iiif-logo\" version=\"1.1\">\n      <title>IIIF Manifest Options</title>\n      <g transform=\"matrix(1.3333333,0,0,-1.3333333,0,441.33333)\">\n        <g transform=\"scale(0.1)\">\n          <path\n            style={{ fill: blue }}\n            d=\"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5\"\n          />\n          <path\n            style={{ fill: blue }}\n            d=\"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18\"\n          />\n          <path\n            style={{ fill: red }}\n            d=\"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5\"\n          />\n          <path\n            style={{ fill: red }}\n            d=\"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18\"\n          />\n          <path\n            style={{ fill: blue }}\n            d=\"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5\"\n          />\n          <path\n            style={{ fill: blue }}\n            d=\"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18\"\n          />\n          <path\n            style={{ fill: red }}\n            d=\"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950\"\n          />\n        </g>\n      </g>\n    </svg>\n  );\n};\n\nexport default IIIFBadge;\n","import * as Switch from \"@radix-ui/react-switch\";\n\nimport { styled } from \"src/styles/stitches.config\";\n\nconst StyledSwitch = styled(Switch.Root, {\n  all: \"unset\",\n  height: \"2rem\",\n  width: \"3.236rem\",\n  backgroundColor: \"#6663\",\n  borderRadius: \"9999px\",\n  position: \"relative\",\n  WebkitTapHighlightColor: \"transparent\",\n  cursor: \"pointer\",\n\n  \"&:focus\": {\n    boxShadow: `0 0 0 2px $secondaryAlt`,\n  },\n\n  '&[data-state=\"checked\"]': {\n    backgroundColor: \"$accent\",\n    boxShadow: `inset 2px 2px 5px #0003`,\n  },\n});\n\nconst StyledThumb = styled(Switch.Thumb, {\n  display: \"block\",\n  height: \"calc(2rem - 12px)\",\n  width: \"calc(2rem - 12px)\",\n  backgroundColor: \"$secondary\",\n  borderRadius: \"100%\",\n  boxShadow: `2px 2px 5px #0001`,\n  transition: \"$all\",\n  transform: \"translateX(6px)\",\n  willChange: \"transform\",\n\n  '&[data-state=\"checked\"]': {\n    transform: \"translateX(calc(1.236rem + 6px))\",\n  },\n});\n\nconst Label = styled(\"label\", {\n  fontSize: \"0.8333rem\",\n  fontWeight: \"400\",\n  lineHeight: \"1em\",\n  userSelect: \"none\",\n  cursor: \"pointer\",\n  paddingRight: \"0.618rem\",\n});\n\nconst StyledToggle = styled(\"form\", {\n  display: \"flex\",\n  flexShrink: \"0\",\n  flexGrow: \"1\",\n  alignItems: \"center\",\n  marginLeft: \"1.618rem\",\n});\n\nexport { Label, StyledSwitch, StyledThumb, StyledToggle };\n","import {\n  Label,\n  StyledSwitch,\n  StyledThumb,\n  StyledToggle,\n} from \"src/components/Viewer/Viewer/Toggle.styled\";\nimport React, { useEffect, useState } from \"react\";\nimport { useViewerDispatch, useViewerState } from \"src/context/viewer-context\";\n\nconst Toggle = () => {\n  const { configOptions } = useViewerState();\n  const dispatch: any = useViewerDispatch();\n\n  const [checked, setChecked] = useState(configOptions?.informationPanel?.open);\n\n  useEffect(() => {\n    dispatch({\n      type: \"updateInformationOpen\",\n      informationOpen: checked,\n    });\n  }, [checked]);\n\n  return (\n    <StyledToggle>\n      <Label htmlFor=\"information-toggle\" css={checked ? { opacity: \"1\" } : {}}>\n        More Information\n      </Label>\n      <StyledSwitch\n        checked={checked}\n        onCheckedChange={() => setChecked(!checked)}\n        id=\"information-toggle\"\n        aria-label=\"information panel toggle\"\n        name=\"toggled?\"\n      >\n        <StyledThumb />\n      </StyledSwitch>\n    </StyledToggle>\n  );\n};\n\nexport default Toggle;\n","import { useEffect, useState } from \"react\";\n\nexport const useMediaQuery = (mediaQuery: string) => {\n  const match = () => {\n    if (!window.matchMedia) {\n      return false;\n    }\n    return window.matchMedia(mediaQuery).matches;\n  };\n\n  const [isMatch, setIsMatch] = useState<boolean>(match);\n\n  useEffect(() => {\n    const handler = () => setIsMatch(match);\n    window.addEventListener(\"resize\", handler);\n    return () => window.removeEventListener(\"resize\", handler);\n  });\n\n  return isMatch;\n};\n","import {\n  Header,\n  HeaderOptions,\n  IIIFBadgeButton,\n  IIIFBadgeContent,\n  ManifestLabel,\n} from \"./Header.styled\";\nimport { ViewerContextStore, useViewerState } from \"src/context/viewer-context\";\n\nimport Collection from \"src/components/Viewer/Collection/Collection\";\nimport CopyText from \"src/components/Viewer/CopyText\";\nimport IIIFBadge from \"src/components/Viewer/Viewer/IIIFBadge\";\nimport { InternationalString } from \"@iiif/presentation-3\";\nimport { Label } from \"src/components/Primitives\";\nimport { Popover } from \"src/components/internal\";\nimport React from \"react\";\nimport Toggle from \"./Toggle\";\nimport { media } from \"src/styles/stitches.config\";\nimport { useMediaQuery } from \"src/hooks/useMediaQuery\";\n\ninterface Props {\n  manifestId: string;\n  manifestLabel: InternationalString;\n}\n\nconst ViewerHeader: React.FC<Props> = ({ manifestId, manifestLabel }) => {\n  const viewerState: ViewerContextStore = useViewerState();\n  const { collection, configOptions } = viewerState;\n\n  const { showTitle, showIIIFBadge, informationPanel } = configOptions;\n\n  /**\n   * Determine if header options should be rendered.\n   */\n  const hasOptions = showIIIFBadge || informationPanel?.renderToggle;\n  const isSmallViewport = useMediaQuery(media.sm);\n\n  return (\n    <Header className=\"clover-viewer-header\">\n      {collection?.items ? (\n        <Collection />\n      ) : (\n        <ManifestLabel className={!showTitle ? \"visually-hidden\" : \"\"}>\n          {showTitle && <Label label={manifestLabel} className=\"label\" />}\n        </ManifestLabel>\n      )}\n      {hasOptions && (\n        <HeaderOptions>\n          {showIIIFBadge && (\n            <Popover>\n              <IIIFBadgeButton>\n                <IIIFBadge />\n              </IIIFBadgeButton>\n              <IIIFBadgeContent>\n                {collection?.items && (\n                  <button\n                    onClick={(e) => {\n                      e.preventDefault();\n                      window.open(collection.id, \"_blank\");\n                    }}\n                  >\n                    View Collection\n                  </button>\n                )}\n                <button\n                  onClick={(e) => {\n                    e.preventDefault();\n                    window.open(manifestId, \"_blank\");\n                  }}\n                >\n                  View Manifest\n                </button>{\" \"}\n                {collection?.items && (\n                  <CopyText\n                    textPrompt=\"Copy Collection URL\"\n                    textToCopy={collection.id}\n                  />\n                )}\n                <CopyText\n                  textPrompt=\"Copy Manifest URL\"\n                  textToCopy={manifestId}\n                />\n              </IIIFBadgeContent>\n            </Popover>\n          )}\n          {informationPanel?.renderToggle && !isSmallViewport && <Toggle />}\n        </HeaderOptions>\n      )}\n    </Header>\n  );\n};\n\nexport default ViewerHeader;\n","import { useEffect, useLayoutEffect, useState } from \"react\";\n\ntype ReturnType = [boolean, (locked: boolean) => void];\n\nexport const useBodyLocked = (initialLocked = false): ReturnType => {\n  const [locked, setLocked] = useState(initialLocked);\n\n  useLayoutEffect(() => {\n    if (!locked) {\n      return;\n    }\n\n    const originalOverflow = document.documentElement.style.overflow;\n\n    document.documentElement.style.overflow = \"hidden\";\n\n    return () => {\n      document.documentElement.style.overflow = originalOverflow;\n    };\n  }, [locked]);\n\n  useEffect(() => {\n    if (locked !== initialLocked) {\n      setLocked(initialLocked);\n    }\n  }, [initialLocked]);\n\n  return [locked, setLocked];\n};\n","import * as Collapsible from \"@radix-ui/react-collapsible\";\n\nimport {\n  ExternalResourceTypes,\n  InternationalString,\n  ManifestNormalized,\n  CanvasNormalized,\n  AnnotationNormalized,\n  AnnotationPageNormalized,\n} from \"@iiif/presentation-3\";\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport {\n  ViewerContextStore,\n  useViewerDispatch,\n  useViewerState,\n} from \"src/context/viewer-context\";\nimport {\n  getAnnotationResources,\n  getPaintingResource,\n  getContentSearchResources,\n} from \"src/hooks/use-iiif\";\nimport {\n  addOverlaysToViewer,\n  removeOverlaysFromViewer,\n} from \"src/lib/openseadragon-helpers\";\n\nimport { AnnotationResources, AnnotationResource } from \"src/types/annotations\";\nimport { ErrorBoundary } from \"react-error-boundary\";\nimport ErrorFallback from \"src/components/Viewer/Viewer/ErrorFallback\";\nimport { IIIFExternalWebResource } from \"@iiif/presentation-3\";\nimport ViewerContent from \"src/components/Viewer/Viewer/Content\";\nimport ViewerHeader from \"src/components/Viewer/Viewer/Header\";\nimport { Wrapper } from \"src/components/Viewer/Viewer/Viewer.styled\";\nimport { media } from \"src/styles/stitches.config\";\nimport { useBodyLocked } from \"src/hooks/useBodyLocked\";\nimport { useMediaQuery } from \"src/hooks/useMediaQuery\";\n\ninterface ViewerProps {\n  manifest: ManifestNormalized;\n  theme?: unknown;\n  iiifContentSearch?: string;\n}\n\nconst Viewer: React.FC<ViewerProps> = ({\n  manifest,\n  theme,\n  iiifContentSearch,\n}) => {\n  /**\n   * Viewer State\n   */\n  const viewerState: ViewerContextStore = useViewerState();\n  const viewerDispatch: any = useViewerDispatch();\n  const {\n    activeCanvas,\n    informationOpen,\n    vault,\n    contentSearchVault,\n    configOptions,\n    openSeadragonViewer,\n  } = viewerState;\n\n  /**\n   * Local state\n   */\n\n  const [isInformationPanel, setIsInformationPanel] = useState<boolean>(false);\n  const [isAudioVideo, setIsAudioVideo] = useState(false);\n  const [painting, setPainting] = useState<IIIFExternalWebResource[]>([]);\n  const [annotationResources, setAnnotationResources] =\n    useState<AnnotationResources>([]);\n  const [contentSearchResource, setContentSearchResource] =\n    useState<AnnotationResource>();\n\n  const [isBodyLocked, setIsBodyLocked] = useBodyLocked(false);\n  const isSmallViewport = useMediaQuery(media.sm);\n  const [searchServiceUrl, setSearchServiceUrl] = useState();\n\n  const setInformationOpen = useCallback(\n    (open: boolean) => {\n      viewerDispatch({\n        type: \"updateInformationOpen\",\n        informationOpen: open,\n      });\n    },\n    [viewerDispatch],\n  );\n\n  useEffect(() => {\n    if (configOptions?.informationPanel?.open) {\n      setInformationOpen(!isSmallViewport);\n    }\n  }, [\n    isSmallViewport,\n    configOptions?.informationPanel?.open,\n    setInformationOpen,\n  ]);\n\n  useEffect(() => {\n    if (!isSmallViewport) {\n      setIsBodyLocked(false);\n      return;\n    }\n    setIsBodyLocked(informationOpen);\n  }, [informationOpen, isSmallViewport, setIsBodyLocked]);\n\n  useEffect(() => {\n    const painting = getPaintingResource(vault, activeCanvas);\n\n    if (painting) {\n      setIsAudioVideo(\n        [\"Sound\", \"Video\"].indexOf(painting[0].type as ExternalResourceTypes) >\n          -1\n          ? true\n          : false,\n      );\n      setPainting(painting);\n    }\n\n    setAnnotationResources(getAnnotationResources(vault, activeCanvas));\n\n    setIsInformationPanel(annotationResources.length !== 0);\n  }, [activeCanvas, annotationResources.length, vault]);\n\n  // make request to content search service using iiifContentSearch prop\n  useEffect(() => {\n    if (iiifContentSearch === undefined) return;\n    if (configOptions.informationPanel?.renderContentSearch === false) return;\n\n    getContentSearchResources(\n      contentSearchVault,\n      iiifContentSearch,\n      configOptions.localeText?.contentSearch?.tabLabel as string,\n    ).then((contentSearch) => {\n      setContentSearchResource(contentSearch);\n    });\n  }, [iiifContentSearch, contentSearchVault, configOptions]);\n\n  // add overlays for content search\n  useEffect(() => {\n    if (!openSeadragonViewer) return;\n    if (!contentSearchResource) return;\n\n    const canvas: CanvasNormalized = vault.get({\n      id: activeCanvas,\n      type: \"Canvas\",\n    });\n\n    removeOverlaysFromViewer(openSeadragonViewer, \"content-search-overlay\");\n    addContentSearchOverlays(\n      contentSearchVault,\n      contentSearchResource,\n      openSeadragonViewer,\n      canvas,\n      configOptions,\n    );\n  }, [\n    contentSearchVault,\n    configOptions,\n    openSeadragonViewer,\n    activeCanvas,\n    vault,\n    contentSearchResource,\n  ]);\n\n  const hasSearchService = manifest.service.some(\n    (service: any) => service.type === \"SearchService2\",\n  );\n\n  // check if search service exists in the manifest\n  useEffect(() => {\n    if (hasSearchService) {\n      const searchService: any = manifest.service.find(\n        (service: any) => service.type === \"SearchService2\",\n      );\n      if (searchService) {\n        setSearchServiceUrl(searchService.id);\n      }\n    }\n  }, [manifest, hasSearchService]);\n\n  return (\n    <ErrorBoundary FallbackComponent={ErrorFallback}>\n      <Wrapper\n        className={`${theme} clover-viewer`}\n        css={{ background: configOptions?.background }}\n        data-body-locked={isBodyLocked}\n        data-information-panel={isInformationPanel}\n        data-information-panel-open={informationOpen}\n      >\n        <Collapsible.Root\n          open={informationOpen}\n          onOpenChange={setInformationOpen}\n        >\n          <ViewerHeader\n            manifestLabel={manifest.label as InternationalString}\n            manifestId={manifest.id}\n          />\n          <ViewerContent\n            activeCanvas={activeCanvas}\n            painting={painting}\n            annotationResources={annotationResources}\n            searchServiceUrl={searchServiceUrl}\n            setContentSearchResource={setContentSearchResource}\n            contentSearchResource={contentSearchResource}\n            items={manifest.items}\n            isAudioVideo={isAudioVideo}\n          />\n        </Collapsible.Root>\n      </Wrapper>\n    </ErrorBoundary>\n  );\n};\n\nexport default Viewer;\n\nfunction addContentSearchOverlays(\n  contentSearchVault: any,\n  contentSearch: AnnotationPageNormalized,\n  openSeadragonViewer,\n  canvas: CanvasNormalized,\n  configOptions,\n) {\n  const annotations: Array<AnnotationNormalized> = [];\n  contentSearch?.items?.forEach((item) => {\n    const annotation = contentSearchVault.get(item.id) as AnnotationNormalized;\n\n    if (typeof annotation.target === \"string\") {\n      if (annotation.target.startsWith(canvas.id)) {\n        annotations.push(annotation as unknown as AnnotationNormalized);\n      }\n    }\n  });\n\n  if (openSeadragonViewer) {\n    addOverlaysToViewer(\n      openSeadragonViewer,\n      canvas,\n      configOptions,\n      annotations,\n      \"content-search-overlay\",\n    );\n  }\n}\n","import { IncomingHttpHeaders } from \"http\";\n\nexport interface RequestOptions {\n  ignoreCache?: boolean;\n  headers?: IncomingHttpHeaders;\n  timeout?: number;\n  withCredentials: boolean;\n}\n\nexport const DEFAULT_REQUEST_OPTIONS = {\n  ignoreCache: false,\n  headers: {\n    Accept: \"application/json, text/javascript, text/plain\",\n  },\n  timeout: 5000,\n  withCredentials: false,\n};\n\nexport interface RequestResult {\n  ok: boolean;\n  status: number;\n  statusText: string;\n  data: string;\n  json: <T>() => T;\n  headers: string;\n}\n\nfunction parseXHRResult(xhr: XMLHttpRequest): RequestResult {\n  return {\n    ok: xhr.status >= 200 && xhr.status < 300,\n    status: xhr.status,\n    statusText: xhr.statusText,\n    headers: xhr.getAllResponseHeaders(),\n    data: xhr.responseText,\n    json: <T>() => JSON.parse(xhr.responseText) as T,\n  };\n}\n\nfunction errorResponse(\n  xhr: XMLHttpRequest,\n  message: string | null = null,\n): RequestResult {\n  return {\n    ok: false,\n    status: xhr.status,\n    statusText: xhr.statusText,\n    headers: xhr.getAllResponseHeaders(),\n    data: message || xhr.statusText,\n    json: <T>() => JSON.parse(message || xhr.statusText) as T,\n  };\n}\n\nexport function getRequest(\n  url: string,\n  options: RequestOptions = DEFAULT_REQUEST_OPTIONS,\n) {\n  const headers = options.headers || DEFAULT_REQUEST_OPTIONS.headers;\n\n  return new Promise<RequestResult>((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n    xhr.open(\"get\", url);\n    xhr.withCredentials = options.withCredentials;\n\n    if (headers) {\n      Object.keys(headers).forEach((key) =>\n        xhr.setRequestHeader(key, headers[key]),\n      );\n    }\n\n    xhr.onload = () => {\n      resolve(parseXHRResult(xhr));\n    };\n\n    xhr.onerror = () => {\n      reject(errorResponse(xhr, `Failed to make request.`));\n    };\n\n    xhr.ontimeout = () => {\n      reject(errorResponse(xhr, `Request took longer than expected.`));\n    };\n\n    xhr.send();\n  });\n}\n","import { CollectionNormalized, ManifestNormalized } from \"@iiif/presentation-3\";\nimport React, { useEffect, useState } from \"react\";\nimport {\n  type ViewerConfigOptions,\n  ViewerProvider,\n  defaultState,\n  useViewerDispatch,\n  useViewerState,\n  CustomDisplay,\n} from \"src/context/viewer-context\";\n\nimport { Vault } from \"@iiif/vault\";\nimport Viewer from \"src/components/Viewer/Viewer/Viewer\";\nimport { createTheme } from \"@stitches/react\";\nimport { getRequest } from \"src/lib/xhr\";\n\nexport interface CloverViewerProps {\n  canvasIdCallback?: (arg0: string) => void;\n  customDisplays?: Array<CustomDisplay>;\n  customTheme?: any;\n  iiifContent: string;\n  id?: string;\n  manifestId?: string;\n  options?: ViewerConfigOptions;\n  iiifContentSearch?: string;\n}\n\nconst CloverViewer: React.FC<CloverViewerProps> = ({\n  canvasIdCallback = () => {},\n  customDisplays = [],\n  customTheme,\n  iiifContent,\n  id,\n  manifestId,\n  options,\n  iiifContentSearch,\n}) => {\n  /**\n   * Legacy `id` and `manifestId` prop support.\n   * If an id is passed, use that as the iiifResource. Otherwise,\n   * use the manifestId. If neither are passed, use the iiifContent\n   * prop.\n   */\n  let iiifResource = iiifContent;\n  if (id) iiifResource = id;\n  if (manifestId) iiifResource = manifestId;\n\n  return (\n    <ViewerProvider\n      initialState={{\n        ...defaultState,\n        customDisplays,\n        informationOpen: Boolean(options?.informationPanel?.open),\n        vault: new Vault({\n          customFetcher: (url: string) =>\n            getRequest(url, {\n              withCredentials: options?.withCredentials as boolean,\n              headers: options?.requestHeaders,\n            }).then((response) => JSON.parse(response.data)),\n        }),\n      }}\n    >\n      <RenderViewer\n        iiifContent={iiifResource}\n        canvasIdCallback={canvasIdCallback}\n        customTheme={customTheme}\n        options={options}\n        iiifContentSearch={iiifContentSearch}\n      />\n    </ViewerProvider>\n  );\n};\n\nconst RenderViewer: React.FC<CloverViewerProps> = ({\n  canvasIdCallback,\n  customTheme,\n  iiifContent,\n  options,\n  iiifContentSearch,\n}) => {\n  const dispatch: any = useViewerDispatch();\n\n  /**\n   * Retrieve state set by the wrapping <ViewerProvider/> and make\n   * the normalized manifest available from @iiif/vault.\n   */\n  const store = useViewerState();\n  const { activeCanvas, activeManifest, isLoaded, vault } = store;\n  const [iiifResource, setIiifResource] = useState<\n    CollectionNormalized | ManifestNormalized\n  >();\n  const [manifest, setManifest] = useState<ManifestNormalized>();\n\n  /**\n   * Overrides the baseline stitches theme when set.\n   */\n  let theme = {};\n  if (customTheme) theme = createTheme(\"custom\", customTheme);\n\n  /**\n   * On change, pass the activeCanvas up to the wrapping `<App/>`\n   * component to be handed off to a consuming application.\n   */\n  useEffect(() => {\n    if (canvasIdCallback) canvasIdCallback(activeCanvas);\n  }, [activeCanvas, canvasIdCallback]);\n\n  useEffect(() => {\n    if (activeManifest)\n      vault\n        .loadManifest(activeManifest)\n        .then((data: ManifestNormalized) => {\n          setManifest(data);\n          dispatch({\n            type: \"updateActiveCanvas\",\n            canvasId: data.items[0] && data.items[0].id,\n          });\n        })\n        .catch((error: Error) => {\n          console.error(`Manifest failed to load: ${error}`);\n        })\n        .finally(() => {\n          dispatch({\n            type: \"updateIsLoaded\",\n            isLoaded: true,\n          });\n        });\n  }, [activeManifest, dispatch, vault]);\n\n  useEffect(() => {\n    dispatch({\n      type: \"updateConfigOptions\",\n      configOptions: options,\n    });\n\n    vault\n      .load(iiifContent)\n      .then((data: CollectionNormalized | ManifestNormalized) => {\n        setIiifResource(data);\n      })\n      .catch((error: Error) => {\n        console.error(\n          `The IIIF resource ${iiifContent} failed to load: ${error}`,\n        );\n      });\n  }, [dispatch, iiifContent, options, vault]);\n\n  useEffect(() => {\n    let manifests: string[] = [];\n\n    if (iiifResource?.type === \"Collection\") {\n      dispatch({\n        type: \"updateCollection\",\n        collection: iiifResource,\n      });\n\n      manifests = iiifResource.items\n        .filter((item) => item.type === \"Manifest\")\n        .map((manifest) => manifest.id);\n\n      if (manifests.length > 0) {\n        dispatch({\n          type: \"updateActiveManifest\",\n          manifestId: manifests[0],\n        });\n      }\n    } else if (iiifResource?.type === \"Manifest\") {\n      dispatch({\n        type: \"updateActiveManifest\",\n        manifestId: iiifResource.id,\n      });\n    }\n  }, [dispatch, iiifResource]);\n\n  /**\n   * Render loading component while manifest is fetched and\n   * loaded into React.Context as `vault`. Upon completion\n   * (error or not) isLoaded will be set to true.\n   */\n  if (!isLoaded) return <>Loading</>;\n\n  /**\n   * If an error occurs during manifest fetch process used by\n   * @iiif/vault, vault will not return a manifest\n   * that is fully normalized, and be missing the items property.\n   * This being undefined signals that something went wrong and we\n   * will render a user-friendly error as a functional component.\n   */\n\n  if (!manifest || !manifest[\"items\"]) {\n    console.log(`The IIIF manifest ${iiifContent} failed to load.`);\n    return <></>;\n  }\n\n  /**\n   * If the manifest returned by @iiif/vault does not\n   * contain any canvases, then we'll show an error to the screen. This\n   * may be required if the viewer is rendered to preview manifests in\n   * repository administration views.\n   */\n  if (manifest[\"items\"].length === 0) {\n    console.log(`The IIIF manifest ${iiifContent} does not contain canvases.`);\n    return <></>;\n  }\n\n  /**\n   * If manifest is normalized by @iiif/vault, we know\n   * that the manifest data is retrievable via vault.get() and we\n   * will will set the activeCanvas to the first index and render the\n   * <Viewer/> component.\n   */\n  return (\n    <Viewer\n      manifest={manifest}\n      theme={theme}\n      key={manifest.id}\n      iiifContentSearch={iiifContentSearch}\n    />\n  );\n};\n\nexport default CloverViewer;\n"],"names":["cleanTime","standardNotation","array","hours","minutes","seconds","zeroPad","time","convertTime","duration","deepMerge","target","source","key","getRealPropertyValue","obj","property","num","places","defaultConfigOptions","defaultState","_a","Vault","ViewerStateContext","React","ViewerDispatchContext","viewerReducer","state","action","ViewerProvider","initialState","children","dispatch","useReducer","useViewerState","context","useViewerDispatch","getAnnotationResources","vault","activeCanvas","canvas","annotationPage","label","getContentSearchResources","contentSearchVault","searchUrl","tabLabel","getCanvasByCriteria","item","motivation","paintingType","entity","filterAnnotations","annotation","annotationBody","resource","_b","annotationPageResources","annotations","getLabel","language","codes","getPaintingResource","id","canvasEntity","getThumbnail","width","height","candidates","canvasThumbnail","annotationThumbnail","$","OpenSeadragon","svgNS","Overlay","viewer","self","p","zoom","rotation","flipped","containerSizeX","scaleX","scaleY","node","handler","OsdSvgOverlay","parseAnnotationTarget","parsedTarget","parts","x","y","w","h","value","addOverlaysToViewer","configOptions","overlaySelector","scale","parsedAnnotationTarget","point","rect","svg","addRectangularOverlay","addSvgOverlay","createOpenSeadragonRect","zoomLevel","div","backgroundColor","opacity","borderType","borderColor","borderWidth","convertSVGStringToHTML","svgString","template","svgEl","child","svg_processChild","svg_handleTextNode","newElement","svg_handleElementNode","overlay","hasStrokeColor","hasStrokeWidth","hasFillColor","hasFillOpacity","index","element","_c","_d","removeOverlaysFromViewer","elements","hue","theme","media","styled","css","keyframes","createTheme","createStitches","ErrorFallbackStyled","Headline","ErrorBody","ErrorFallback","error","message","MediaWrapper","Content","Main","CollapsibleTrigger","Collapsible","CollapsibleContent","Aside","Wrapper","Tabs","List","Trigger","Scroll","annotationItemRow","ButtonStyled","Group","Item","ItemHTMLWrapper","AnnotationItemPlainText","handleClick","AnnotationItemHTML","useWebVtt","addIdentifiersToParsedCues","cues","cue","identifier","uuidv4","createNestedCues","flat","nestedItems","stack","isChild","currentCue","orderCuesByTime","cue1","cue2","spin","RadioGroup","Cue","start","end","isActive","updateIsActive","useState","video","useEffect","currentTime","MenuStyled","Menu","items","text","AnnotationItemVTT","vttUri","setCues","isNetworkError","setIsNetworkError","response","data","flatCues","parse","orderedCues","nestedCues","AnnotationItemImage","caption","imageUri","AnnotationItem","viewerState","openSeadragonViewer","body","annotationBodyFormat","annotationBodyValue","renderItemBody","ItemStyled","AnnotationPage","FormStyled","Container","ResultsHeader","ResultsFooter","ContentSearchItem","activeTarget","setActiveTarget","annotationTarget","annotationCanvas","panToTarget","e","canvasId","targetJson","ContentSearchPage","searchResultsLimit","searchText","formatAnnotationPage","groupedAnnotations","internationalLabel","renderSearchResults","i","renderMoreResultsMessage","moreCount","SearchContent","searchServiceUrl","setContentSearchResource","setLoading","searchTerms","setSearchTerms","searchSubmitHandler","url","resources","handleChange","Form","ContentSearch","loading","ContentSearchForm","ContentSearchAnnotationPage","AboutContent","AboutStyled","getLabelEntries","lang","getLabelAsString","delimiter","entries","createMarkup","html","sanitizeHTML","sanitizeAttributes","props","remove","attributes","sanitizeHtml","StyledLabel","Label","as","useGetImageResource","size","region","service","imageService","StyledResource","ContentResource","mediaRef","useRef","contentResource","altAsLabel","alt","type","hls","Hls","event","playLoop","useCallback","startTime","loopTime","fragment","imgSrc","StyledHomepage","Homepage","homepage","PrimitivesContext","createContext","usePrimitivesContext","useContext","PrimitivesProvider","StyledMarkup","Markup","markup","MarkupWrapper","Value","StyledCustomValue","CustomValue","customValueContent","entry","cloneElement","Fragment","MetadataItem","dataAttribute","parseCustomContent","valueArray","customContent","matchingLabel","labelPattern","StyledMetadata","Metadata","metadata","customValue","StyledRequiredStatement","RequiredStatement","requiredStatement","StyledSeeAlso","StyledWrapper","SeeAlso","seeAlso","Summary","summary","Thumbnail","thumbnail","PropertiesHomepage","PropertiesId","htmlLabel","parent","PropertiesMetadata","PropertiesRequiredStatement","PropertiesRights","rights","PropertiesSeeAlso","PropertiesSummary","PropertiesThumbnail","About","activeManifest","manifest","setManifest","setHomepage","setSeeAlso","setThumbnail","Rights","Id","InformationPanel","annotationResources","contentSearchResource","informationPanel","activeResource","setActiveResource","renderAbout","renderAnnotation","renderContentSearch","handleValueChange","Information","Input","Button","Direction","useKeyPress","onKeyup","PreviousIcon","NextIcon","CloseIcon","SearchIcon","Controls","handleCanvasToggle","handleFilter","activeIndex","canvasLength","toggleFilter","setToggleFilter","isNextDisabled","setIsNextDisabled","isPreviousDisabled","setIsPreviousDisabled","handleFilterToggle","prevToggleFilter","handleFilterChange","Add","Audio","Close","Image","Video","StyledIcon","Title","Icon","slideDown","slideUp","StyledArrow","Popover","StyledClose","StyledContent","StyledTrigger","StyledPopover","Tag","Type","Spacer","Duration","IconPath","canvasIndex","getResourceType","Media","filter","setFilter","mediaItems","setMediaItems","setActiveIndex","scrollRef","entities","leftPos","step","PlaceholderStyled","ToggleStyled","PaintingStyled","PaintingCanvas","StyledSelectIcon","StyledSelectButton","Select","StyledSelectContent","StyledSelectItem","StyledSelectLabel","StyledSelect","SelectIcon","direction","title","CaretUp","CaretDown","maxHeight","onValueChange","SelectValue","SelectPortal","SelectScrollUpButton","SelectViewport","SelectGroup","SelectScrollDownButton","SelectOption","SelectItemText","SelectItemIndicator","Navigator","Viewport","ZoomIn","ZoomOut","ZoomFullScreen","Reset","Rotate","hasPlaceholder","options","getInfoResponse","json","getImageServiceURI","imageServiceURI","OSD","uri","imageType","osdUri","setOsdUri","osdInstance","setOsdInstance","config","annotationResource","tileSource","ImageViewer","painting","setImageType","setUri","PaintingPlaceholder","isMedia","placeholderCanvas","setIsInteractive","placeholder","labelAsArray","AudioVisualizerWrapper","AudioVisualizer","_props","ref","canvasRef","audioVisualizer","src","analyser","ctx","bufferLength","dataArray","renderFrame","barWidth","barHeight","PlayerWrapper","Track","ignoreCaptionLabels","Player","allSources","setCurrentTime","poster","setPoster","playerRef","isAudio","xhr","accompanyingCanvas","annotationBodies","OpenIcon","Toggle","handleToggle","isInteractive","Painting","annotationIndex","setAnnotationIndex","customDisplays","normalizedCanvas","hasChoice","showPlaceholder","handleChoiceChange","customDisplay","match","paintingFormat","format","CustomComponent","ViewerContent","isAudioVideo","informationOpen","isAside","IIIFBadgeButton","IIIFBadgeContent","ManifestLabel","Header","HeaderOptions","Collection","collection","manifestId","useCopyToClipboard","notifyTimeout","copyStatus","setCopyStatus","copy","timeoutId","Status","CopyTextStatus","status","CopyText","textPrompt","textToCopy","copyText","IIIFBadge","red","blue","StyledSwitch","Switch","StyledThumb","StyledToggle","checked","setChecked","useMediaQuery","mediaQuery","isMatch","setIsMatch","ViewerHeader","manifestLabel","showTitle","showIIIFBadge","hasOptions","isSmallViewport","useBodyLocked","initialLocked","locked","setLocked","useLayoutEffect","originalOverflow","Viewer","iiifContentSearch","viewerDispatch","isInformationPanel","setIsInformationPanel","setIsAudioVideo","setPainting","setAnnotationResources","isBodyLocked","setIsBodyLocked","setSearchServiceUrl","setInformationOpen","open","contentSearch","addContentSearchOverlays","hasSearchService","searchService","ErrorBoundary","DEFAULT_REQUEST_OPTIONS","parseXHRResult","errorResponse","getRequest","headers","resolve","reject","CloverViewer","canvasIdCallback","customTheme","iiifContent","iiifResource","RenderViewer","store","isLoaded","setIiifResource","manifests"],"mappings":"+gDAAaA,GAAaC,GAA6B,CACrD,MAAMC,EAAQD,EAAiB,SAAS,EAAE,MAAM,GAAG,EAC7CE,EAAgB,KAAK,KAAK,SAASD,EAAM,CAAC,CAAC,CAAC,EAC5CE,EAAkB,KAAK,KAAK,SAASF,EAAM,CAAC,CAAC,CAAC,EAC9CG,EAAkBC,GAAQ,KAAK,KAAK,SAASJ,EAAM,CAAC,CAAC,CAAC,EAAG,CAAC,EAMhE,IAAIK,EAAe,GAFjBJ,IAAU,GAAKC,EAAU,IAAMA,EAAU,IAAI,SAAS,EAAG,GAAG,EAAIA,CAE5B,IAAIC,CAAO,GAEjD,OAAIF,IAAU,IACLI,EAAA,GAAGJ,CAAK,IAAII,CAAI,IAGlBA,CACT,EAEaC,GAAeC,GAAqB,CACzC,MAAAR,EAA2B,IAAI,KAAKQ,EAAW,GAAI,EACtD,YAAY,EACZ,OAAO,GAAI,CAAC,EACf,OAAOT,GAAUC,CAAgB,CACnC,EAQaS,GAAY,CAACC,EAAQC,IAAW,CAC3C,GAAI,OAAOD,GAAW,UAAYA,IAAW,KACpC,OAAAC,EAGT,UAAWC,KAAOD,EAEd,OAAOA,EAAOC,CAAG,GAAM,UACvBD,EAAOC,CAAG,IAAM,MAChB,CAAC,MAAM,QAAQD,EAAOC,CAAG,CAAC,GAErBF,EAAOE,CAAG,IAAUF,EAAAE,CAAG,EAAI,IACzBF,EAAAE,CAAG,EAAIH,GAAUC,EAAOE,CAAG,EAAGD,EAAOC,CAAG,CAAC,GAEzCF,EAAAE,CAAG,EAAID,EAAOC,CAAG,EAIrB,OAAAF,CACT,EAEaG,GAAuB,CAClCC,EACAC,IAEc,OAAO,OAAOD,EAAKC,CAAQ,EACrCD,EAAIC,CAAQ,EAAE,SACd,EAAA,OAIAV,GAAU,CAACW,EAAaC,IAC5B,OAAOD,CAAG,EAAE,SAASC,EAAQ,GAAG,ECf5BC,EAAuB,CAC3B,mBAAoB,CAClB,gBAAiB,UACjB,YAAa,UACb,WAAY,QACZ,YAAa,MACb,QAAS,MACT,eAAgB,GAChB,UAAW,CACb,EACA,WAAY,cACZ,sBAAuB,QACvB,aAAc,SACd,cAAe,CACb,mBAAoB,EACtB,EACA,oBAAqB,CAAC,EACtB,iBAAkB,CAChB,KAAM,GACN,YAAa,GACb,oBAAqB,GACrB,aAAc,GACd,iBAAkB,GAClB,oBAAqB,EACvB,EACA,cAAe,CAAC,EAChB,eAAgB,CAAE,eAAgB,kBAAmB,EACrD,cAAe,GACf,UAAW,GACX,gBAAiB,GACjB,WAAY,CACV,cAAe,CACb,SAAU,iBACV,gBAAiB,qBACjB,gBAAiB,oBACjB,QAAS,aACT,YAAa,cACf,CACF,CACF,EAuCaC,EAAmC,CAC9C,aAAc,GACd,eAAgB,GAChB,WAAY,CAAC,EACb,cAAeD,EACf,eAAgB,CAAC,EACjB,iBAAiBE,GAAAF,GAAA,YAAAA,EAAsB,mBAAtB,YAAAE,GAAwC,KACzD,SAAU,GACV,MAAO,IAAIC,GAAAA,MACX,mBAAoB,IAAIA,GAAAA,MACxB,oBAAqB,IACvB,EAEMC,GACJC,EAAM,cAAkCJ,CAAY,EAChDK,GACJD,EAAM,cAAkCJ,CAAY,EAEtD,SAASM,GAAcC,EAA2BC,EAAsB,CACtE,OAAQA,EAAO,KAAM,CACnB,IAAK,qBAIH,OAAKA,EAAO,WAAUA,EAAO,SAAW,IACjC,CACL,GAAGD,EACH,aAAcC,EAAO,QAAA,EAGzB,IAAK,uBACI,MAAA,CACL,GAAGD,EACH,eAAgBC,EAAO,UAAA,EAG3B,IAAK,mBACI,MAAA,CACL,GAAGD,EACH,WAAYC,EAAO,UAAA,EAGvB,IAAK,sBACI,MAAA,CACL,GAAGD,EACH,cAAejB,GAAUiB,EAAM,cAAeC,EAAO,aAAa,CAAA,EAGtE,IAAK,wBACI,MAAA,CACL,GAAGD,EACH,gBAAiBC,EAAO,eAAA,EAG5B,IAAK,iBACI,MAAA,CACL,GAAGD,EACH,SAAUC,EAAO,QAAA,EAGrB,IAAK,4BACI,MAAA,CACL,GAAGD,EACH,oBAAqBC,EAAO,mBAAA,EAGhC,QACE,MAAM,IAAI,MAAM,0BAA0BA,EAAO,IAAI,EAAE,CAE3D,CACF,CAOA,MAAMC,GAAgD,CAAC,CACrD,aAAAC,EAAeV,EACf,SAAAW,CACF,IAAM,CACJ,KAAM,CAACJ,EAAOK,CAAQ,EAAIC,EAAAA,WAExBP,GAAeI,CAAY,EAE7B,OACGN,EAAA,cAAAD,GAAmB,SAAnB,CAA4B,MAAOI,GAClCH,EAAA,cAACC,GAAsB,SAAtB,CACC,MAAOO,CAAA,EAEND,CAAA,CAEL,CAEJ,EAEA,SAASG,GAAiB,CAClB,MAAAC,EAAUX,EAAM,WAAWD,EAAkB,EACnD,GAAIY,IAAY,OACR,MAAA,IAAI,MAAM,qDAAqD,EAEhE,OAAAA,CACT,CAEA,SAASC,GAAoB,CACrB,MAAAD,EAAUX,EAAM,WAAWC,EAAqB,EACtD,GAAIU,IAAY,OACR,MAAA,IAAI,MAAM,wDAAwD,EAEnE,OAAAA,CACT,CC1Oa,MAAAE,GAAyB,CACpCC,EACAC,IACwB,CAClB,MAAAC,EAA2BF,EAAM,IAAI,CACzC,GAAIC,EACJ,KAAM,QAAA,CACP,EAED,MAAI,EAACC,GAAA,MAAAA,EAAQ,cAAe,CAACA,EAAO,YAAY,CAAC,EAAU,GAEdF,EAAM,IAAIE,EAAO,WAAW,EAMtE,OAAQC,GACH,CAACA,EAAe,OAAS,CAACA,EAAe,MAAM,OAAe,GAC3DA,CACR,EACA,IAAKA,GAAmB,CAKvB,MAAMC,EAAQD,EAAe,OAAS,CAAE,KAAM,CAAC,aAAa,GACrD,MAAA,CAAE,GAAGA,EAAgB,MAAAC,EAAM,CACnC,CACL,EAEaC,GAA4B,MACvCC,EACAC,EACAC,IACgC,CAC5B,IAAAL,EACA,GAAA,CACeA,EAAA,MAAMG,EAAmB,KAAKC,CAAS,OAC1C,CACd,eAAQ,IAAI,gCAAgC,EACrC,EACT,CAEI,OAAAJ,EAAe,OAAS,OAC1BA,EAAe,MAAQ,CAAE,KAAM,CAACK,CAAQ,CAAE,GAErCL,CACT,EClCaM,GAAsB,CACjCT,EACAU,EACAC,EACAC,IACiB,SACjB,MAAMC,EAAuB,CAC3B,OAAQ,OACR,mBAAoB,OACpB,eAAgB,OAChB,YAAa,CAAC,CAAA,EAGVC,EAAqBC,GAA2B,CACpD,GAAIA,EAAY,CAEd,GAAI,CAACA,EAAW,MAAQ,CAACA,EAAW,WAAY,CACtC,QAAA,MACN,mFACAA,CAAA,EAEF,MACF,CAEA,IAAIC,EAAiBD,EAAW,KAI5B,MAAM,QAAQC,CAAc,IAAGA,EAAiBA,EAAe,CAAC,GAIpE,MAAMC,EAAoCjB,EAAM,IAAIgB,EAAe,EAAE,EAErE,GAAI,CAACC,EAAU,OACf,OAAQN,EAAY,CAClB,IAAK,WACH,OACEI,EAAW,SAAWL,EAAK,IAC3BK,EAAW,YACXA,EAAW,WAAW,CAAC,IAAM,YAC7BH,EAAa,SAASK,EAAS,IAAI,IAEnCF,EAAW,KAAOE,GACb,CAAC,CAACF,EACX,IAAK,gBACH,OACF,QACQ,MAAA,IAAI,MAAM,gCAAgC,CAEpD,CACF,CAAA,EAgBF,GAbOF,EAAA,OAASb,EAAM,IAAIU,CAAI,EAE1BG,EAAO,SACTA,EAAO,eAAiBb,EAAM,IAAIa,EAAO,OAAO,MAAM,CAAC,CAAC,EACjDA,EAAA,oBAAqB9B,EAAA8B,EAAO,SAAP,MAAA9B,EAAe,mBACvCiB,EAAM,KAAIkB,EAAAL,EAAO,SAAP,YAAAK,EAAe,kBAAkB,EAC3C,QAOFL,EAAO,eAAgB,CAInB,MAAAM,EAA0BnB,EAC7B,IAAIa,EAAO,eAAe,KAAK,EAC/B,IAAKH,IACG,CACL,KAAMV,EAAM,IAAIU,EAAK,KAAK,CAAC,EAAE,EAAE,EAC/B,WAAYA,EAAK,WACjB,KAAM,YAAA,EAET,EAEGU,EAA4B,CAAA,EACVD,EAAA,QAASJ,GAAe,CAK1CA,EAAW,KAAK,OAAS,SAC3BA,EAAW,KAAK,MAAM,QAASL,GAC7BU,EAAY,KAAK,CACf,GAAGL,EACH,GAAIL,EAAK,GACT,KAAMV,EAAM,IAAIU,EAAK,EAAE,CAAA,CACxB,CAAA,EAOHU,EAAY,KAAKL,CAAU,CAC7B,CACD,EAKMF,EAAA,YAAcO,EAAY,OAAON,CAAiB,CAC3D,CAEO,OAAAD,CACT,EC7HaQ,EAAW,CACtBjB,EACAkB,EAAmB,OAChB,CAIH,GAAI,CAAClB,EAAc,MAAA,GAMf,GAAA,CAACA,EAAMkB,CAAQ,EAAG,CACd,MAAAC,EAAuB,OAAO,oBAAoBnB,CAAK,EAC7D,GAAImB,EAAM,OAAS,EAAU,OAAAnB,EAAMmB,EAAM,CAAC,CAAC,CAC7C,CAKA,OAAOnB,EAAMkB,CAAQ,CACvB,ECtBaE,EAAsB,CACjCxB,EACAyB,IAC0C,CAC1C,MAAMC,EAAejB,GACnBT,EACA,CAAE,GAAAyB,EAAI,KAAM,QAAS,EACrB,WACA,CAAC,QAAS,QAAS,OAAO,CAAA,EAGxB,GAAAC,EAAa,YAAY,SAAW,GAEpCA,EAAa,aAAeA,EAAa,YAC3C,OAAOA,EAAa,YAAY,IAC7BhB,GAASA,GAAA,YAAAA,EAAM,IAAA,CAItB,ECnBaiB,GAAe,CAC1B3B,EACAa,EACAe,EACAC,IACG,CAIH,MAAMC,EAA6C,CAAA,EAKnD,GAAIjB,EAAO,QACLA,EAAO,OAAO,UAAU,OAAS,EAAG,CACtC,MAAMkB,EAA2C/B,EAAM,IACrDa,EAAO,OAAO,UAAU,CAAC,CAAA,EAE3BiB,EAAW,KAAKC,CAAe,CACjC,CAEE,GAAAlB,EAAO,YAAY,CAAC,EAAG,CAIrB,GAAAA,EAAO,YAAY,CAAC,EAAE,WACpBA,EAAO,YAAY,CAAC,EAAE,UAAU,OAAS,EAAG,CAC9C,MAAMmB,EAA+ChC,EAAM,IACzDa,EAAO,YAAY,CAAC,EAAE,UAAU,CAAC,CAAA,EAEnCiB,EAAW,KAAKE,CAAmB,CACrC,CAKF,GAAI,CAACnB,EAAO,YAAY,CAAC,EAAE,KAAM,OACjC,MAAMG,EAAiBH,EAAO,YAAY,CAAC,EACxC,KAECG,EAAe,OAAS,SAASc,EAAW,KAAKd,CAAc,CACrE,CAKA,OAAIc,EAAW,SAAW,EAAG,OAEsB,CACjD,GAAIA,EAAW,CAAC,EAAE,GAClB,OAAQA,EAAW,CAAC,EAAE,OACtB,KAAMA,EAAW,CAAC,EAAE,KACpB,MAAAF,EACA,OAAAC,CAAA,CASJ,EC9DA,IAAII,EAAI,OAAO,cAEf,GAAI,CAACA,IACCA,EAAAC,EACA,CAACD,GACG,MAAA,IAAI,MAAM,2BAA2B,EAI/C,MAAME,GAAQ,6BAGVF,EAAE,SAEFA,EAAA,OAAO,UAAU,WAAa,UAAY,CAC1C,OAAI,KAAK,gBACA,KAAK,iBAGT,KAAA,gBAAkB,IAAIG,GAAQ,IAAI,EAChC,KAAK,gBAAA,GAIhB,MAAMA,GAAU,SAAUC,EAAQ,CAEhC,MAAMC,EAAO,KAEb,KAAK,QAAUD,EACf,KAAK,gBAAkB,EACvB,KAAK,iBAAmB,EAExB,KAAK,KAAO,SAAS,gBAAgBF,GAAO,KAAK,EAC5C,KAAA,KAAK,MAAM,SAAW,WACtB,KAAA,KAAK,MAAM,KAAO,EAClB,KAAA,KAAK,MAAM,IAAM,EACjB,KAAA,KAAK,MAAM,MAAQ,OACnB,KAAA,KAAK,MAAM,OAAS,OACzB,KAAK,QAAQ,OAAO,YAAY,KAAK,IAAI,EAEzC,KAAK,MAAQ,SAAS,gBAAgBA,GAAO,GAAG,EAC3C,KAAA,KAAK,YAAY,KAAK,KAAK,EAE3B,KAAA,QAAQ,WAAW,YAAa,UAAY,CAC/CG,EAAK,OAAO,CAAA,CACb,EAEI,KAAA,QAAQ,WAAW,OAAQ,UAAY,CAC1CA,EAAK,OAAO,CAAA,CACb,EAEI,KAAA,QAAQ,WAAW,SAAU,UAAY,CAC5CA,EAAK,OAAO,CAAA,CACb,EAEI,KAAA,QAAQ,WAAW,OAAQ,UAAY,CAC1CA,EAAK,OAAO,CAAA,CACb,EAEI,KAAA,QAAQ,WAAW,SAAU,UAAY,CAC5CA,EAAK,OAAO,CAAA,CACb,EAED,KAAK,OAAO,CACd,EAGAF,GAAQ,UAAY,CAElB,KAAM,UAAY,CAChB,OAAO,KAAK,KACd,EAGA,OAAQ,UAAY,CACd,KAAK,kBAAoB,KAAK,QAAQ,UAAU,cAC7C,KAAA,gBAAkB,KAAK,QAAQ,UAAU,YAC9C,KAAK,KAAK,aAAa,QAAS,KAAK,eAAe,GAGlD,KAAK,mBAAqB,KAAK,QAAQ,UAAU,eAC9C,KAAA,iBAAmB,KAAK,QAAQ,UAAU,aAC/C,KAAK,KAAK,aAAa,SAAU,KAAK,gBAAgB,GAGlD,MAAAG,EAAI,KAAK,QAAQ,SAAS,eAAe,IAAIN,EAAE,MAAM,EAAG,CAAC,EAAG,EAAI,EAChEO,EAAO,KAAK,QAAQ,SAAS,QAAQ,EAAI,EACzCC,EAAW,KAAK,QAAQ,SAAS,YAAY,EAC7CC,EAAU,KAAK,QAAQ,SAAS,QAAQ,EAExCC,EAAiB,KAAK,QAAQ,SAAS,oBAAoB,EACjE,IAAIC,EAASD,EAAiBH,EAC9B,MAAMK,EAASD,EAEXF,IAEFE,EAAS,CAACA,EAERL,EAAA,EAAI,CAACA,EAAE,EAAII,GAGf,KAAK,MAAM,aACT,YACA,aACEJ,EAAE,EACF,IACAA,EAAE,EACF,WACAK,EACA,IACAC,EACA,YACAJ,EACA,GAAA,CAEN,EAEA,QAAS,SAAUK,EAAMC,EAAS,CAGhC,IAAId,EAAE,aAAa,CACjB,QAASa,EACT,aAAcC,CAAA,CACf,EAAE,YAAY,EAAI,CACrB,CACF,EAEa,MAAAC,GAAiBX,GACrB,IAAID,GAAQC,CAAM,EC3HrBY,GAAyB5E,GAA8C,SAC3E,IAAI6E,EAAuC,CACzC,GAAI,OAAO7E,GAAW,SAAWA,EAASA,EAAO,MAAA,EAG/C,GAAA,OAAOA,GAAW,UAChB,GAAAA,EAAO,SAAS,QAAQ,EAAG,CACvB,MAAA8E,EAAQ9E,EAAO,MAAM,QAAQ,EAC/B,GAAA8E,GAASA,EAAM,CAAC,EAAG,CACrB,KAAM,CAACC,EAAGC,EAAGC,EAAGC,CAAC,EAAIJ,EAAM,CAAC,EAAE,MAAM,GAAG,EAAE,IAAKK,GAAU,OAAOA,CAAK,CAAC,EACtDN,EAAA,CACb,GAAIC,EAAM,CAAC,EACX,KAAM,CACJ,EAAAC,EACA,EAAAC,EACA,EAAAC,EACA,EAAAC,CACF,CAAA,CAEJ,CACS,SAAAlF,EAAO,SAAS,KAAK,EAAG,CAC3B,MAAA8E,EAAQ9E,EAAO,MAAM,KAAK,EAC5B8E,GAASA,EAAM,CAAC,IACHD,EAAA,CACb,GAAIC,EAAM,CAAC,EACX,EAAGA,EAAM,CAAC,CAAA,EAGhB,OACS,OAAO9E,GAAW,aACvBU,EAAAV,EAAO,WAAP,YAAAU,EAAiB,QAAS,gBACbmE,EAAA,CACb,GAAI7E,EAAO,OACX,MAAO,CACL,EAAGA,EAAO,SAAS,EACnB,EAAGA,EAAO,SAAS,CACrB,CAAA,IAEO6C,EAAA7C,EAAO,WAAP,YAAA6C,EAAiB,QAAS,gBACpBgC,EAAA,CACb,GAAI7E,EAAO,OACX,IAAKA,EAAO,SAAS,KAAA,IAKpB,OAAA6E,CACT,EC5CO,SAASO,GACdpB,EACAnC,EACAwD,EACAtC,EACAuC,EACM,CACN,GAAI,CAACtB,EAAQ,OAEP,MAAAuB,EAAQ,EAAI1D,EAAO,MAEbkB,EAAA,QAASL,GAAe,CAClC,GAAI,CAACA,EAAW,OAAQ,OAElB,MAAA8C,EAAyBZ,GAAsBlC,EAAW,MAAM,EAChE,CAAE,MAAA+C,EAAO,KAAAC,EAAM,IAAAC,CAAA,EAAQH,EAE7B,GAAIE,EAAM,CACR,KAAM,CAAE,EAAAX,EAAG,EAAG,EAAAE,EAAG,EAAAC,GAAMQ,EACvBE,GACE5B,EACAe,EAAIQ,EACJ,EAAIA,EACJN,EAAIM,EACJL,EAAIK,EACJF,EACAC,CAAA,CAEJ,CAEA,GAAIG,EAAO,CACH,KAAA,CAAE,EAAAV,EAAG,CAAM,EAAAU,EACXE,EAAM;AAAA;AAAA,wBAEMZ,CAAC,SAAS,CAAC;AAAA;AAAA,QAI7Bc,GAAc7B,EAAQ2B,EAAKN,EAAeE,EAAOD,CAAe,CAClE,CAEIK,GACFE,GAAc7B,EAAQ2B,EAAKN,EAAeE,EAAOD,CAAe,CAClE,CACD,CACH,CAEgB,SAAAQ,GACdjE,EACA2D,EACAO,EACA,CACA,IAAIhB,EACFC,EACAC,EAAI,GACJC,EAAI,GAEFM,EAAuB,OACzBT,EAAIS,EAAuB,KAAK,EAChCR,EAAIQ,EAAuB,KAAK,EAChCP,EAAIO,EAAuB,KAAK,EAChCN,EAAIM,EAAuB,KAAK,GAG9BA,EAAuB,QACzBT,EAAIS,EAAuB,MAAM,EACjCR,EAAIQ,EAAuB,MAAM,GAQ7B,MAAAD,EAAQ,EAAI1D,EAAO,MAQlB,OAPM,IAAIgC,EAAc,KAC7BkB,EAAIQ,EAAUN,EAAIM,EAAS,GAAMQ,EAAY,GAC7Cf,EAAIO,EAAUL,EAAIK,EAAS,GAAMQ,EAAY,GAC7Cd,EAAIM,EAAQQ,EACZb,EAAIK,EAAQQ,CAAA,CAIhB,CAKA,SAASH,GACP5B,EACAe,EACAC,EACAC,EACAC,EACAG,EACAC,EACM,CACN,MAAMI,EAAO,IAAI7B,EAAc,KAAKkB,EAAGC,EAAGC,EAAGC,CAAC,EACxCc,EAAM,SAAS,cAAc,KAAK,EAExC,GAAIX,EAAc,mBAAoB,CACpC,KAAM,CAAE,gBAAAY,EAAiB,QAAAC,EAAS,WAAAC,EAAY,YAAAC,EAAa,YAAAC,GACzDhB,EAAc,mBAEhBW,EAAI,MAAM,gBAAkBC,EAC5BD,EAAI,MAAM,QAAUE,EACpBF,EAAI,MAAM,OAAS,GAAGG,CAAU,IAAIE,CAAW,IAAID,CAAW,GAC9DJ,EAAI,UAAYV,CAClB,CAEOtB,EAAA,WAAWgC,EAAKN,CAAI,CAC7B,CAEA,SAASY,GAAuBC,EAAW,CACzC,GAAI,CAACA,EAAkB,OAAA,KACjB,MAAAC,EAAW,SAAS,cAAc,UAAU,EACzC,OAAAA,EAAA,UAAYD,EAAU,OAChBC,EAAS,QAAQ,SAElB,CAAC,CACjB,CAEO,SAASX,GACd7B,EACAuC,EACAlB,EACAE,EACAD,EACA,CACM,MAAAmB,EAAQH,GAAuBC,CAAS,EAC9C,GAAIE,EACS,UAAAC,KAASD,EAAM,SACxBE,GAAiB3C,EAAQ0C,EAAOrB,EAAeE,EAAOD,CAAe,CAG3E,CAEA,SAASqB,GACP3C,EACA0C,EACArB,EACAE,EACAD,EACA,OACI,GAAAoB,EAAM,WAAa,QACrBE,GAAmBF,CAAK,MACnB,CACL,MAAMG,EAAaC,GAAsBJ,EAAOrB,EAAeE,CAAK,EAC9DwB,EAAUpC,GAAcX,CAAM,EAC5B+C,EAAA,KAAA,EAAO,OAAOF,CAAU,GACxBnG,EAAAqG,EAAA,OAAA,MAAArG,EAAM,aAAa,QAAS4E,GAG9BoB,EAAA,WAAW,QAASA,GAAU,CAClCC,GAAiB3C,EAAQ0C,EAAOrB,EAAeE,EAAOD,CAAe,CAAA,CACtE,CACH,CACF,CAEgB,SAAAwB,GACdJ,EACArB,EACAE,EACA,aACA,IAAIyB,EAAiB,GACjBC,EAAiB,GACjBC,EAAe,GACfC,EAAiB,GAErB,MAAMN,EAAa,SAAS,gBAC1B,6BACAH,EAAM,QAAA,EAGJ,GAAAA,EAAM,WAAW,OAAS,EAC5B,QAASU,EAAQ,EAAGA,EAAQV,EAAM,WAAW,OAAQU,IAAS,CACtD,MAAAC,EAAUX,EAAM,WAAWU,CAAK,EACtC,OAAQC,EAAQ,KAAM,CACpB,IAAK,OACYH,EAAA,GACf,MACF,IAAK,SACcF,EAAA,GACjB,MACF,IAAK,eACcC,EAAA,GACjB,MACF,IAAK,eACcE,EAAA,GACjB,KACJ,CACAN,EAAW,aAAaQ,EAAQ,KAAMA,EAAQ,WAAW,CAC3D,CAGF,OAAKL,IACQH,EAAA,MAAM,QAASnG,EAAA2E,EAAc,qBAAd,YAAA3E,EACtB,aAEDuG,IACQJ,EAAA,MAAM,aAAchE,EAAAwC,EAAc,qBAAd,YAAAxC,EAC3B,aAEDqE,IACQL,EAAA,MAAM,MAAOS,EAAAjC,EAAc,qBAAd,YAAAiC,EACpB,iBAEDH,IACQN,EAAA,MAAM,aAAcU,EAAAlC,EAAc,qBAAd,YAAAkC,EAC3B,SAENV,EAAW,aAAa,YAAa,SAAStB,CAAK,GAAG,EAE/CsB,CACT,CAEA,SAASD,GAAmBF,EAAkB,CACvCA,EAAM,cAGPA,EAAM,YAAY,SAAS;AAAA,CAAI,GAG3B,QAAA,IACN,YACAA,EAAM,SACN,iBACAA,EAAM,YACN,sBACAA,EAAM,WAAW,MAAA,EAErB,CAEgB,SAAAc,GACdxD,EACAsB,EACA,CACA,GAAI,CAACtB,EAAQ,OAERsB,EAAgB,WAAW,GAAG,IACjCA,EAAkB,IAAMA,GAEpB,MAAAmC,EAAW,SAAS,iBAAiBnC,CAAe,EACtDmC,GACFA,EAAS,QAASJ,GAAYrD,EAAO,cAAcqD,CAAO,CAAC,CAE/D,CChQA,MAAMK,GAAM,IAECC,GAAQ,CACnB,OAAQ,CAKN,QAAS,UACT,aAAc,UACd,WAAY,UAMZ,OAAQ,OAAOD,EAAG,eAClB,YAAa,OAAOA,EAAG,cACvB,UAAW,OAAOA,EAAG,YAMrB,UAAW,UACX,eAAgB,UAChB,aAAc,SAChB,EACA,UAAW,CACT,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,MACL,EACA,YAAa,CACX,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,MACL,EACA,MAAO,CACL,EAAG,MACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,MACL,EACA,MAAO,CACL,EAAG,MACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,OACH,EAAG,MACL,EACA,MAAO,CACL,EAAG,MACH,EAAG,MACH,EAAG,MACH,EAAG,OACH,MAAO,MACP,KAAM,QACR,EACA,YAAa,CACX,IAAK,yCACP,EACA,SAAU,CACR,EAAG,MACH,EAAG,MACH,EAAG,MACH,EAAG,MACH,IAAK,KACP,CACF,EAEaE,GAAQ,CACnB,IAAK,qBACL,GAAI,qBACJ,GAAI,qBACJ,GAAI,qBACJ,GAAI,qBACJ,GAAI,gCACN,EAIa,CAAE,OAAAC,EAAQ,IAAAC,GAAK,UAAAC,GAAW,YAAAC,EAAA,EAAgBC,GAAAA,eAAe,CACpE,MAAAN,GACA,MAAAC,EACF,CAAC,EC1GKM,GAAsBL,EAAO,MAAO,CACxC,QAAS,OACT,cAAe,SACf,WAAY,QACd,CAAC,EAEKM,GAAWN,EAAO,IAAK,CAC3B,WAAY,OACZ,SAAU,SACZ,CAAC,EAEKO,GAAYP,EAAO,OAAQ,CAC/B,SAAU,QACZ,CAAC,ECJKQ,GAA8C,CAAC,CAAE,MAAAC,KAAY,CAC3D,KAAA,CAAE,QAAAC,CAAY,EAAAD,EAEpB,uBACGJ,GAAoB,CAAA,KAAK,SACxBrH,EAAA,cAACsH,IAAS,cAAY,UAAA,EAAW,sBAAoB,EACpDI,GAAY1H,EAAA,cAAAuH,GAAA,KAAW,kBAAkBG,CAAO,GAAG,GAAC,CACvD,CAEJ,EChBMC,GAAeX,EAAO,MAAO,CACjC,SAAU,WACV,OAAQ,GACV,CAAC,EAEKY,GAAUZ,EAAO,MAAO,CAC5B,QAAS,OACT,cAAe,MACf,SAAU,SAEV,MAAO,CACL,cAAe,QACjB,CACF,CAAC,EAEKa,GAAOb,EAAO,MAAO,CACzB,QAAS,OACT,cAAe,SACf,SAAU,IACV,WAAY,IACZ,MAAO,QAEP,MAAO,CACL,MAAO,MACT,CACF,CAAC,EAEKc,GAAqBd,EAAOe,GAAY,QAAS,CACrD,QAAS,OACT,OAAQ,OACR,QAAS,IACT,WAAY,OACZ,QAAS,IACT,WAAY,QACZ,OAAQ,SACR,aAAc,MAEd,oCAAqC,CACnC,QAAS,IACT,UAAW,OACb,EAEA,MAAO,CACL,QAAS,OAET,SAAU,CACR,QAAS,OACT,SAAU,IACV,SAAU,WACV,eAAgB,SAChB,QAAS,SACT,WAAY,SACd,CACF,CACF,CAAC,EAEKC,GAAqBhB,EAAOe,GAAY,QAAS,CACrD,MAAO,OACP,QAAS,MACX,CAAC,EAEKE,GAAQjB,EAAO,QAAS,CAC5B,QAAS,OACT,SAAU,IACV,WAAY,IACZ,MAAO,QACP,UAAW,OAEX,MAAO,CACL,MAAO,MACT,CACF,CAAC,EAEKkB,GAAUlB,EAAO,MAAO,CAC5B,QAAS,OACT,cAAe,SACf,WAAY,OACZ,oBAAqB,cAErB,QAAS,CACP,QAAS,OACT,cAAe,SACf,SAAU,IACV,eAAgB,aAEhB,MAAO,CACL,CAAC,KAAKY,EAAO,EAAE,EAAG,CAChB,SAAU,GACZ,EAEA,CAAC,KAAKC,EAAI,EAAE,EAAG,CACb,SAAU,GACZ,CACF,CACF,EAEA,MAAO,CACL,QAAS,GACX,EAEA,wCAAyC,CACvC,MAAO,CACL,SAAU,QACV,OAAQ,OACR,MAAO,OACP,IAAK,IACL,KAAM,IACN,OAAQ,aAER,CAAC,KAAKF,EAAY,EAAE,EAAG,CACrB,QAAS,MACX,EAEA,CAAC,KAAKG,EAAkB,EAAE,EAAG,CAC3B,OAAQ,MACV,EAEA,CAAC,KAAKE,EAAkB,EAAE,EAAG,CAC3B,OAAQ,MACV,CACF,CACF,CACF,CAAC,EC1HKE,GAAUlB,EAAOmB,EAAK,KAAM,CAChC,QAAS,OACT,cAAe,SACf,MAAO,OACP,OAAQ,OACR,SAAU,IACV,WAAY,IACZ,SAAU,WACV,OAAQ,IACR,UAAW,gFAEX,MAAO,CACL,UAAW,SACX,UAAW,MACb,CACF,CAAC,EAEKC,GAAOpB,EAAOmB,EAAK,KAAM,CAC7B,QAAS,OACT,SAAU,IACV,OAAQ,aACR,aAAc,kBAEd,MAAO,CACL,OAAQ,QACV,CACF,CAAC,EAEKE,GAAUrB,EAAOmB,EAAK,QAAS,CACnC,QAAS,OACT,SAAU,WACV,QAAS,cACT,WAAY,OACZ,gBAAiB,cACjB,WAAY,UACZ,OAAQ,OACR,QAAS,MACT,SAAU,OACV,YAAa,OACb,WAAY,OACZ,WAAY,SACZ,OAAQ,UACR,WAAY,IACZ,WAAY,OAEZ,WAAY,CACV,MAAO,IACP,OAAQ,MACR,QAAS,GACT,SAAU,WACV,OAAQ,OACR,KAAM,IACN,WAAY,MACd,EAEA,yBAA0B,CACxB,QAAS,IACT,WAAY,IAEZ,WAAY,CACV,MAAO,OACP,gBAAiB,SACnB,CACF,CACF,CAAC,EAEKP,GAAUZ,EAAOmB,EAAK,QAAS,CACnC,QAAS,OACT,SAAU,IACV,WAAY,IACZ,SAAU,WACV,IAAK,IACL,KAAM,IAEN,yBAA0B,CACxB,MAAO,OACP,OAAQ,oBACR,QAAS,YACX,CACF,CAAC,EAEKG,GAAStB,EAAO,MAAO,CAC3B,SAAU,WACV,OAAQ,OACR,MAAO,OACP,UAAW,QACb,CAAC,ECxFKuB,GAAyB,CAC7B,SAAU,WACV,OAAQ,UACR,QAAS,OACT,MAAO,OACP,eAAgB,gBAChB,UAAW,OACX,OAAQ,IACR,QAAS,kBACT,WAAY,UACZ,WAAY,SACZ,SAAU,OACV,MAAO,UACP,OAAQ,OACR,WAAY,MACd,EAEMC,GAAexB,EAAO,SAAU,CACpC,UAAW,OAEX,UAAW,CACT,MAAO,SACT,CACF,CAAC,EAEKyB,GAAQzB,EAAO,MAAO,CAC1B,QAAS,OACT,cAAe,SACf,MAAO,MACT,CAAC,EAEK0B,GAAO1B,EAAO,MAAO,CACzB,GAAGuB,EACL,CAAC,EAEKI,GAAkB3B,EAAO,MAAO,CACpC,UAAW,CACT,MAAO,SACT,CACF,CAAC,ECjCK4B,GAAkE,CAAC,CACvE,MAAAtE,EACA,YAAAuE,CACF,IACU7I,EAAA,cAAAwI,GAAA,CAAa,QAASK,CAAA,EAAcvE,CAAM,ECJ9CwE,GAAwD,CAAC,CAC7D,MAAAxE,EACA,YAAAuE,CACF,IAEI7I,EAAA,cAAC2I,GAAA,CACC,wBAAyB,CAAE,OAAQrE,CAAM,EACzC,QAASuE,CAAA,CAAA,ECCTE,GAAY,IAAM,CACtB,SAASC,EACPC,EACsB,CACf,OAAAA,EAAK,IAAKC,GAAQ,CACjB,MAAAC,EAAaD,EAAI,YAAcE,GAAO,GAAA,EACrC,MAAA,CAAE,GAAGF,EAAK,WAAAC,EAAW,CAC7B,CACH,CAcA,SAASE,EAAiBC,EAAkD,OAC1E,MAAMC,EAAc,CAAA,EACdC,EAAQ,CAAA,EAERP,EAAOD,EAA2BM,CAAI,EAE5C,UAAW9H,KAAQyH,EAAM,CAChB,KAAAO,EAAM,OAAS,GAAKA,EAAMA,EAAM,OAAS,CAAC,EAAE,KAAOhI,EAAK,OAC7DgI,EAAM,IAAI,EAGRA,EAAM,OAAS,GACZA,EAAMA,EAAM,OAAS,CAAC,EAAE,WAC3BA,EAAMA,EAAM,OAAS,CAAC,EAAE,SAAW,CAAA,IAErC3J,EAAA2J,EAAMA,EAAM,OAAS,CAAC,EAAE,WAAxB,MAAA3J,EAAkC,KAAK2B,GACvCgI,EAAM,KAAKhI,CAAI,IAEf+H,EAAY,KAAK/H,CAAI,EACrBgI,EAAM,KAAKhI,CAAI,EAEnB,CAEO,OAAA+H,CACT,CAQA,SAASE,EACPP,EACAD,EAA6B,GACpB,CACT,OAAOA,EAAK,KACTS,GACCR,EAAI,OAASQ,EAAW,OAASR,EAAI,KAAOQ,EAAW,GAAA,CAE7D,CAOS,SAAAC,EACPV,EAA6B,GACP,CACf,OAAAA,EAAK,KAAK,CAACW,EAAMC,IAASD,EAAK,MAAQC,EAAK,KAAK,CAC1D,CAEO,MAAA,CACL,2BAAAb,EACA,iBAAAK,EACA,QAAAI,EACA,gBAAAE,CAAA,CAEJ,EC3FMG,GAAO5C,GAAU,CACrB,KAAM,CAAE,UAAW,gBAAiB,EACpC,GAAI,CAAE,UAAW,cAAe,CAClC,CAAC,EAEYuB,GAAQzB,EAAO+C,EAAW,KAAM,CAC3C,QAAS,OACT,cAAe,SACf,MAAO,MACT,CAAC,EAEYrB,GAAO1B,EAAO+C,EAAW,KAAM,CAC1C,GAAGxB,GAEH,MAAO,CACL,QAAS,cACT,SAAU,WACZ,EAEA,YAAa,CACX,QAAS,GACT,MAAO,OACP,OAAQ,OACR,aAAc,OACd,SAAU,WACV,gBAAiB,gBACjB,QAAS,IACT,KAAM,MACN,UAAW,MACX,UAAW,cAEX,MAAO,CACL,QAAS,OACX,CACF,EAEA,WAAY,CACV,QAAS,GACT,MAAO,MACP,OAAQ,MACR,SAAU,WACV,gBAAiB,aACjB,QAAS,IACT,SAAU,iCACV,KAAM,OACN,UAAW,MACX,UAAW,cAEX,MAAO,CACL,QAAS,OACX,CACF,EAEA,OAAQ,CACN,WAAY,MACd,EAEA,UAAW,CACT,MAAO,UAEP,YAAa,CACX,gBAAiB,UACjB,QAAS,GACX,EAEA,WAAY,CACV,QAAS,GACT,MAAO,MACP,OAAQ,MACR,SAAU,WACV,gBAAiB,aACjB,SAAU,iCACV,QAAS,GACX,CACF,EAEA,yBAA0B,CACxB,gBAAiB,QAEjB,YAAa,CACX,QAAS,GACT,MAAO,MACP,OAAQ,MACR,SAAU,WACV,gBAAiB,cACjB,OAAQ,yBACR,aAAc,OACd,KAAM,MACN,UAAW,MACX,QAAS,IACT,UAAW,qBACX,cAAeuB,GACf,UAAW,cAEX,MAAO,CACL,QAAS,OACX,CACF,EAEA,WAAY,CACV,QAAS,GACT,MAAO,MACP,OAAQ,MACR,SAAU,WACV,gBAAiB,cACjB,OAAQ,oBACR,SAAU,kCACV,aAAc,OACd,KAAM,MACN,UAAW,MACX,QAAS,IACT,UAAW,uBACX,cAAeA,GACf,UAAW,cAEX,MAAO,CACL,QAAS,OACX,CACF,CACF,CACF,CAAC,ECnHKE,GAAuB,CAAC,CAAE,MAAA9I,EAAO,MAAA+I,EAAO,IAAAC,KAAU,CACtD,KAAM,CAACC,EAAUC,CAAc,EAAIC,WAAS,EAAK,EAE3CC,EAAQ,SAAS,eACrB,mBAAA,EAGFC,EAAAA,UAAU,KACDD,GAAA,MAAAA,EAAA,iBAAiB,aAAc,IAAM,CACpC,KAAA,CAAE,YAAAE,CAAgB,EAAAF,EACTF,EAAAH,GAASO,GAAeA,EAAcN,CAAG,CAAA,GAGnD,IAAM,SAAS,oBAAoB,aAAc,IAAM,CAAA,CAAE,GAC/D,CAACA,EAAKD,EAAOK,CAAK,CAAC,EAEtB,MAAMzB,EAAc,IAAM,CACpByB,IACFA,EAAM,MAAM,EACZA,EAAM,YAAcL,EACpBK,EAAM,KAAK,EACb,EAIA,OAAAtK,EAAA,cAAC0I,GAAA,CACC,eAAcyB,EACd,cAAY,wBACZ,QAAStB,EACT,MAAO3H,CAAA,EAENA,EACAlB,EAAA,cAAA,SAAA,KAAQhB,GAAYiL,CAAK,CAAE,CAAA,CAGlC,EC3CaQ,GAAazD,EAAO,KAAM,CACrC,UAAW,OACX,YAAa,OACb,SAAU,WAEV,iBAAkB,CAChB,YAAa,GACf,EAEA,UAAW,CACT,CAAC,KAAK0B,EAAI,EAAE,EAAG,CACb,gBAAiB,QAEjB,YAAa,CACX,QAAS,MACX,EACA,WAAY,CACV,QAAS,MACX,CACF,CACF,EAEA,gBAAiB,CACf,OAAQ,cACV,CACF,CAAC,ECpBKgC,GAA4B,CAAC,CAAE,MAAAC,KAEhC3K,EAAA,cAAAyK,GAAA,KACEE,EAAM,IAAKnJ,GAAS,CACnB,KAAM,CAAE,KAAAoJ,EAAM,MAAAX,EAAO,IAAAC,EAAK,SAAA3J,EAAU,WAAA4I,CAAe,EAAA3H,EACnD,uBACG,KAAG,CAAA,IAAK2H,CACP,EAAAnJ,EAAA,cAACgK,IAAI,MAAOY,EAAM,MAAAX,EAAc,IAAAC,CAAA,CAAU,EACzC3J,GAAYP,EAAA,cAAC0K,GAAK,CAAA,MAAOnK,EAAU,CACtC,CAEH,CAAA,CACH,ECHEsK,GAAsD,CAAC,CAC3D,MAAA3J,EACA,OAAA4J,CACF,IAAM,CACJ,KAAM,CAAC7B,EAAM8B,CAAO,EAAI/K,EAAM,SAAqC,CAAA,CAAE,EAC/D,CAAE,iBAAAqJ,EAAkB,gBAAAM,CAAgB,EAAIZ,GAAU,EAClD,CAACiC,EAAgBC,CAAiB,EAAIjL,EAAM,SAAgB,EAElEuK,OAAAA,EAAAA,UAAU,IAAM,CACVO,GACF,MAAMA,EAAQ,CACZ,QAAS,CACP,eAAgB,aAChB,OAAQ,kBACV,CAAA,CACD,EACE,KAAMI,GAAaA,EAAS,MAAM,EAClC,KAAMC,GAAS,CACR,MAAAC,EAAWC,GAAAA,MAAMF,CAAI,EAAE,KACvBG,EAAc3B,EAAgByB,CAAQ,EACtCG,EAAalC,EAAiBiC,CAAW,EAC/CP,EAAQQ,CAAU,CAAA,CACnB,EACA,MAAO9D,GAAU,CAChB,QAAQ,MAAMqD,EAAQrD,EAAM,SAAU,CAAA,EACtCwD,EAAkBxD,CAAK,CAAA,CACxB,CAAA,EACJ,CAACqD,CAAM,CAAC,EAGT9K,EAAA,cAACyI,GAAA,CACC,cAAY,sBACZ,aAAY,YAAYtG,EAASjB,EAA8B,IAAI,CAAC,EAAA,EAEnE8J,mBACE,MAAI,CAAA,cAAY,iBAAgB,kBACfA,EAAe,UACjC,EAEFhL,EAAA,cAAC0K,GAAK,CAAA,MAAOzB,CAAM,CAAA,CAAA,CAGzB,EClDMuC,GAA0D,CAAC,CAC/D,QAAAC,EACA,YAAA5C,EACA,SAAA6C,CACF,oBAEKlD,GAAa,CAAA,QAASK,CACrB,EAAA7I,EAAA,cAAC,OAAI,IAAK0L,EAAU,IAAK,2BAA2BD,CAAO,GAAI,EAC9DzL,EAAA,cAAA,OAAA,KAAMyL,CAAQ,CACjB,ECESE,GAAkC,CAAC,CAAE,WAAA9J,KAAiB,SAC3D,KAAA,CAAE,OAAA1C,CAAW,EAAA0C,EAEb+J,EAAkClL,IAClC,CAAE,oBAAAmL,EAAqB,MAAA/K,EAAO,aAAAC,EAAc,cAAAyD,GAChDoH,EAEI9J,EAIFD,EAAW,KAAK,IAAKiK,GAAShL,EAAM,IAAIgL,EAAK,EAAE,CAAC,EAE9CC,IACJlM,EAAAiC,EAAe,KAAMgK,GAASA,EAAK,MAAM,IAAzC,YAAAjM,EAA4C,SAAU,GAElDmM,IACJhK,EAAAF,EAAe,KAAMgK,GAASA,EAAK,KAAK,IAAxC,YAAA9J,EAA2C,QAAS,GAEhDhB,EAA2BF,EAAM,IAAI,CACzC,GAAIC,EACJ,KAAM,QAAA,CACP,EAED,SAAS8H,GAAc,OACrB,GAAI,CAAC1J,EAAQ,OAEP,MAAA+F,IAAYrF,EAAA2E,EAAc,qBAAd,YAAA3E,EAAkC,YAAa,EAE3D8E,EAAyBZ,GAAsB5E,CAAM,EAErD,CAAE,MAAAyF,EAAO,KAAAC,EAAM,IAAAC,CAAA,EAAQH,EAEzB,GAAAC,GAASC,GAAQC,EAAK,CACxB,MAAMD,EAAOI,GACXjE,EACA2D,EACAO,CAAA,EAEmB2G,GAAA,MAAAA,EAAA,SAAS,UAAUhH,EAC1C,CACF,CAEA,SAASoH,GAAiB,SACxB,OAAQF,EAAsB,CAC5B,IAAK,aAED,OAAA/L,EAAA,cAAC4I,GAAA,CACC,MAAOoD,EACP,YAAAnD,CAAA,CAAA,EAGN,IAAK,YAED,OAAA7I,EAAA,cAAC8I,GAAA,CACC,MAAOkD,EACP,YAAAnD,CAAA,CAAA,EAGN,IAAK,WAED,OAAA7I,EAAA,cAAC6K,GAAA,CACC,MAAO/I,EAAe,CAAC,EAAE,MACzB,OAAQA,EAAe,CAAC,EAAE,IAAM,EAAA,CAAA,EAGtC,MAAKjC,EAAAkM,EAAqB,MAAM,UAAU,IAArC,YAAAlM,EAAwC,OAC3C,MAAM6L,IACJ1J,EAAAF,EAAe,KAAMgK,GAAS,OAAA,SAACjM,EAAAiM,EAAK,KAAL,MAAAjM,EAAS,SAAS,aAAW,IAA5D,YAAAmC,EAA+D,KAC/D,GAEA,OAAAhC,EAAA,cAACwL,GAAA,CACC,QAASQ,EACT,YAAAnD,EACA,SAAA6C,CAAA,CAAA,EAGN,QAEI,OAAA1L,EAAA,cAAC4I,GAAA,CACC,MAAOoD,EACP,YAAAnD,CAAA,CAAA,CAGR,CACF,CAEO,OAAA7I,EAAA,cAACkM,GAAY,KAAAD,EAAiB,CAAA,CACvC,EC/FaE,GAAkC,CAAC,CAAE,eAAAlL,KAAqB,OACrE,MAAM2K,EAAkClL,IAClC,CAAE,MAAAI,CAAU,EAAA8K,EAElB,GACE,CAAC3K,GACD,CAACA,EAAe,SAChBpB,EAAAoB,EAAe,QAAf,YAAApB,EAAsB,UAAW,EAEjC,OAASG,EAAA,cAAAA,EAAA,SAAA,IAAA,EAEX,MAAMkC,EAAcjB,EAAe,MAAM,IAAKO,GACrCV,EAAM,IAAIU,EAAK,EAAE,CACzB,EAED,OAAKU,EAGFlC,EAAA,cAAAyI,GAAA,CAAM,cAAY,iBAAA,EAChBvG,GAAA,YAAAA,EAAa,IAAKL,GACjB7B,EAAA,cAAC2L,IAAe,IAAK9J,EAAW,GAAI,WAAAA,EAAwB,EAEhE,EAPyB7B,EAAA,cAAAA,EAAA,SAAA,IAAA,CAS7B,ECnCMwI,GAAexB,EAAO,SAAU,CACpC,UAAW,OAEX,UAAW,CACT,MAAO,SACT,CACF,CAAC,EAEK0B,GAAO1B,EAAO,KAAM,CACxB,OAAQ,WACV,CAAC,EAEKoB,GAAOpB,EAAO,KAAM,CACxB,cAAe,OACf,aAAc,OACd,kBAAmB,QACrB,CAAC,EAEKoF,GAAapF,EAAO,MAAO,CAC/B,aAAc,OAEd,MAAO,CACL,WAAY,UACZ,QAAS,QACX,CACF,CAAC,EAEKqF,GAAYrF,EAAO,MAAO,CAC9B,OAAQ,iBACV,CAAC,EAEKsF,GAAgBtF,EAAO,MAAO,CAClC,WAAY,MACd,CAAC,EAEKuF,GAAgBvF,EAAO,MAAO,CAClC,aAAc,MAChB,CAAC,EC7BK4B,GAAkE,CAAC,CACvE,MAAAtE,EACA,YAAAuE,EACA,OAAA1J,EACA,OAAA6B,CACF,IAEIhB,EAAA,cAACwI,GAAA,CACC,QAASK,EACT,cAAa1J,EACb,cAAa6B,CAAA,EAEZsD,CAAA,ECEMkI,GAAqC,CAAC,CACjD,WAAA3K,EACA,aAAA4K,EACA,gBAAAC,CACF,IAAM,OACJ,MAAMlM,EAAgBI,IAChBgL,EAAkClL,IAClC,CACJ,oBAAAmL,EACA,MAAA/K,EACA,mBAAAM,EACA,aAAAL,EACA,cAAAyD,CACE,EAAAoH,EAEE5K,EAA2BF,EAAM,IAAI,CACzC,GAAIC,EACJ,KAAM,QAAA,CACP,EAQKiL,IACJnM,EAHEgC,EAAW,KAAK,IAAKiK,GAAS1K,EAAmB,IAAI0K,EAAK,EAAE,CAAC,EAGhD,KAAMA,GAASA,EAAK,KAAK,IAAxC,YAAAjM,EAA2C,QAAS,GAElD,IAAA8M,EACA9K,EAAW,QACT,OAAOA,EAAW,QAAW,WAC/B8K,EAAmB9K,EAAW,QAI9B,IAAA+K,EACJ,GAAID,EAAkB,CACd,MAAA1I,EAAQ0I,EAAiB,MAAM,OAAO,EACxC1I,EAAM,OAAS,IACjB2I,EAAmB3I,EAAM,CAAC,EAE9B,CAEA,SAAS4I,GAAc,OACf,MAAA3H,IAAYrF,EAAA2E,EAAc,qBAAd,YAAA3E,EAAkC,YAAa,EAE3D8E,EAAyBZ,GAAsB4I,CAAgB,EAE/D,CAAE,MAAA/H,EAAO,KAAAC,EAAM,IAAAC,CAAA,EAAQH,EAEzB,GAAAC,GAASC,GAAQC,EAAK,CACxB,MAAMD,EAAOI,GACXjE,EACA2D,EACAO,CAAA,EAEmB2G,GAAA,MAAAA,EAAA,SAAS,UAAUhH,EAC1C,CACF,CAGA0F,EAAAA,UAAU,IAAM,CACTsB,GACDc,GAAoBF,GAEZI,GAAA,EAGX,CAAChB,CAAmB,CAAC,EAExB,SAAShD,EAAYiE,EAAG,CACtB,GAAI,CAACjB,EAAqB,OAE1B,MAAM1M,EAAS,KAAK,MAAM2N,EAAE,OAAO,QAAQ,MAAM,EAC3CC,EAAWD,EAAE,OAAO,QAAQ,OAG9B/L,IAAiBgM,EACPF,KAKHrM,EAAA,CACP,KAAM,qBACN,SAAAuM,CAAA,CACD,EACDL,EAAgBvN,CAAM,EAE1B,CAEM,MAAA6N,EAAa,KAAK,UAAUL,CAAgB,EAElD,uBACGT,GACC,KAAAlM,EAAA,cAAC4I,GAAA,CACC,OAAQoE,EACR,OAAQJ,EACR,MAAOZ,EACP,YAAAnD,CAAA,CAAA,CAEJ,CAEJ,EChHaoE,GAAqC,CAAC,CAAE,eAAAhM,KAAqB,WACxE,MAAM2K,EAAkClL,IAClC,CAAE,mBAAAU,EAAoB,cAAAoD,CAAkB,EAAAoH,EAExC,CAACa,EAAcC,CAAe,EAAIrC,EAA6B,SAAA,EAE/D6C,GAAqBrN,EAAA2E,EAAc,gBAAd,YAAA3E,EAA6B,mBAClDsN,GAAanL,EAAAwC,EAAc,aAAd,YAAAxC,EAA0B,cAE7C,SAASoL,EAAqBnM,EAA0C,CACtE,MAAMoM,EAAyC,CAAA,EAC/CpM,OAAAA,EAAe,MAAM,QAASO,GAAS,CACrC,MAAMK,EAAaT,EAAmB,IACpCI,EAAK,EAAA,EAEP,IAAIN,EAAQ,GACZ,GAAIW,EAAW,MAAO,CACd,MAAAyL,EAAqBnL,EAASN,EAAW,KAAK,EAChDyL,IACFpM,EAAQoM,EAAmB,CAAC,EAEhC,CAEID,EAAmBnM,CAAK,GAAK,OACZmM,EAAAnM,CAAK,EAAI,IAEXmM,EAAAnM,CAAK,EAAE,KAAKW,CAAU,CAAA,CAC1C,EACMwL,CACT,CAEA,SAASE,EACPrL,EACqB,CAKrB,OAJyBgL,EACrBhL,EAAY,MAAM,EAAGgL,CAAkB,EACvChL,GAEoB,IAAI,CAACL,EAAY2L,IACvCxN,EAAA,cAACwM,GAAA,CACC,IAAKgB,EACL,WAAA3L,EACA,aAAA4K,EACA,gBAAAC,CAAA,CAAA,CAEH,CACH,CAEA,SAASe,EAAyBvL,EAAqC,CACrE,GAAIgL,EAAoB,CAChB,MAAAQ,EAAYxL,EAAY,OAASgL,EACvC,GAAIQ,EAAY,EACd,OACG1N,EAAA,cAAAuM,GAAA,KACEmB,EAAU,IAAEP,GAAA,YAAAA,EAAY,WAC3B,CAGN,CACF,CAEA,MACE,CAAClM,GACD,CAACA,EAAe,SAChBwF,EAAAxF,EAAe,QAAf,YAAAwF,EAAsB,UAAW,EAE1BzG,EAAA,cAAC,IAAG,KAAAmN,GAAA,YAAAA,EAAY,eAAgB,kCAIpC,OAAO,QAAQC,EAAqBnM,CAAc,CAAC,EAAE,IACpD,CAAC,CAACC,EAAOgB,CAAW,EAAGsL,IAEnBxN,EAAA,cAAC,OAAI,IAAKwN,mBACPlB,GAAc,CAAA,UAAU,gCACtBpL,CACH,kBACCkH,GAAK,CAAA,UAAU,0BACbmF,EAAoBrL,CAAW,CAClC,EACCuL,EAAyBvL,CAAW,CACvC,CAEJ,CAEJ,CAEJ,ECtFMyL,GAAiC,CAAC,CACtC,iBAAAC,EACA,yBAAAC,EACA,WAAAC,CACF,IAAM,OACJ,KAAM,CAACC,EAAaC,CAAc,EAAI3D,EAA6B,SAAA,EAE7DuB,EAAkClL,IAClC,CAAE,mBAAAU,EAAoB,oBAAAyK,EAAqB,cAAArH,CAAA,EAC/CoH,EACIuB,GAAatN,EAAA2E,EAAc,aAAd,YAAA3E,EAA0B,cAE7C,eAAeoO,EAAoBnB,EAAG,CACpCA,EAAE,eAAe,EACjB,MAAMxL,EAAW6L,GAAA,YAAAA,EAAY,SAE7B,GAAI,CAACtB,EAAqB,OAC1B,GAAI,CAACkC,GAAeA,EAAY,KAAA,IAAW,GAAI,CAEpBF,EAAA,CACvB,MAAO,CAAE,KAAM,CAACvM,CAAQ,CAAE,CAAA,CACY,EACxC,MACF,CAEAwM,EAAW,EAAI,EAEf,MAAMI,EAAMN,EAAmB,MAAQG,EAAY,KAAK,EAC9B5M,GAAAC,EAAoB8M,EAAK5M,CAAQ,EAAE,KAC1D6M,GAAc,CACbN,EAAyBM,CAAS,EAClCL,EAAW,EAAK,CAClB,CAAA,CAEJ,CAEM,MAAAM,EAAgBtB,GAAW,CAC/BA,EAAE,eAAe,EACFkB,EAAAlB,EAAE,OAAO,KAAK,CAAA,EAI7B,OAAA9M,EAAA,cAACoM,GACC,KAAApM,EAAA,cAACqO,GAAK,KAAL,CAAU,SAAUJ,EAAqB,UAAU,qBAClD,EAAAjO,EAAA,cAACqO,GAAK,MAAL,CAAW,KAAK,cAAc,SAAUD,CACvC,EAAApO,EAAA,cAACqO,GAAK,QAAL,CAAa,YAAalB,GAAA,YAAAA,EAAY,eAAiB,CAAA,CAC1D,CACF,CACF,CAEJ,ECnDMmB,GAA8C,CAAC,CACnD,iBAAAV,EACA,yBAAAC,EACA,aAAA9M,EACA,eAAAE,CACF,IAAM,CACJ,KAAM,CAACsN,EAAST,CAAU,EAAIzD,WAAS,EAAK,EAE5C,uBACGgC,GACC,KAAArM,EAAA,cAACwO,GAAA,CACC,iBAAAZ,EACA,yBAAAC,EACA,aAAA9M,EACA,WAAA+M,CAAA,CAAA,EAED,CAACS,GACCvO,EAAA,cAAAyO,GAAA,CAA4B,eAAAxN,CAAgC,CAAA,EAE9DsN,GAAWvO,EAAA,cAAC,OAAK,KAAA,YAAU,CAC9B,CAEJ,ECpCM0O,GAAe1H,EAAO,MAAO,CACjC,QAAS,mBACT,QAAS,OACT,cAAe,SACf,SAAU,SACV,SAAU,WACV,WAAY,MACZ,SAAU,OACV,OAAQ,IAER,IAAK,CACH,SAAU,QACV,UAAW,QACX,UAAW,UACX,MAAO,cACP,OAAQ,WACR,aAAc,MACd,gBAAiB,iBACnB,EAEA,MAAO,CACL,QAAS,MACX,EAEA,eAAgB,CACd,MAAO,SACT,EAEA,EAAG,CACD,SAAU,OACV,WAAY,SACZ,OAAQ,GACV,EAEA,GAAI,CACF,OAAQ,IAER,GAAI,CACF,WAAY,MACZ,OAAQ,gBACV,EAEA,GAAI,CACF,OAAQ,GACV,CACF,EAEA,2BAA4B,CAC1B,WAAY,MACZ,OAAQ,gBACV,EAEA,SAAU,CACR,QAAS,IACT,OAAQ,IAER,GAAI,CACF,SAAU,OACV,WAAY,SACZ,UAAW,OACX,OAAQ,mBACV,CACF,CACF,CAAC,EAEK2H,GAAc3H,EAAO,MAAO,CAChC,SAAU,WACV,MAAO,OACP,OAAQ,OACR,OAAQ,GACV,CAAC,ECtEY4H,GAAkB,CAC7B1N,EACA2N,EAAe,SACZ,CAIH,GAAI,CAAC3N,EAAc,OAAA,KAKnB,GAAI,OAAOA,GAAU,SAAU,MAAO,CAACA,CAAK,EAMxC,GAAA,CAACA,EAAM2N,CAAI,EAAG,CACV,MAAAxM,EAAuB,OAAO,oBAAoBnB,CAAK,EAC7D,GAAImB,EAAM,OAAS,EAAU,OAAAnB,EAAMmB,EAAM,CAAC,CAAC,CAC7C,CAMA,MADI,CAACnB,EAAM2N,CAAI,GACX,CAAC,MAAM,QAAQ3N,EAAM2N,CAAI,CAAC,EAAU,KAEjC3N,EAAM2N,CAAI,CACnB,EAEaC,EAAmB,CAC9B5N,EACA2N,EAAe,OACfE,EAAoB,OACjB,CACG,MAAAC,EAAUJ,GAAgB1N,EAAO2N,CAAI,EACpC,OAAA,MAAM,QAAQG,CAAO,EAAIA,EAAQ,KAAK,GAAGD,CAAS,EAAE,EAAIC,CACjE,ECvCA,SAASC,GAAaC,EAAc,CAClC,MAAO,CAAE,OAAQC,GAAaD,CAAI,CAAE,CACtC,CAEA,SAASE,EAAmBC,EAAYC,EAAkB,CACxD,MAAMN,EAAU,OAAO,KAAKK,CAAK,EAAE,OAAQhQ,GACxCiQ,EAAO,SAASjQ,CAAG,EAAU,KAANA,CAAM,EAG1BkQ,EAAa,IAAI,OACf,OAAAP,EAAA,QAAS3P,GAAQ,CACZkQ,EAAAlQ,CAAG,EAAIgQ,EAAMhQ,CAAG,CAAA,CAC5B,EAEMkQ,CACT,CAEA,SAASJ,GAAaD,EAAc,CAClC,OAAOM,GAAaN,EAAM,CACxB,kBAAmB,CACjB,EAAG,CAAC,MAAM,EACV,IAAK,CAAC,MAAO,MAAO,SAAU,OAAO,CACvC,EACA,eAAgB,CAAC,OAAQ,QAAS,QAAQ,EAC1C,YAAa,CACX,IACA,IACA,KACA,IACA,MACA,IACA,QACA,OACA,MACA,KACF,CAAA,CACD,CACH,CCjCA,MAAMO,GAAczI,EAAO,OAAQ,CAAA,CAAE,EAE/B0I,EAAoCL,GAAU,CAC5C,KAAA,CAAE,GAAAM,EAAI,MAAAzO,CAAU,EAAAmO,EAMhBE,EAAaH,EAAmBC,EADvB,CAAC,KAAM,OAAO,CACsB,EAGjD,OAAArP,EAAA,cAACyP,IAAY,GAAAE,EAAS,GAAGJ,GACtBT,EAAiB5N,EAAOqO,EAAW,IAAc,CACpD,CAEJ,ECpBaK,GAAsB,CACjC7N,EACA8N,EAAe,OACfC,EAAiB,SACd,CAIC,MAAM,QAAQ/N,CAAQ,IAAGA,EAAWA,EAAS,CAAC,GAE5C,KAAA,CAAE,GAAAQ,EAAI,QAAAwN,CAAY,EAAAhO,EAEpB,IAAAiO,EAKJ,GAAI,CAACD,EAAgB,OAAAxN,EAKrB,GAHI,MAAM,QAAQR,EAAS,OAAO,GAAKA,EAAS,QAAQ,OAAS,IAC/DiO,EAAeD,EAAQ,CAAC,GAEtBC,EAAc,CAChB,GAAIA,EAAa,KAAK,EACpB,MAAO,GAAGA,EAAa,KAAK,CAAC,IAAIF,CAAM,IAAID,CAAI,iBAEjD,GAAIG,EAAa,GACf,MAAO,GAAGA,EAAa,EAAE,IAAIF,CAAM,IAAID,CAAI,gBAC/C,CACF,ECtBMI,GAAiBjJ,EAAO,MAAO,CAAE,UAAW,OAAS,CAAA,EAErDkJ,GAAwDb,GAAU,CAChE,MAAAc,EAAWC,SAAO,IAAI,EACtB,CAAE,gBAAAC,EAAiB,WAAAC,EAAY,OAAAR,EAAS,QAAWT,EAErD,IAAAkB,EACAD,IAAYC,EAAMzB,EAAiBwB,CAAU,GAM3C,MAAAf,EAAaH,EAAmBC,EADvB,CAAC,kBAAmB,YAAY,CACI,EAE7C,CAAE,KAAAmB,EAAM,GAAAjO,EAAI,MAAAG,EAAQ,IAAK,OAAAC,EAAS,IAAK,SAAA1D,CAAa,EAAAoR,EAE1D9F,EAAAA,UAAU,IAAM,CAYV,GAPA,CAAChI,GAAM,CAAC4N,EAAS,SACjB,CAAC,OAAO,EAAE,SAASK,CAAI,GAMvB,CAACjO,EAAG,SAAS,MAAM,EAAG,OAGpB,MAAAkO,EAAM,IAAIC,EAEhB,OAAIP,EAAS,UACPM,EAAA,YAAYN,EAAS,OAAO,EAChCM,EAAI,GAAGC,EAAI,OAAO,eAAgB,UAAY,CAC5CD,EAAI,WAAWlO,CAAY,CAAA,CAC5B,GAIHkO,EAAI,GAAGC,EAAI,OAAO,MAAO,SAAUC,EAAOxF,EAAM,CAC9C,GAAIA,EAAK,MACP,OAAQA,EAAK,KAAM,CACjB,KAAKuF,EAAI,WAAW,cAEV,QAAA,MACN,SAASC,CAAK,4CAAA,EAEhBF,EAAI,UAAU,EACd,MACF,KAAKC,EAAI,WAAW,YACV,QAAA,MACN,SAASC,CAAK,0CAAA,EAEhBF,EAAI,kBAAkB,EACtB,MACF,QAEEA,EAAI,QAAQ,EACZ,KACJ,CACF,CACD,EAEM,IAAM,CACPA,IACFA,EAAI,YAAY,EAChBA,EAAI,QAAQ,EACd,CACF,EACC,CAAClO,EAAIiO,CAAI,CAAC,EAEP,MAAAI,EAAWC,EAAAA,YAAY,IAAM,CACjC,GAAI,CAACV,EAAS,QAAS,OAEvB,IAAIW,EAAY,EACZC,EAAW,GAKf,GAHI9R,IAAqB8R,EAAA9R,GACrB,CAACsD,EAAG,MAAM,KAAK,GAAKtD,IAAU6R,EAAY7R,EAAW,IAErDsD,EAAG,MAAM,KAAK,EAAE,MAAO,CACzB,MAAMyO,EAAWzO,EAAG,MAAM,KAAK,EAAE,IAAI,EACjCyO,IAAUF,EAAY,SAASE,EAAS,MAAM,GAAG,EAAE,CAAC,CAAC,EAC3D,CAEA,MAAMjK,EAA0BoJ,EAAS,QACzCpJ,EAAM,SAAW,GACjBA,EAAM,YAAc+J,EAEpB,WAAW,IAAMF,EAAA,EAAYG,EAAW,GAAI,CAAA,EAC3C,CAAC9R,EAAUsD,CAAE,CAAC,EAEjBgI,EAAAA,UAAU,IAAMqG,EAAA,EAAY,CAACA,CAAQ,CAAC,EAEtC,MAAMK,EAASrB,GACbS,EACA,GAAG3N,CAAK,IAAIC,CAAM,GAClBmN,CAAA,EAGF,OAAQU,EAAM,CACZ,IAAK,QAED,OAAAxQ,EAAA,cAACiQ,GAAA,CACC,GAAG,MACH,IAAAM,EACA,IAAK,CAAE,MAAA7N,EAAc,OAAAC,CAAe,EACpC,IAAKJ,EACL,IAAK0O,EACJ,GAAG1B,CAAA,CAAA,EAIV,IAAK,QAED,OAAAvP,EAAA,cAACiQ,GAAA,CACC,GAAG,QACH,IAAK,CAAE,MAAAvN,EAAc,OAAAC,CAAe,EACpC,wBAAuB,GACvB,IAAKJ,EACL,KAAI,GACJ,MAAK,GACL,QAASqO,EACT,IAAKT,EACL,IAAK5N,CAAA,CAAA,EAIX,QACU,eAAA,KACN,kBAAkBiO,CAAI,mDAAA,EAEfxQ,EAAA,cAAAA,EAAA,SAAA,IAAA,CACb,CACF,EC5IMkR,GAAiBlK,EAAO,IAAK,CAAA,CAAE,EAE/BmK,GAA0C9B,GAAU,CAClD,KAAA,CAAE,SAAA9O,EAAU,SAAA6Q,CAAa,EAAA/B,EAMzBE,EAAaH,EAAmBC,EADvB,CAAC,WAAY,UAAU,CACa,EAEnD,OAEKrP,EAAA,cAAAA,EAAA,SAAA,KAAAoR,GACCA,EAAS,IAAKrP,GAAa,CACzB,MAAMb,EAAQ4N,EACZ/M,EAAS,MACTwN,EAAW,IAAA,EAGX,OAAAvP,EAAA,cAACkR,GAAA,CACC,aAAY3Q,EAAWW,EAAQ,OAC/B,KAAMa,EAAS,GACf,IAAKA,EAAS,GACb,GAAGwN,CAAA,EAEHhP,GAAsBW,CAAA,CAG5B,CAAA,CACL,CAEJ,ECxBMtB,GAAe,CACnB,UAAW,IACb,EAEMyR,GAAoBC,EAAAA,cAAsC,MAAS,EAEnEC,GAAuB,IAAM,CAC3B,MAAA5Q,EAAU6Q,aAAWH,EAAiB,EAC5C,GAAI1Q,IAAY,OACd,MAAM,IAAI,MACR,6DAAA,EAGG,OAAAA,CACT,EAEM8Q,GAA8C,CAAC,CACnD,SAAAlR,EACA,aAAAD,EAAeV,EACjB,IAAM,CACE,MAAAmP,EAAYzP,GAAqBgB,EAAc,WAAW,EAG9D,OAAAN,EAAA,cAACqR,GAAkB,SAAlB,CAA2B,MAAO,CAAE,UAAAtC,CAAA,GAClCxO,CACH,CAEJ,EAEMjB,GAAuB,CAC3BC,EACAC,IAEc,OAAO,OAAOD,EAAKC,CAAQ,EACrCD,EAAIC,CAAQ,EAAE,SACd,EAAA,OCrCAkS,GAAe1K,EAAO,OAAQ,CAAA,CAAE,EAEhC2K,GAAsCtC,GAAU,CAC9C,KAAA,CAAE,GAAAM,EAAI,OAAAiC,CAAW,EAAAvC,EACjB,CAAE,UAAAN,GAAcwC,KAEtB,GAAI,CAACK,EAAQ,OAAS5R,EAAA,cAAAA,EAAA,SAAA,IAAA,EAMhB,MAAAuP,EAAaH,EAAmBC,EADvB,CAAC,KAAM,QAAQ,CACqB,EAE7CH,EAAOD,GACXH,EAAiB8C,EAAQrC,EAAW,KAAgBR,CAAS,CAAA,EAG/D,uBACG2C,GAAa,CAAA,GAAA/B,EAAS,GAAGJ,EAAY,wBAAyBL,CAAM,CAAA,CAEzE,EAEM2C,GAA6CxC,GACjCrP,EAAM,WAAWqR,EAAiB,EAGhDrR,EAAA,cAAC2R,GAAQ,CAAA,GAAGtC,CAAO,CAAA,EAElBrP,EAAA,cAAAyR,GAAA,KACEzR,EAAA,cAAA2R,GAAA,CAAQ,GAAGtC,CAAO,CAAA,CACrB,ECvCEyC,GAAmC,CAAC,CAAE,GAAAnC,EAAK,KAAM,KAAAd,EAAM,MAAAvK,CAAM,IAChEtE,EAAA,cAAA2R,GAAA,CAAO,OAAQrN,EAAO,GAAAqL,EAAQ,KAAAd,CAAY,CAAA,ECEvCkD,GAAoB/K,EAAO,OAAQ,CAAA,CAAE,EAErCgL,GAA+C,CAAC,CACpD,GAAArC,EAAK,KACL,mBAAAsC,EACA,KAAApD,EACA,MAAAvK,CACF,IAAM,OACE,KAAA,CAAE,UAAAyK,GAAcwC,KAEhBvC,GAAUnP,EAAA+O,GAAgBtK,EAAOuK,CAAI,IAA3B,YAAAhP,EAA8B,IAAKqS,GAC1CC,EAAAA,aAAaF,EAAoB,CACtC,MAAOC,CAAA,CACR,GAID,OAAAlS,EAAA,cAAC+R,IAAkB,GAAApC,EAAQ,KAAAd,CAAA,EACxBG,GAAA,YAAAA,EAAS,IAAI,CAACkD,EAAO3L,IAAU,CAC9BA,EAAQ,GAAK,GAAGwI,CAAS,GACxB/O,EAAA,cAAAoS,EAAA,SAAA,CAAS,IAAK7L,CAAA,EAAQ2L,CAAM,CAC9B,EACH,CAEJ,ECxBMG,GAAkDhD,GAAU,OAChE,KAAM,CAAE,KAAA7N,EAAM,KAAAqN,EAAM,mBAAAoD,CAAA,EAAuB5C,EACrC,CAAE,MAAAnO,EAAO,MAAAoD,CAAU,EAAA9C,EAKnB8Q,GAAgBzS,EAAAiP,EAAiB5N,CAAK,IAAtB,YAAArB,EAClB,QAAQ,IAAK,KACd,cAEH,OACGG,EAAA,cAAA,MAAA,CAAI,KAAK,QAAQ,aAAYsS,CAAA,EAC3BtS,EAAA,cAAA0P,EAAA,CAAM,GAAG,KAAK,MAAAxO,EAAc,KAAA2N,EAAY,EACxCoD,EACCjS,EAAA,cAACgS,GAAA,CACC,GAAG,KACH,mBAAAC,EACA,MAAA3N,EACA,KAAAuK,CAAA,CAAA,EAGD7O,EAAA,cAAA8R,GAAA,CAAM,GAAG,KAAK,MAAAxN,EAAc,KAAAuK,CAAY,CAAA,CAE7C,CAEJ,EC7BgB,SAAA0D,GACdrR,EACAsR,EACA,CACA,MAAMC,EAAgBD,EACnB,OAAQN,GAAU,CACX,KAAA,CAAE,cAAAQ,CAAkB,EAAAR,EACpBrD,EAAO,OAAO,KAAKqD,EAAM,aAAa,EAAE,CAAC,EACzCS,EAAe7D,EAAiB4D,EAAe7D,CAAI,EAErD,GAAAC,EAAiB5N,EAAO2N,CAAI,IAAM8D,EAAqB,MAAA,EAC5D,CAAA,EACA,IAAKT,GAAUA,EAAM,OAAO,EAE3B,GAAC,MAAM,QAAQO,CAAa,EAEhC,OAAOA,EAAc,CAAC,CACxB,CCZA,MAAMG,GAAiB5L,EAAO,KAAM,CAAA,CAAE,EAEhC6L,GAA0CxD,GAAU,CACxD,KAAM,CAAE,GAAAM,EAAI,mBAAAsC,EAAoB,SAAAa,CAAA,EAAazD,EAEzC,GAAA,CAAC,MAAM,QAAQyD,CAAQ,EAAG,OAAS9S,EAAA,cAAAA,EAAA,SAAA,IAAA,EAEjC,MAAA+O,EAAYzP,GAAqB+P,EAAO,sBAAsB,EAW9DE,EAAaH,EAAmBC,EANvB,CACb,KACA,qBACA,uBACA,UAAA,CAEiD,EAGjD,OAAArP,EAAA,cAACyR,GAAA,CACE,GAAI,OAAO1C,GAAc,SACtB,CAAE,aAAc,CAAE,UAAAA,CAA+B,CACjD,EAAA,MAAA,EAEH+D,EAAS,OAAS,GACjB9S,EAAA,cAAC4S,GAAe,CAAA,GAAAjD,EAAS,GAAGJ,CAAA,EACzBuD,EAAS,IAAI,CAACtR,EAAM+E,IAAU,CAC7B,MAAMwM,EAAcd,EAChBM,GAAmB/Q,EAAK,MAAOyQ,CAAkB,EACjD,OAGF,OAAAjS,EAAA,cAACqS,GAAA,CACC,mBAAoBU,EACpB,KAAAvR,EACA,IAAK+E,EACL,KAAMgJ,GAAA,YAAAA,EAAY,IAAA,CAAA,CACpB,CAEH,CACH,CAAA,CAIR,ECjDqBvI,EAAO,KAAM,CAAA,CAAE,EACdA,EAAO,KAAM,CAAE,CAAA,ECCrC,MAAMgM,GAA0BhM,EAAO,KAAM,CAAA,CAAE,EAEzCiM,GAA4D5D,GAAU,CACpE,KAAA,CAAE,GAAAM,EAAI,kBAAAuD,CAAsB,EAAA7D,EAElC,GAAI,CAAC6D,EAAmB,OAASlT,EAAA,cAAAA,EAAA,SAAA,IAAA,EAE3B,MAAA+O,EAAYzP,GAAqB+P,EAAO,sBAAsB,EAM9DE,EAAaH,EAAmBC,EADvB,CAAC,KAAM,uBAAwB,mBAAmB,CACd,EAGjD,OAAArP,EAAA,cAACyR,GAAA,CACE,GAAI,OAAO1C,GAAc,SACtB,CAAE,aAAc,CAAE,UAAAA,CAA+B,CACjD,EAAA,MAAA,EAEH/O,EAAA,cAAAgT,GAAA,CAAwB,GAAArD,EAAS,GAAGJ,CACnC,EAAAvP,EAAA,cAACqS,GAAa,CAAA,KAAMa,EAAmB,KAAM3D,EAAW,IAAA,CAAM,CAChE,CAAA,CAGN,EC5BM4D,GAAgBnM,EAAO,KAAM,CAAA,CAAE,EAC/BoM,GAAgBpM,EAAO,KAAM,CAAA,CAAE,EAE/BqM,GAAwChE,GAAU,CAChD,KAAA,CAAE,GAAAM,EAAI,QAAA2D,CAAY,EAAAjE,EAMlBE,EAAaH,EAAmBC,EADvB,CAAC,KAAM,SAAS,CACoB,EAEnD,uBACG+D,GAAc,CAAA,GAAAzD,GACZ2D,GACCA,EAAQ,IAAKvR,GAAa,CACxB,MAAMb,EAAQ4N,EACZ/M,EAAS,MACTwN,EAAW,IAAA,EAEb,uBACG4D,GAAc,CAAA,IAAKpR,EAAS,EAAA,kBAC1B,IAAE,CAAA,KAAMA,EAAS,GAAK,GAAGwN,CACvB,EAAArO,GAAgBa,EAAS,EAC5B,CACF,CAEH,CAAA,CACL,CAEJ,EC/BMwR,GAAwClE,GAAU,CAChD,KAAA,CAAE,GAAAM,EAAI,QAAA6D,CAAY,EAAAnE,EAKlBE,EAAaH,EAAmBC,EADvB,CAAC,KAAM,uBAAwB,SAAS,CACJ,EAEnD,uBAAQsC,GAAO,CAAA,GAAAhC,EAAQ,OAAQ6D,EAAU,GAAGjE,CAAY,CAAA,CAC1D,ECLMkE,GAA4CpE,GAAU,CACpD,KAAA,CAAE,UAAAqE,EAAW,OAAA5D,CAAW,EAAAT,EAMxBE,EAAaH,EAAmBC,EADvB,CAAC,WAAW,CACwB,EAEnD,OAEKrP,EAAA,cAAAA,EAAA,SAAA,KAAA0T,GACCA,EAAU,IAAKrD,GACbrQ,EAAA,cAACkQ,GAAA,CACC,gBAAAG,EACA,IAAKA,EAAgB,GACrB,OAAAP,EACC,GAAGP,CAAA,CAEP,CAAA,CACL,CAEJ,ECvBMoE,GAAwD,CAAC,CAC7D,SAAAvC,CACF,KACMA,GAAA,YAAAA,EAAU,UAAW,EAAYpR,EAAA,cAAAA,EAAA,SAAA,IAAA,EAGnCA,EAAA,cAAAA,EAAA,SAAA,KACGA,EAAA,cAAA,OAAA,CAAK,UAAU,yBAAA,EAA0B,UAAQ,EAClDA,EAAA,cAACmR,GAAS,CAAA,SAAAC,CAAoB,CAAA,CAChC,ECTEwC,GAA4C,CAAC,CACjD,GAAArR,EACA,UAAAsR,EACA,OAAAC,EAAS,UACX,oCAGO9T,EAAA,cAAA,OAAA,CAAK,UAAU,yBAA2B,EAAA6T,CAAU,EACpD7T,EAAA,cAAA,IAAA,CAAE,KAAMuC,EAAI,OAAO,SAAS,GAAI,QAAQuR,CAAM,KAAA,EAC5CvR,CACH,CACF,ECVEwR,GAAwD,CAAC,CAC7D,SAAAjB,EACA,OAAAgB,EAAS,UACX,IACOhB,EAGH9S,EAAA,cAAAA,EAAA,SAAA,qBACG6S,GAAS,CAAA,SAAAC,EAAoB,GAAI,QAAQgB,CAAM,WAAa,CAAA,CAC/D,EALsB9T,EAAA,cAAAA,EAAA,SAAA,IAAA,ECJpBgU,GAAgE,CAAC,CACrE,kBAAAd,EACA,OAAAY,EAAS,UACX,IACOZ,EAIDlT,EAAA,cAAAA,EAAA,SAAA,KAAAA,EAAA,cAACiT,GAAA,CACC,kBAAAC,EACA,GAAI,QAAQY,CAAM,qBAAA,CAAA,CAEtB,EAR+B9T,EAAA,cAAAA,EAAA,SAAA,IAAA,ECP7BiU,GAAoD,CAAC,CAAE,OAAAC,KACtDA,EAIDlU,EAAA,cAAAA,EAAA,SAAA,KAAAA,EAAA,cAAC,OAAK,CAAA,UAAU,2BAA0B,QAAM,EAC/CA,EAAA,cAAA,IAAA,CAAE,KAAMkU,EAAQ,OAAO,UACrBA,CACH,CACF,EARoBlU,EAAA,cAAAA,EAAA,SAAA,IAAA,ECClBmU,GAAsD,CAAC,CAAE,QAAAb,MACzDA,GAAA,YAAAA,EAAS,UAAW,EAAYtT,EAAA,cAAAA,EAAA,SAAA,IAAA,EAGlCA,EAAA,cAAAA,EAAA,SAAA,KACGA,EAAA,cAAA,OAAA,CAAK,UAAU,yBAAA,EAA0B,UAAQ,EAClDA,EAAA,cAACqT,GAAQ,CAAA,QAAAC,CAAkB,CAAA,CAC7B,ECNEc,GAAsD,CAAC,CAC3D,QAAAZ,EACA,OAAAM,EAAS,UACX,IACON,EAGHxT,EAAA,cAAAA,EAAA,SAAA,KACGA,EAAA,cAAAuT,GAAA,CAAQ,QAAAC,EAAkB,GAAG,IAAI,GAAI,QAAQM,CAAM,UAAY,CAAA,CAClE,EALqB9T,EAAA,cAAAA,EAAA,SAAA,IAAA,ECAnBqU,GAA0D,CAAC,CAC/D,MAAAnT,EACA,UAAAwS,CACF,KACMA,GAAA,YAAAA,EAAW,UAAW,EAAY1T,EAAA,cAAAA,EAAA,SAAA,IAAA,EAIlCA,EAAA,cAAAA,EAAA,SAAA,KAAAA,EAAA,cAACyT,GAAA,CACC,WAAYvS,GAAgB,CAAE,KAAM,CAAC,UAAU,CAAE,EACjD,UAAAwS,EACA,MAAO,CAAE,gBAAiB,QAAS,UAAW,OAAQ,CAAA,CAAA,CAE1D,ECHEY,GAAkB,IAAM,CAC5B,MAAM1I,EAAkClL,IAClC,CAAE,eAAA6T,EAAgB,MAAAzT,CAAU,EAAA8K,EAE5B,CAAC4I,EAAUC,CAAW,EAAIpK,EAA6B,SAAA,EAEvD,CAAC+G,EAAUsD,CAAW,EAAIrK,EAAA,SAAoC,CAAE,CAAA,EAChE,CAACiJ,EAASqB,CAAU,EAAItK,EAAA,SAAoC,CAAE,CAAA,EAC9D,CAACqJ,EAAWkB,CAAY,EAAIvK,EAAA,SAAoC,CAAE,CAAA,EAWxE,OATAE,EAAAA,UAAU,IAAM,WACR,MAAAY,EAA2BrK,EAAM,IAAIyT,CAAc,EACzDE,EAAYtJ,CAAI,IAEZtL,EAAAsL,EAAK,WAAL,YAAAtL,EAAe,QAAS,GAAG6U,EAAY5T,EAAM,IAAIqK,EAAK,QAAQ,CAAC,IAC/DnJ,EAAAmJ,EAAK,UAAL,YAAAnJ,EAAc,QAAS,GAAG2S,EAAW7T,EAAM,IAAIqK,EAAK,OAAO,CAAC,IAC5D1E,EAAA0E,EAAK,YAAL,YAAA1E,EAAgB,QAAS,GAAGmO,EAAa9T,EAAM,IAAIqK,EAAK,SAAS,CAAC,CAAA,EACrE,CAACoJ,EAAgBzT,CAAK,CAAC,EAErB0T,EAGFxU,EAAA,cAAA2O,GAAA,KACE3O,EAAA,cAAA0O,GAAA,qBACE+E,GAAU,CAAA,UAAAC,EAAsB,MAAOc,EAAS,MAAO,EACxDxU,EAAA,cAACuT,GAAQ,CAAA,QAASiB,EAAS,OAAS,CAAA,EACnCxU,EAAA,cAAA6S,GAAA,CAAS,SAAU2B,EAAS,QAAU,CAAA,kBACtCvB,GAAkB,CAAA,kBAAmBuB,EAAS,kBAAmB,EACjExU,EAAA,cAAA6U,GAAA,CAAO,OAAQL,EAAS,OAAQ,EACjCxU,EAAA,cAACmR,GAAA,CACC,SAAAC,CAAA,CAEF,EAAApR,EAAA,cAACqT,GAAA,CACC,QAAAC,CAAA,CACF,kBACCwB,GAAG,CAAA,GAAIN,EAAS,GAAI,UAAU,eAAgB,CAAA,CACjD,CACF,EAlBsBxU,EAAA,cAAAA,EAAA,SAAA,IAAA,CAoB1B,ECjCa+U,GAA6C,CAAC,CACzD,aAAAhU,EACA,oBAAAiU,EACA,iBAAApH,EACA,yBAAAC,EACA,sBAAAoH,CACF,IAAM,CACJ,MAAMrJ,EAAkClL,IAClC,CACJ,cAAe,CAAE,iBAAAwU,CAAiB,CAChC,EAAAtJ,EAEE,CAACuJ,EAAgBC,CAAiB,EAAI/K,EAAiB,SAAA,EAEvDgL,EAAcH,GAAA,YAAAA,EAAkB,YAChCI,EAAmBJ,GAAA,YAAAA,EAAkB,iBACrCK,EAAsBL,GAAA,YAAAA,EAAkB,oBAE9C3K,EAAAA,UAAU,IAAM,CACV4K,IAEOI,EACTH,EAAkB,yBAAyB,EAClCC,EACTD,EAAkB,gBAAgB,EAElCJ,IACAA,GAAA,YAAAA,EAAqB,QAAS,GAC9B,CAACK,GAEiBD,EAAAJ,EAAoB,CAAC,EAAE,EAAE,EAC7C,EACC,CACDjU,EACAoU,EACAE,EACAE,EACAP,EACAC,CAAA,CACD,EAEK,MAAAO,EAAqBlR,GAAkB,CAC3C8Q,EAAkB9Q,CAAK,CAAA,EAIvB,OAAAtE,EAAA,cAACkI,GAAA,CACC,cAAY,oBACZ,aAAciN,EACd,cAAeK,EACf,YAAY,aACZ,MAAOL,EACP,UAAU,iCAAA,EAEVnV,EAAA,cAACoI,IAAK,aAAW,iBAAiB,cAAY,wBAC3C,EAAAmN,GAAuBN,GACrBjV,EAAA,cAAAqI,GAAA,CAAQ,MAAM,yBACb,EAAArI,EAAA,cAAC0P,GAAM,MAAOuF,EAAsB,KAA8B,CAAA,CACpE,EAEDI,GAAerV,EAAA,cAACqI,GAAQ,CAAA,MAAM,kBAAiB,OAAK,EACpDiN,GACCN,GACAA,EAAoB,IAAI,CAACjT,EAAUyL,IACjCxN,EAAA,cAACqI,GAAQ,CAAA,IAAKmF,EAAG,MAAOzL,EAAS,IAC9B/B,EAAA,cAAA0P,EAAA,CAAM,MAAO3N,EAAS,KAA8B,CAAA,CACvD,CACD,CACL,kBACCuG,GACE,KAAAiN,GAAuBN,GACrBjV,EAAA,cAAA4H,GAAA,CAAQ,MAAM,yBACb,EAAA5H,EAAA,cAACsO,GAAA,CACC,iBAAAV,EACA,yBAAAC,EACA,aAAA9M,EACA,eAAgBkU,CAAA,CAAA,CAEpB,EAEDI,GACErV,EAAA,cAAA4H,GAAA,CAAQ,MAAM,gBACb,EAAA5H,EAAA,cAACyV,GAAY,IAAA,CACf,EAEDH,GACCN,GACAA,EAAoB,IAAK/T,GAErBjB,EAAA,cAAC4H,GAAQ,CAAA,IAAK3G,EAAe,GAAI,MAAOA,EAAe,EACrD,EAAAjB,EAAA,cAACmM,GAAe,CAAA,eAAAlL,CAAgC,CAAA,CAClD,CAEH,CACL,CAAA,CAGN,EC5HMoN,GAAOrH,EAAO,MAAO,CACzB,SAAU,WACV,MAAO,OACP,IAAK,OACL,QAAS,OACT,eAAgB,WAChB,OAAQ,GACV,CAAC,EAEK0O,GAAQ1O,EAAO,QAAS,CAC5B,SAAU,IACV,OAAQ,OACR,gBAAiB,kBACjB,MAAO,WACP,YAAa,OACb,OAAQ,OACR,QAAS,SACT,aAAc,OACd,WAAY,UACZ,SAAU,OACV,WAAY,OACZ,UAAW,0BAEX,iBAAkB,CAChB,MAAO,eACT,CACF,CAAC,EAEK2O,GAAS3O,EAAO,SAAU,CAC9B,QAAS,OACT,WAAY,OACZ,OAAQ,OACR,MAAO,kBACP,OAAQ,kBACR,QAAS,IACT,OAAQ,IACR,WAAY,MACZ,aAAc,OACd,gBAAiB,UACjB,MAAO,aACP,OAAQ,UACR,UAAW,yBACX,WAAY,OAEZ,IAAK,CACH,OAAQ,MACR,MAAO,MACP,QAAS,MACT,KAAM,aACN,OAAQ,aACR,QAAS,IACT,OAAQ,iCACR,UAAW,UACX,WAAY,MACd,EAEA,aAAc,CACZ,gBAAiB,cACjB,UAAW,OACX,IAAK,CAAE,QAAS,MAAO,CACzB,CACF,CAAC,EAEK4O,GAAY5O,EAAO,MAAO,CAC9B,QAAS,OACT,YAAa,WACb,gBAAiB,aACjB,aAAc,OACd,UAAW,oBACX,MAAO,aACP,WAAY,SAEZ,SAAU,CACR,QAAS,OACT,OAAQ,WACR,SAAU,WACZ,CACF,CAAC,EAEKkB,GAAUlB,EAAO,MAAO,CAC5B,QAAS,OACT,SAAU,WACV,OAAQ,IACR,MAAO,OACP,QAAS,IACT,WAAY,OAEZ,SAAU,CACR,SAAU,CACR,KAAM,CACJ,WAAY,WAEZ,CAAC,KAAKqH,EAAI,EAAE,EAAG,CACb,MAAO,oBAEP,MAAO,CACL,MAAO,mBACT,CACF,CACF,CACF,CACF,CACF,CAAC,EClGKwH,GAAc,CAACxW,EAAae,IAAuB,CACvDmK,EAAAA,UAAU,IAAM,CACd,SAASuL,EAAQhJ,EAAkB,CAC7BA,EAAE,MAAQzN,GAAYe,GAC5B,CACO,cAAA,iBAAiB,QAAS0V,CAAO,EACjC,IAAM,OAAO,oBAAoB,QAASA,CAAO,CAC1D,EAAG,CAAE,CAAA,CACP,ECGMC,GAAyB,IAE3B/V,EAAA,cAAC,OAAI,MAAM,6BAA6B,QAAQ,aAC9C,EAAAA,EAAA,cAAC,QAAM,KAAA,YAAU,EACjBA,EAAA,cAAC,OAAA,CACC,KAAK,OACL,OAAO,eACP,cAAc,QACd,eAAe,QACf,iBAAiB,KACjB,YAAY,KACZ,EAAE,sCAAA,CAAA,CAEN,EAIEgW,GAAqB,IAEvBhW,EAAA,cAAC,OAAI,MAAM,6BAA6B,QAAQ,aAC9C,EAAAA,EAAA,cAAC,QAAM,KAAA,eAAa,EACpBA,EAAA,cAAC,OAAA,CACC,KAAK,OACL,OAAO,eACP,cAAc,QACd,eAAe,QACf,iBAAiB,KACjB,YAAY,KACZ,EAAE,sCAAA,CAAA,CAEN,EAIEiW,GAAsB,IAEvBjW,EAAA,cAAA,MAAA,CAAI,MAAM,6BAA6B,QAAQ,aAC9C,EAAAA,EAAA,cAAC,QAAM,KAAA,OAAK,EACZA,EAAA,cAAC,OAAK,CAAA,EAAE,4HAA6H,CAAA,CACvI,EAIEkW,GAAuB,IAExBlW,EAAA,cAAA,MAAA,CAAI,MAAM,6BAA6B,QAAQ,aAC9C,EAAAA,EAAA,cAAC,QAAM,KAAA,QAAM,EACbA,EAAA,cAAC,OAAK,CAAA,EAAE,oRAAqR,CAAA,CAC/R,EAIEmW,GAA4B,CAAC,CACjC,mBAAAC,EACA,aAAAC,EACA,YAAAC,EACA,aAAAC,CACF,IAAM,CACJ,KAAM,CAACC,EAAcC,CAAe,EAAIpM,WAAkB,EAAK,EACzD,CAACqM,EAAgBC,CAAiB,EAAItM,WAAkB,EAAK,EAC7D,CAACuM,EAAoBC,CAAqB,EAAIxM,WAAkB,EAAK,EAE3EE,EAAAA,UAAU,IAAM,CAEVsM,EADJP,IAAgB,CACc,EAE9BA,IAAgBC,EAAe,EAC3BI,EAAkB,EAAI,EACtBA,EAAkB,EAAK,CAAA,EAC1B,CAACL,EAAaC,CAAY,CAAC,EAK9BV,GAAY,SAAU,IAAM,CAC1BY,EAAgB,EAAK,EACrBJ,EAAa,EAAE,CAAA,CAChB,EAKD,MAAMS,EAAqB,IAAM,CACfL,EAACM,GAAqB,CAACA,CAAgB,EACvDV,EAAa,EAAE,CAAA,EAMXW,EAAsBrG,GAC1B0F,EAAa1F,EAAM,OAAO,KAAK,EAEjC,uBACGzI,GAAQ,CAAA,SAAUsO,GAChBxW,EAAA,cAAAqO,GAAA,KACEmI,GACExW,EAAA,cAAA0V,GAAA,CAAM,UAAS,GAAC,SAAUsB,EAAoB,YAAY,QAAS,CAAA,EAErE,CAACR,mBACCZ,GACC,KAAA5V,EAAA,cAAC2V,GAAA,CACC,QAAS,IAAMS,EAAmB,EAAE,EACpC,SAAUQ,EACV,KAAK,QAAA,kBAEJb,GAAa,IAAA,GAEf/V,EAAA,cAAA,OAAA,KACEsW,EAAc,EAAE,OAAKC,CACxB,EACAvW,EAAA,cAAC2V,GAAA,CACC,QAAS,IAAMS,EAAmB,CAAC,EACnC,SAAUM,EACV,KAAK,QAAA,kBAEJV,GAAS,IAAA,CAAA,CAEd,EAEFhW,EAAA,cAAC2V,GAAO,CAAA,QAASmB,EAAoB,KAAK,QAAA,EACvCN,EAAexW,EAAA,cAACiW,OAAU,EAAKjW,EAAA,cAACkW,GAAW,IAAA,CAC9C,CACF,CACF,CAEJ,EC5IMzN,GAAQzB,EAAO+C,EAAW,KAAM,CACpC,QAAS,OACT,cAAe,MACf,SAAU,IACV,QAAS,WACT,UAAW,SACX,SAAU,WACV,OAAQ,GACV,CAAC,ECTKkN,GAAgB,IACpBjX,EAAA,cAAC,OAAA,CACC,KAAK,OACL,OAAO,eACP,cAAc,QACd,eAAe,QACf,YAAY,KACZ,EAAE,0BAAA,CACJ,ECRIkX,GAAkB,IACtBlX,EAAA,cAAAA,EAAA,SAAA,KACGA,EAAA,cAAA,OAAA,CAAK,EAAE,wZAAyZ,CAAA,EAChaA,EAAA,cAAA,OAAA,CAAK,EAAE,yMAA0M,CAAA,kBACjN,OAAK,CAAA,EAAE,2MAA4M,CAAA,CACtN,ECLImX,GAAkB,IACrBnX,EAAA,cAAA,OAAA,CAAK,EAAE,6HAA6H,ECDjIoX,GAAkB,IACrBpX,EAAA,cAAA,OAAA,CAAK,EAAE,iVAAiV,ECDrVqX,GAAkB,IACrBrX,EAAA,cAAA,OAAA,CAAK,EAAE,mUAAmU,ECDhUsX,GAAatQ,EAAO,MAAO,CACtC,QAAS,cAET,SAAU,CACR,QAAS,CACP,KAAM,CACJ,OAAQ,OACR,MAAO,MACT,CACF,EACA,SAAU,CACR,KAAM,CACJ,OAAQ,OACR,MAAO,MACT,CACF,EACA,QAAS,CACP,KAAM,CACJ,OAAQ,OACR,MAAO,MACT,CACF,CACF,CACF,CAAC,ECZKuQ,GAA8B,CAAC,CAAE,SAAAhX,KAC9BP,EAAA,cAAC,aAAOO,CAAS,EAwBpBiX,EAA+CnI,GAEjDrP,EAAA,cAACsX,GAAA,CACE,GAAGjI,EACJ,cAAY,WACZ,KAAK,MACL,QAAQ,cACR,MAAM,4BAAA,EAELA,EAAM,QAAA,EAQbmI,EAAK,MAAQD,GAKbC,EAAK,IAAMP,GACXO,EAAK,MAAQN,GACbM,EAAK,MAAQL,GACbK,EAAK,MAAQJ,GACbI,EAAK,MAAQH,GC5Db,MAAMI,GAAYvQ,GAAU,CAC1B,KAAM,CAAE,QAAS,EAAG,UAAW,kBAAmB,EAClD,OAAQ,CAAE,QAAS,EAAG,UAAW,eAAgB,CACnD,CAAC,EAEKwQ,GAAUxQ,GAAU,CACxB,KAAM,CAAE,QAAS,EAAG,UAAW,kBAAmB,EAClD,OAAQ,CAAE,QAAS,EAAG,UAAW,eAAgB,CACnD,CAAC,EAEKyQ,GAAc3Q,EAAO4Q,EAAQ,MAAO,CACxC,KAAM,eACR,CAAC,EAEKC,GAAc7Q,EAAO4Q,EAAQ,MAAO,CACxC,SAAU,WACV,MAAO,IACP,IAAK,IACL,QAAS,SACT,OAAQ,IACR,OAAQ,UACR,OAAQ,OACR,WAAY,OACZ,KAAM,UAEN,UAAW,CACT,QAAS,MACX,CACF,CAAC,EAEKE,GAAgB9Q,EAAO4Q,EAAQ,QAAS,CAC5C,OAAQ,OACR,gBAAiB,QACjB,KAAM,WACN,QAAS,sBACT,MAAO,OACP,SAAU,QACV,SAAU,QACV,aAAc,MACd,UAAW,qBAKX,kBAAmB,OACnB,wBAAyB,gCACzB,qBAAsB,CAAE,cAAeF,EAAQ,EAC/C,wBAAyB,CAAE,cAAeD,EAAU,EAKpD,sBAAuB,CACrB,CAAC,KAAKE,EAAW,EAAE,EAAG,CACpB,OAAQ,UACV,CACF,CACF,CAAC,EAEKI,GAAgB/Q,EAAO4Q,EAAQ,QAAS,CAC5C,QAAS,cACT,QAAS,WACT,OAAQ,eACR,OAAQ,UACR,OAAQ,OACR,WAAY,OAEZ,mBAAoB,CAClB,OAAQ,GACV,CACF,CAAC,EAEKI,GAAgBhR,EAAO4Q,EAAQ,KAAM,CACzC,UAAW,aACb,CAAC,ECvDKvP,GAAmCgH,GAC/BrP,EAAA,cAAA+X,GAAA,CAAe,GAAG1I,GAAQA,EAAM,QAAS,EAiB7CzH,GAAmCyH,GAErCrP,EAAA,cAAC8X,IAAe,GAAGzI,CAAA,kBAChBsI,GAAY,IAAA,kBACZE,GACC,KAAA7X,EAAA,cAACwX,GAAK,QAAO,EAAA,kBACVA,EAAK,MAAL,IAAW,CACd,CACF,EACCnI,EAAM,QACT,EAkBEuI,EAAuD,CAAC,CAAE,SAAArX,KACvDP,EAAA,cAACgY,QAAezX,CAAS,EAGlCqX,EAAQ,QAAUvP,GAClBuP,EAAQ,QAAUhQ,GCvEL,MAAAqQ,GAAMjR,EAAO,MAAO,CAE/B,UAAW,aAGX,QAAS,cACT,WAAY,SACZ,aAAc,MACd,QAAS,KACT,aAAc,KACd,YAAa,KACb,gBAAiB,aACjB,MAAO,eACP,cAAe,YACf,SAAU,KACV,UAAW,UACX,WAAY,iBAEZ,eAAgB,CACd,YAAa,GACf,EAEA,CAAC,GAAGsQ,EAAU,EAAE,EAAG,CACjB,SAAU,WACV,KAAM,KACN,OAAQ,KACR,MAAO,IACT,EAEA,SAAU,CACR,OAAQ,CACN,KAAM,CAAE,SAAU,WAAY,YAAa,IAAK,CAClD,CACF,CACF,CAAC,EChCKY,GAAOlR,EAAO,OAAQ,CAC1B,QAAS,MACX,CAAC,EAEKmR,GAASnR,EAAO,OAAQ,CAC5B,QAAS,OACT,MAAO,YACP,OAAQ,WACV,CAAC,EAEKoR,GAAWpR,EAAO,OAAQ,CAC9B,QAAS,cACT,WAAY,MACZ,aAAc,MAChB,CAAC,EAEK0B,GAAO1B,EAAO+C,EAAW,KAAM,CACnC,QAAS,OACT,WAAY,IACZ,OAAQ,iBACR,QAAS,IACT,OAAQ,UACR,WAAY,OACZ,OAAQ,OACR,WAAY,UACZ,WAAY,SACZ,SAAU,OACV,UAAW,OAEX,eAAgB,CACd,YAAa,MACf,EAEA,OAAQ,CACN,OAAQ,IACR,MAAO,UAEP,QAAS,CACP,SAAU,WACV,QAAS,OACT,gBAAiB,gBACjB,MAAO,UACP,OAAQ,QACR,SAAU,SACV,aAAc,MACd,WAAY,OAEZ,IAAK,CACH,MAAO,OACP,OAAQ,OACR,UAAW,QACX,OAAQ,UACR,UAAW,mBACX,WAAY,OACZ,MAAO,aACT,EAEA,CAAC,KAAKmO,EAAI,EAAE,EAAG,CACb,SAAU,WACV,MAAO,IACP,OAAQ,IAER,CAAC,KAAKD,EAAG,EAAE,EAAG,CACZ,OAAQ,IACR,YAAa,IACb,SAAU,YACV,gBAAiB,QACjB,MAAO,aACP,KAAM,aACN,uBAAwB,IACxB,qBAAsB,GACxB,CACF,CACF,EAEA,WAAY,CACV,UAAW,SACX,WAAY,MACZ,SAAU,YACV,QAAS,cACT,SAAU,SACV,aAAc,WACd,gBAAiB,WACjB,gBAAiB,IAEjB,MAAO,CACL,SAAU,WACZ,CACF,CACF,EAEA,yBAA0B,CACxB,OAAQ,CACN,QAAS,CACP,gBAAiB,cAEjB,YAAa,CACX,SAAU,WACV,OAAQ,IACR,MAAO,kBACP,QAAS,cACT,cAAe,YACf,WAAY,MACZ,SAAU,YACV,cAAe,UACf,QAAS,OACT,MAAO,OACP,OAAQ,OACR,cAAe,SACf,eAAgB,SAChB,UAAW,SACX,WAAY,mBACd,EAEA,IAAK,CACH,QAAS,MACT,UAAW,yBACX,OAAQ,WACV,EAEA,CAAC,KAAKC,EAAI,EAAE,EAAG,CACb,CAAC,KAAKD,EAAG,EAAE,EAAG,CACZ,gBAAiB,SACnB,CACF,CACF,CACF,EAEA,WAAY,CACV,WAAY,KACd,CACF,CACF,CAAC,ECjHKI,GAAoC,CAAC,CAAE,KAAA7H,KAAW,CACtD,OAAQA,EAAM,CACZ,IAAK,QACI,OAAAxQ,EAAA,cAACwX,EAAK,MAAL,IAAW,EACrB,IAAK,QACI,OAAAxX,EAAA,cAACwX,EAAK,MAAL,IAAW,EACrB,IAAK,QACI,OAAAxX,EAAA,cAACwX,EAAK,MAAL,IAAW,EACrB,QACS,OAAAxX,EAAA,cAACwX,EAAK,MAAL,IAAW,CACvB,CACF,EAcM/D,GAAsC,CAAC,CAC3C,OAAAzS,EACA,YAAAsX,EACA,SAAAnO,EACA,UAAAuJ,EACA,KAAAlD,EACA,aAAApC,CACF,IAEIpO,EAAA,cAAC0I,GAAA,CACC,eAAcyB,EACd,cAAY,kBACZ,cAAamO,EACb,QAAS,IAAMlK,EAAapN,EAAO,EAAE,EACrC,MAAOA,EAAO,EAAA,EAEbhB,EAAA,cAAA,SAAA,KACEA,EAAA,cAAA,MAAA,MACE0T,GAAA,YAAAA,EAAW,KACV1T,EAAA,cAAC,MAAA,CACC,IAAK0T,EAAU,GACf,IAAK1S,GAAA,MAAAA,EAAQ,MAASmB,EAASnB,EAAO,KAAK,EAAe,EAAA,CAC5D,kBAGDkX,GACC,KAAAlY,EAAA,cAACiY,IAAI,OAAM,GAAC,cAAY,eAAA,EACrBjY,EAAA,cAAAmY,GAAA,IAAO,EACPnY,EAAA,cAAAwX,EAAA,CAAK,aAAYhH,CAAA,EACfxQ,EAAA,cAAAqY,GAAA,CAAS,KAAA7H,EAAY,CACxB,EACC,CAAC,QAAS,OAAO,EAAE,SAASA,CAAI,mBAC9B4H,GAAU,KAAApZ,GAAYgC,EAAO,QAAkB,CAAE,CAEtD,CACF,CACF,GACCA,GAAA,YAAAA,EAAQ,QACPhB,EAAA,cAAC,aAAW,CAAA,cAAY,aACtB,EAAAA,EAAA,cAAC0P,GAAM,MAAO1O,EAAO,KAAO,CAAA,CAC9B,CAEJ,CAAA,EC3FOuX,GAAmB1W,GACzBA,EAAW,KAETA,EAAW,KAAK,KAFM,QC2BzB2W,GAA8B,CAAC,CAAE,MAAA7N,KAAY,CACjD,MAAMnK,EAAgBI,IAChBT,EAA4BO,IAC5B,CAAE,aAAAK,EAAc,MAAAD,CAAU,EAAAX,EAE1B,CAACsY,EAAQC,CAAS,EAAIrO,WAAiB,EAAE,EACzC,CAACsO,EAAYC,CAAa,EAAIvO,EAAA,SAA8B,CAAE,CAAA,EAC9D,CAACiM,EAAauC,CAAc,EAAIxO,WAAiB,CAAC,EAElDyO,EAAY9Y,EAAM,OAAuB,IAAI,EAE7CyB,EAAa,WAEb2M,EAAgBrB,GAAqB,CACrChM,IAAiBgM,GACVvM,EAAA,CACP,KAAM,qBACN,SAAAuM,CAAA,CACD,CAAA,EAGLxC,EAAAA,UAAU,IAAM,CACV,GAAA,CAACoO,EAAW,OAAQ,CACtB,MAAMjX,EAAwC,CAAC,QAAS,QAAS,OAAO,EAClEqX,EAA2BpO,EAC9B,IAAKnJ,GACJD,GAAoBT,EAAOU,EAAMC,EAAYC,CAAY,CAAA,EAE1D,OAAQc,GAAiBA,EAAa,YAAY,OAAS,CAAC,EAC/DoW,EAAcG,CAAQ,CACxB,GACC,CAACpO,EAAOgO,EAAW,OAAQ7X,CAAK,CAAC,EAEpCyJ,EAAAA,UAAU,IAAM,CACHoO,EAAA,QAAQ,CAACnX,EAAM+E,IAAU,CAC9B/E,GAAA,MAAAA,EAAM,QACJA,EAAK,OAAO,KAAOT,GAAc8X,EAAetS,CAAK,CAAA,CAC5D,CAAA,EACA,CAACxF,EAAc4X,CAAU,CAAC,EAE7BpO,EAAAA,UAAU,IAAM,CACd,MAAM/D,EAAU,SAAS,cACvB,iBAAiB8P,CAAW,IAAA,EAG1B,GAAA9P,aAAmB,aAAesS,EAAU,QAAS,CACjD,MAAAE,EACJxS,EAAQ,WACRsS,EAAU,QAAQ,YAAc,EAChCtS,EAAQ,YAAc,EACxBsS,EAAU,QAAQ,SAAS,CAAE,KAAME,EAAS,SAAU,SAAU,CAClE,CAAA,EACC,CAAC1C,CAAW,CAAC,EAEhB,MAAMD,EAAgB/R,GAAkBoU,EAAUpU,CAAK,EAEjD8R,EAAsB6C,GAAiB,CACrC,MAAAzW,EAAemW,EAAWrC,EAAc2C,CAAI,EAC9CzW,GAAA,MAAAA,EAAc,QAAqB4L,EAAA5L,EAAa,OAAO,EAAE,CAAA,EAG/D,OAEIxC,EAAA,cAAAA,EAAA,SAAA,KAAAA,EAAA,cAACmW,GAAA,CACC,aAAAE,EACA,mBAAAD,EACA,YAAAE,EACA,aAAcqC,EAAW,MAAA,CAE3B,EAAA3Y,EAAA,cAACyI,GAAM,CAAA,aAAW,cAAc,cAAY,QAAQ,IAAKqQ,CACtD,EAAAH,EACE,OAAQnX,GAAS,OACZ,IAAA3B,EAAA2B,EAAK,SAAL,MAAA3B,EAAa,MAAO,CACtB,MAAMqB,EAAQiB,EAASX,EAAK,OAAO,KAAK,EACpC,GAAA,MAAM,QAAQN,CAAK,EACd,OAAAA,EAAM,CAAC,EAAE,YAAA,EAAc,SAASuX,EAAO,aAAa,CAC/D,CACD,CAAA,EACA,IAAI,CAACjX,EAAM+E,IACV,SAAA,OAAAvG,EAAA,cAACyT,GAAA,CACC,OAAQjS,EAAK,OACb,YAAa+E,EACb,aAAA6H,EACA,SAAUrN,MAAiBlB,EAAA2B,GAAA,YAAAA,EAAM,SAAN,YAAA3B,EAAc,IACzC,KAAKmC,EAAAR,GAAA,YAAAA,EAAM,SAAN,YAAAQ,EAAc,GACnB,UAAWS,GAAa3B,EAAOU,EAAM,IAAK,GAAG,EAC7C,KAAM+W,GAAgB/W,EAAK,YAAY,CAAC,CAAC,CAAA,CAE5C,EAAA,CACL,CACF,CAEJ,ECtHM0X,GAAoBlS,EAAO,SAAU,CACzC,WAAY,OACZ,OAAQ,OACR,OAAQ,UACR,MAAO,OACP,OAAQ,OACR,OAAQ,IACR,QAAS,IACT,WAAY,OAEZ,QAAS,CACP,MAAO,OACP,OAAQ,OACR,UAAW,UACX,MAAO,cACP,WAAY,MACd,EAEA,SAAU,CACR,QAAS,CACP,KAAM,CACJ,OAAQ,SACV,CACF,CACF,CACF,CAAC,ECzBK0B,GAAO1B,EAAO,SAAU,CAC5B,QAAS,OACT,OAAQ,OACR,MAAO,OACP,aAAc,OACd,QAAS,IACT,OAAQ,IACR,WAAY,UACZ,WAAY,OACZ,OAAQ,OACR,MAAO,QACP,OAAQ,UACR,WAAY,WACZ,gBAAiB,WACjB,OAAQ,iCACR,WAAY,OACZ,UAAW,yBAEX,gBAAiB,CACf,WAAY,GACd,EAEA,MAAO,CACL,aAAc,WACd,WAAY,IAEZ,eAAgB,CACd,aAAc,GAChB,CACF,EAEA,IAAK,CACH,OAAQ,MACR,MAAO,MACP,QAAS,MACT,KAAM,aACN,OAAQ,aACR,OAAQ,iCACR,WAAY,OACZ,UAAW,SACb,EAEA,mBAAoB,CAClB,gBAAiB,SACnB,EAEA,gBAAiB,CACf,mBAAoB,CAClB,IAAK,CACH,OAAQ,OACV,CACF,CACF,EAEA,eAAgB,CACd,UAAW,aAEX,mBAAoB,CAClB,IAAK,CACH,OAAQ,OACV,CACF,CACF,EAEA,UAAW,CACT,mBAAoB,CAClB,IAAK,CACH,OAAQ,QACV,CACF,CACF,CACF,CAAC,ECtEKmS,GAAenS,EAAOwB,GAAc,CACxC,SAAU,WACV,MAAO,OACP,IAAK,OACL,MAAO,OACP,OAAQ,IACR,QAAS,OACT,WAAY,SACZ,eAAgB,SAChB,UAAW,SACX,WAAY,OACZ,aAAc,MACd,gBAAiB,UACjB,OAAQ,UAER,mBAAoB,CAClB,gBAAiB,oBACnB,EAEA,SAAU,CACR,cAAe,CACb,KAAM,CACJ,UAAW,CACT,QAAS,GACX,CACF,EACA,MAAO,CAAC,CACV,EACA,QAAS,CACP,KAAM,CACJ,OAAQ,oBACV,CACF,CACF,EAEA,iBAAkB,CAChB,CACE,cAAe,GACf,QAAS,GACT,IAAK,CACH,IAAK,MACL,MAAO,MACP,MAAO,OACP,OAAQ,OACR,UAAW,qBACb,CACF,CACF,CACF,CAAC,EC/CK4Q,GAAiBpS,EAAO,MAAO,CACnC,SAAU,WACV,OAAQ,IACR,QAAS,OACT,cAAe,SACf,IAAK,OAEL,UAAW,CACT,CAAC,GAAGmS,EAAY,EAAE,EAAG,CACnB,gBAAiB,SACnB,EAEA,CAAC,GAAGD,EAAiB,EAAE,EAAG,CACxB,gBAAiB,QAEjB,IAAK,CACH,OAAQ,kBACV,CACF,CACF,CACF,CAAC,EAEKG,GAAiBrS,EAAO,MAAO,EAAE,ECtBjCsS,GAAmBtS,EAAO,MAAO,CACrC,OAAQ,OACR,MAAO,UACP,KAAM,UACN,OAAQ,UACR,QAAS,OACT,OAAQ,iBACV,CAAC,EAEKuS,GAAqBvS,EAAOwS,EAAO,QAAS,CAChD,SAAU,UACV,WAAY,MACZ,WAAY,UACZ,UAAW,aACX,SAAU,IACV,OAAQ,UACR,WAAY,OACZ,OAAQ,kBACR,UAAW,oBACX,aAAc,MACd,QAAS,OACT,WAAY,SACZ,YAAa,SACb,MAAO,OAEP,MAAO,CACL,SAAU,MACZ,CACF,CAAC,EAEKC,GAAsBzS,EAAOwS,EAAO,QAAS,CACjD,aAAc,MACd,UAAW,oBACX,gBAAiB,aACjB,UAAW,UACX,WAAY,MACZ,cAAe,UACf,UAAW,mCACX,oBAAqB,IACrB,OAAQ,4BACR,SAAU,MACZ,CAAC,EAEKE,GAAmB1S,EAAOwS,EAAO,KAAM,CAC3C,QAAS,OACT,WAAY,SACZ,WAAY,UACZ,QAAS,iBACT,MAAO,WACP,WAAY,MACZ,SAAU,YACV,OAAQ,UACR,gBAAiB,aACjB,MAAO,oBAEP,SAAU,CACR,WAAY,SACZ,aAAc,WACd,SAAU,QACZ,EAEA,0BAA2B,CACzB,WAAY,MACZ,MAAO,qBACT,EAEA,UAAW,CACT,MAAO,SACT,EAEA,IAAK,CACH,MAAO,OACP,OAAQ,OACR,YAAa,SACb,aAAc,KAChB,CACF,CAAC,EAEKG,GAAoB3S,EAAOwS,EAAO,MAAO,CAC7C,MAAO,gBACP,WAAY,UACZ,SAAU,UACV,QAAS,4BACT,QAAS,OACT,WAAY,SACZ,aAAc,UACd,aAAc,MACd,oBAAqB,IACrB,uBAAwB,IACxB,wBAAyB,IACzB,gBAAiB,iBACnB,CAAC,EAEKI,GAAe5S,EAAOwS,EAAO,KAAM,CACvC,SAAU,WACV,OAAQ,IACR,MAAO,MACT,CAAC,EC7FKK,GAAwC,CAAC,CAAE,UAAAC,EAAW,MAAAC,KAAY,CACtE,MAAMC,EAAU,IAEZha,EAAA,cAAC,OAAK,CAAA,EAAE,kIAAmI,CAAA,EAIzIia,EAAY,IAEdja,EAAA,cAAC,OAAK,CAAA,EAAE,kIAAmI,CAAA,EAK7I,OAAAA,EAAA,cAACsZ,GAAA,CACC,MAAM,6BACN,UAAU,QACV,QAAQ,cACR,KAAK,KAAA,EAELtZ,EAAA,cAAC,aAAO+Z,CAAM,EACbD,IAAc,MAAQ9Z,EAAA,cAACga,EAAQ,IAAA,EAC/BF,IAAc,QAAU9Z,EAAA,cAACia,EAAU,IAAA,CAAA,CAG1C,ECFMT,GAAgC,CAAC,CACrC,SAAAjZ,EACA,MAAAW,EACA,UAAAgZ,EACA,cAAAC,EACA,MAAA7V,CACF,IAEItE,EAAA,cAAC4Z,GAAa,CAAA,cAAAO,EAA8B,MAAA7V,CAC1C,EAAAtE,EAAA,cAACuZ,IAAmB,cAAY,eAAA,EAC7BvZ,EAAA,cAAAoa,cAAA,CAAY,cAAY,qBAAsB,CAAA,EAC9Cpa,EAAA,cAAA6Z,EAAA,WAAA,KACE7Z,EAAA,cAAAwX,GAAA,CAAK,UAAU,OAAO,MAAM,QAAS,CAAA,CACxC,CACF,EACAxX,EAAA,cAACqa,eACC,KAAAra,EAAA,cAACyZ,GAAA,CACC,IAAK,CAAE,UAAW,GAAGS,CAAS,aAAc,EAC5C,cAAY,gBAAA,EAEZla,EAAA,cAACsa,EAAAA,0BACEta,EAAA,cAAAwX,GAAA,CAAK,UAAU,KAAK,MAAM,oBAAqB,CAAA,CAClD,EACCxX,EAAA,cAAAua,iBAAA,KACEva,EAAA,cAAAwa,EAAAA,YAAA,KACEtZ,GACElB,EAAA,cAAA2Z,GAAA,KACE3Z,EAAA,cAAA0P,EAAA,CAAM,cAAY,eAAe,MAAAxO,CAAc,CAAA,CAClD,EAEDX,CACH,CACF,EACAP,EAAA,cAACya,EAAAA,4BACEza,EAAA,cAAAwX,GAAA,CAAK,UAAU,OAAO,MAAM,sBAAuB,CAAA,CACtD,CAEJ,CAAA,CACF,EClDEkD,GAAgBrL,GACnBrP,EAAA,cAAA0Z,GAAA,CAAkB,GAAGrK,CAAA,EACnBA,EAAM,WAAcrP,EAAA,cAAAyT,GAAA,CAAU,UAAWpE,EAAM,UAAW,EAC3DrP,EAAA,cAAC2a,iBACC,KAAA3a,EAAA,cAAC0P,EAAM,CAAA,MAAOL,EAAM,KAAO,CAAA,CAC7B,EACCrP,EAAA,cAAA4a,EAAAA,oBAAA,IAAoB,CACvB,ECxBIC,GAAY7T,EAAO,MAAO,CAC9B,SAAU,sBACV,OAAQ,IACR,IAAK,OACL,KAAM,OACN,MAAO,UACP,OAAQ,QACR,gBAAiB,QACjB,UAAW,oBACX,aAAc,MAEd,iBAAkB,CAChB,OAAQ,gCACR,UAAW,eACb,EAEA,MAAO,CACL,MAAO,QACP,OAAQ,MACV,EAEA,MAAO,CACL,MAAO,QACP,OAAQ,QACV,CACF,CAAC,EAEK8T,GAAW9T,EAAO,MAAO,CAC7B,SAAU,WACV,MAAO,OACP,OAAQ,OACR,OAAQ,GACV,CAAC,EAEKkB,GAAUlB,EAAO,MAAO,CAC5B,MAAO,OACP,OAAQ,SACR,UAAW,QACX,WAAY,QACZ,eAAgB,UAChB,MAAO,QACP,SAAU,WACV,OAAQ,IACR,SAAU,QACZ,CAAC,ECrCK2O,EAAgC,CAAC,CAAE,GAAApT,EAAI,MAAArB,EAAO,SAAAX,KAE/CP,EAAA,cAAA0I,GAAA,CAAK,GAAAnG,EAAQ,cAAY,wBACxBvC,EAAA,cAAC,MAAA,CACC,MAAM,6BACN,kBAAiB,GAAGuC,CAAE,aACtB,cAAY,2BACZ,UAAU,QACV,QAAQ,cACR,KAAK,KAAA,kBAEJ,QAAM,CAAA,GAAI,GAAGA,CAAE,cAAerB,CAAM,EACpCX,CAAA,CAEL,ECrBE2H,GAAUlB,EAAO,MAAO,CAC5B,SAAU,WACV,OAAQ,IACR,IAAK,OACL,QAAS,OAET,MAAO,CACL,cAAe,SACf,OAAQ,GACV,EAEA,SAAU,CACR,eAAgB,CACd,KAAM,CACJ,MAAO,WAEP,MAAO,CACL,IAAK,WACL,MAAO,MACT,CACF,EAEA,MAAO,CACL,MAAO,OAEP,MAAO,CACL,IAAK,OACL,MAAO,MACT,CACF,CACF,CACF,CACF,CAAC,EC7BK+T,GAAS,IAEX/a,EAAA,cAAC,OAAA,CACC,cAAc,QACd,iBAAiB,KACjB,YAAY,KACZ,EAAE,0BAAA,CAAA,EAKFgb,GAAU,IAEZhb,EAAA,cAAC,OAAA,CACC,cAAc,QACd,iBAAiB,KACjB,YAAY,KACZ,EAAE,cAAA,CAAA,EAKFib,GAAiB,IAEnBjb,EAAA,cAAC,OAAA,CACC,KAAK,OACL,OAAO,eACP,cAAc,QACd,eAAe,QACf,YAAY,KACZ,EAAE,8IAAA,CAAA,EAKFkb,GAAQ,IAEVlb,EAAA,cAAC,OAAK,CAAA,EAAE,4QAA6Q,CAAA,EAInRmb,GAAS,IAGTnb,EAAA,cAAAA,EAAA,SAAA,KAAAA,EAAA,cAAC,OAAA,CACC,KAAK,OACL,cAAc,QACd,iBAAiB,KACjB,YAAY,KACZ,EAAE,iHAAA,CAAA,EAEJA,EAAA,cAAC,OAAK,CAAA,EAAE,mHAAoH,CAAA,CAC9H,EAIEmW,GAAW,CAAC,CAChB,eAAAiF,EACA,QAAAC,CACF,IAKIrb,EAAA,cAACkI,GAAA,CACC,cAAY,yBACZ,eAAAkT,EACA,GAAG,wBAAA,EAEFC,EAAQ,iBAELrb,EAAA,cAAAA,EAAA,SAAA,KAAAA,EAAA,cAAC2V,GAAO,GAAG,SAAS,MAAM,SAAA,EACvB3V,EAAA,cAAA+a,GAAA,IAAO,CACV,EACA/a,EAAA,cAAC2V,GAAO,GAAG,UAAU,MAAM,UACzB,EAAA3V,EAAA,cAACgb,GAAQ,IAAA,CACX,CACF,EAEDK,EAAQ,qBACPrb,EAAA,cAAC2V,EAAO,CAAA,GAAG,WAAW,MAAM,WAAA,EACzB3V,EAAA,cAAAib,GAAA,IAAe,CAClB,EAEDI,EAAQ,qBAELrb,EAAA,cAAAA,EAAA,SAAA,KAAAA,EAAA,cAAC2V,GAAO,GAAG,cAAc,MAAM,cAAA,EAC5B3V,EAAA,cAAAmb,GAAA,IAAO,CACV,EACAnb,EAAA,cAAC2V,GAAO,GAAG,aAAa,MAAM,aAC5B,EAAA3V,EAAA,cAACmb,GAAO,IAAA,CACV,CACF,EAEDE,EAAQ,iBACPrb,EAAA,cAAC2V,EAAO,CAAA,GAAG,QAAQ,MAAM,OAAA,EACtB3V,EAAA,cAAAkb,GAAA,IAAM,CACT,CAAA,ECnFKI,GAAmB/Y,GAC9B,MAAM,GAAGA,EAAG,QAAQ,MAAO,EAAE,CAAC,YAAY,EACvC,KAAM2I,GAAaA,EAAS,KAAK,CAAC,EAClC,KAAMqQ,GAASA,CAAI,EACnB,MAAO9T,GAAe,CACb,QAAA,MACN,uBAAuBlF,EAAG,QACxB,MACA,EAAA,CACD,8BAA8BkF,CAAK,EAAA,CAExC,CAAC,EAEQ+T,GAAsBzL,GAAmC,CAChE,IAAAC,EACAyL,EAEA,GAAA,MAAM,QAAQ1L,CAAO,IACvBC,EAAeD,EAAQ,CAAC,EACpBC,GAAc,CACZ,IAAAzN,EACJ,QAASyN,EACJzN,EAAKyN,EAAa,KAAK,EACvBzN,EAAKyN,EAAa,GAELyL,EAAAlZ,CACpB,CAGK,OAAAkZ,CACT,ECjBMC,GAA0B,CAAC,CAC/B,IAAAC,EACA,eAAAP,EACA,UAAAQ,EACA,oBAAA5G,CACF,IAAM,SACJ,KAAM,CAAC6G,EAAQC,CAAS,EAAIzR,EAAiB,SAAA,EACvC,CAAC0R,EAAaC,CAAc,EAAI3R,EAAiB,SAAA,EACjDuB,EAAkClL,IAClC,CAAE,cAAA8D,EAAe,MAAA1D,EAAO,aAAAC,CAAA,EAAiB6K,EACzCpL,EAAgBI,IAChBI,EAA2BF,EAAM,IAAI,CACzC,GAAIC,EACJ,KAAM,QAAA,CACP,EAEKkb,EAAkB,CACtB,GAAI,0BAA0BF,CAAW,GACzC,kBAAmB,GACnB,eAAgB,WAChB,WAAY,QACZ,iBAAkB,aAClB,kBAAmB,cACnB,aAAc,SACd,cAAe,UACf,cAAe,GACf,oBAAqB,GACrB,gBAAiB,GACjB,oBAAqB,GACrB,gBAAiB,GACjB,qBAAsB,cACtB,YAAa,2BAA2BA,CAAW,GACnD,qBAAsB,CACpB,YAAa,GACb,eAAgB,GAChB,YAAa,GACb,aAAc,EAChB,EACA,GAAGvX,EAAc,cACjB,oBAAqBA,EAAc,eAAA,EAG/BtC,EAA2C,CAAA,EAkEjD,OAhEAF,GAAAnC,EAAAmV,EAAoB,CAAC,IAArB,YAAAnV,EAAwB,QAAxB,MAAAmC,EAA+B,QAASR,GAAS,CAC/C,MAAM0a,EAAqBpb,EAAM,IAAIU,EAAK,EAAE,EAC5CU,EAAY,KAAKga,CAAqD,CAAA,GAGxE3R,EAAAA,UAAU,IAAM,CACVoR,IAAQE,IACVC,EAAUH,CAAG,EACbK,EAAe5S,OAAQ,EACzB,EACC,CAACyS,EAAQF,CAAG,CAAC,EAEhBpR,EAAAA,UAAU,IAAM,OACd,GAAIsR,EACF,OAAQD,EAAW,CACjB,IAAK,cACG,MAAAzY,EAASH,EAAciZ,CAAM,EACnC9Y,EAAO,eAAe,CACpB,IAAK0Y,CAAA,CACN,EACQrb,EAAA,CACP,KAAM,4BACN,oBAAqB2C,CAAA,CACtB,GACGtD,EAAA2E,EAAc,qBAAd,MAAA3E,EAAkC,gBACpC0E,GACEpB,EACAnC,EACAwD,EACAtC,EACA,oBAAA,EAGJ,MACF,IAAK,aACHoZ,GAAgBO,CAAM,EAAE,KAAMM,GAAe,OACrChZ,MAAAA,EAASH,EAAciZ,CAAM,EACnC9Y,EAAO,cAAc,CACnB,WAAAgZ,CAAA,CACD,EACQ3b,EAAA,CACP,KAAM,4BACN,oBAAqB2C,CAAA,CACtB,GACGtD,EAAA2E,EAAc,qBAAd,MAAA3E,EAAkC,gBACpC0E,GACEpB,EACAnC,EACAwD,EACAtC,EACA,oBAAA,CAEJ,CACD,EACD,MACF,QACU,QAAA,KACN,oBAAoB2Z,CAAM,+BAA+BD,CAAS,GAAA,EAEpE,KACJ,CACF,EACC,CAACC,CAAM,CAAC,EAENE,EAGH/b,EAAA,cAACkI,GAAA,CACC,IAAK,CACH,gBAAiB1D,EAAc,sBAC/B,OAAQA,EAAc,YACxB,EACA,UAAU,4BACV,cAAY,2BAAA,EAEXxE,EAAA,cAAAmW,GAAA,CAAS,eAAAiF,EAAgC,QAASa,EAAQ,EAC1Djc,EAAA,cAAA6a,GAAA,CAAU,GAAI,2BAA2BkB,CAAW,GAAI,EACxD/b,EAAA,cAAA8a,GAAA,CAAS,GAAI,0BAA0BiB,CAAW,GAAI,CAAA,EAblC,IAgB3B,EC/IMK,GAA0C,CAAC,CAC/C,SAAAC,EACA,eAAAjB,EACA,oBAAApG,CACF,IAAM,CACJ,KAAM,CAAC4G,EAAWU,CAAY,EAAIjS,EAAwB,SAAA,EACpD,CAACsR,EAAKY,CAAM,EAAIlS,EAA6B,SAAA,EAEnDE,OAAAA,EAAAA,UAAU,IAAM,CACV,MAAM,QAAQ8R,GAAA,YAAAA,EAAU,OAAO,IAAKA,GAAA,YAAAA,EAAU,QAAQ,QAAS,GACjEC,EAAa,YAAY,EAClBC,EAAAf,GAAmBa,GAAA,YAAAA,EAAU,OAAO,CAAC,IAE5CC,EAAa,aAAa,EAC1BC,EAAOF,GAAA,YAAAA,EAAU,EAAE,EACrB,EACC,CAACA,CAAQ,CAAC,EAGXrc,EAAA,cAAC0b,GAAA,CACC,IAAAC,EACA,IAAKA,EACL,eAAAP,EACA,UAAAQ,EACA,oBAAA5G,CAAA,CAAA,CAGN,EC1BMwH,GAAuC,CAAC,CAC5C,QAAAC,EACA,MAAAvb,EACA,kBAAAwb,EACA,iBAAAC,CACF,IAAM,CACE,KAAA,CAAE,MAAA7b,GAAUJ,IAEZ2b,EAAW/Z,EAAoBxB,EAAO4b,CAAiB,EAEvDE,EAAcP,EAAWA,EAAS,CAAC,EAAI,OACvCQ,EAAe3b,EAChBiB,EAASjB,CAAK,EACf,CAAC,mBAAmB,EAGtB,OAAAlB,EAAA,cAACkZ,GAAA,CACC,QAAS,IAAMyD,EAAiB,EAAI,EACpC,QAAAF,EACA,UAAU,2BAAA,EAEVzc,EAAA,cAAC,MAAA,CACC,KAAK4c,GAAA,YAAAA,EAAa,KAAM,GACxB,IAAKC,EAAa,KAAK,EACvB,OAAQD,GAAA,YAAAA,EAAa,OACrB,MAAOA,GAAA,YAAAA,EAAa,KAAA,CACtB,CAAA,CAGN,ECzCaE,GAAyB9V,EAAO,SAAU,CACrD,SAAU,WACV,MAAO,OACP,OAAQ,OACR,OAAQ,GACV,CAAC,ECDK+V,GAAkB/c,EAAM,WAC5B,CAACgd,EAAQC,IAA2C,CAC5C,MAAAC,EAAYld,EAAM,OAA0B,IAAI,EAEhDmd,EAAkBtM,EAAAA,YAAY,IAAM,SAExC,IAAIhR,EAAAod,EAAI,UAAJ,MAAApd,EAAa,eAAemC,EAAAib,EAAI,UAAJ,YAAAjb,EAAa,aAAc,EAAG,OAE9D,MAAMsI,EAAQ2S,EAAI,QAClB,GAAI,CAAC3S,EAAO,OAEN,MAAA3J,EAAU,IAAI,aACdyc,EAAMzc,EAAQ,yBAAyB2J,CAAK,EAC5C+S,EAAW1c,EAAQ,iBAEnBK,EAASkc,EAAU,QACzB,GAAI,CAAClc,EAAQ,OACbA,EAAO,MAAQsJ,EAAM,YACrBtJ,EAAO,OAASsJ,EAAM,aAChB,MAAAgT,EAAMtc,EAAO,WAAW,IAAI,EAElCoc,EAAI,QAAQC,CAAQ,EACXA,EAAA,QAAQ1c,EAAQ,WAAW,EAEpC0c,EAAS,QAAU,IAEnB,MAAME,EAAeF,EAAS,kBACxBG,EAAY,IAAI,WAAWD,CAAY,EAE7C,YAAY,UAAY,CACtBE,EACEJ,EACAC,EACAC,EACAC,EACAxc,EAAO,MACPA,EAAO,MAAA,GAER,EAAE,CAAA,EACJ,CAACic,CAAG,CAAC,EAERjd,EAAM,UAAU,IAAM,CAChB,CAACid,GAAO,CAACA,EAAI,UAGjBA,EAAI,QAAQ,OAASE,EAAA,EACpB,CAACA,EAAiBF,CAAG,CAAC,EAEzB,SAASQ,EACPJ,EACAC,EACAC,EACAC,EACA9a,EACAC,EACA,CACM,MAAA+a,EAAYhb,EAAQ6a,EAAgB,IACtC,IAAAI,EACAzZ,EAAI,EAERmZ,EAAS,qBAAqBG,CAAS,EAEvCF,EAAI,UAAY,UAChBA,EAAI,SAAS,EAAG,EAAG5a,EAAOC,CAAM,EAEhC,QAAS6K,EAAI,EAAGA,EAAI+P,EAAc/P,IACpBmQ,EAAAH,EAAUhQ,CAAC,EAAI,EACvB8P,EAAA,UAAY,uBAChBA,EAAI,SAASpZ,EAAGvB,EAASgb,EAAWD,EAAUC,CAAS,EAEvDzZ,GAAKwZ,EAAW,CAEpB,CAEA,OAAQ1d,EAAA,cAAA8c,GAAA,CAAuB,IAAKI,EAAW,KAAK,cAAe,CAAA,CACrE,CACF,EChFaU,GAAgB5W,EAAO,MAAO,CACzC,SAAU,WACV,gBAAiB,cACjB,QAAS,OACT,SAAU,IACV,WAAY,IACZ,UAAW,QACX,OAAQ,IAER,MAAO,CACL,gBAAiB,cACjB,UAAW,UACX,MAAO,OACP,OAAQ,OACR,SAAU,WACV,OAAQ,GACV,CACF,CAAC,ECTK6W,GAA8B,CAAC,CAAE,SAAA9b,EAAU,oBAAA+b,KAA0B,CACzE,MAAM5c,EAAQiB,EAASJ,EAAS,MAA8B,IAAI,EAM9D,OAHF,MAAM,QAAQb,CAAK,GACnBA,EAAM,KAAMoD,GAAkBwZ,EAAoB,SAASxZ,CAAK,CAAC,EAE7C,KAGpBtE,EAAA,cAAC,QAAA,CACC,IAAK+B,EAAS,GACd,IAAKA,EAAS,GACd,MAAO,MAAM,QAAQb,CAAK,EAAIA,EAAM,CAAC,EAAIA,EACzC,QAAQ,KACR,cAAY,cAAA,CAAA,CAGlB,ECRM6c,GAAgC,CAAC,CACrC,WAAAC,EACA,oBAAAhJ,EACA,SAAAqH,CACF,IAAM,CACJ,KAAM,CAAC7R,EAAayT,CAAc,EAAIje,EAAM,SAAiB,CAAC,EACxD,CAACke,EAAQC,CAAS,EAAIne,EAAM,SAA6B,EACzDoe,EAAYpe,EAAM,OAAyB,IAAI,EAC/Cqe,GAAUhC,GAAA,YAAAA,EAAU,QAAS,QAE7BzQ,EAAkClL,IAClC,CAAE,aAAAK,EAAc,cAAAyD,EAAe,MAAA1D,CAAA,EAAU8K,EAM/CrB,OAAAA,EAAAA,UAAU,IAAM,CAKd,GAAI,CAAC8R,EAAS,IAAM,CAAC+B,EAAU,QAAS,OAExC,GAAIA,GAAA,MAAAA,EAAW,QAAS,CACtB,MAAM9T,EAA0B8T,EAAU,QAC1C9T,EAAM,IAAM+R,EAAS,GACrB/R,EAAM,KAAK,CACb,CAMA,GAAI+R,EAAS,GAAG,MAAM,GAAG,EAAE,QAAU,OAAQ,OAG7C,MAAMJ,EAAS,CAEb,SAAU,SAAUqC,EAAKpQ,EAAK,CACxBoQ,EAAA,gBAAkB,CAAC,CAAC9Z,EAAc,eACxC,CAAA,EAIIiM,EAAM,IAAIC,EAAIuL,CAAM,EACtB,OAAAxL,EAAA,YAAY2N,EAAU,OAAO,EACjC3N,EAAI,GAAGC,EAAI,OAAO,eAAgB,UAAY,CACxCD,EAAA,WAAW4L,EAAS,EAAY,CAAA,CACrC,EAGD5L,EAAI,GAAGC,EAAI,OAAO,MAAO,SAAUC,EAAOxF,EAAM,CAC9C,GAAIA,EAAK,MACP,OAAQA,EAAK,KAAM,CACjB,KAAKuF,EAAI,WAAW,cAEV,QAAA,MACN,SAASC,CAAK,4CAAA,EAEhBF,EAAI,UAAU,EACd,MACF,KAAKC,EAAI,WAAW,YACV,QAAA,MACN,SAASC,CAAK,0CAAA,EAEhBF,EAAI,kBAAkB,EACtB,MACF,QAEEA,EAAI,QAAQ,EACZ,KACJ,CACF,CACD,EAEM,IAAM,CACP,GAAAA,GAAO2N,EAAU,QAAS,CAC5B,MAAM9T,EAA0B8T,EAAU,QAC1C3N,EAAI,YAAY,EAChBA,EAAI,QAAQ,EACZnG,EAAM,YAAc,CACtB,CAAA,GAED,CAAC9F,EAAc,gBAAiB6X,EAAS,EAAE,CAAC,EAE/C9R,EAAAA,UAAU,IAAM,aACR,MAAAvJ,EAA2BF,EAAM,IAAIC,CAAY,EACjDwd,GAAqB1e,EAAAmB,EAAO,qBAAP,MAAAnB,EAA2B,GAClDyC,EAAoBxB,GAAOkB,EAAAhB,EAAO,qBAAP,YAAAgB,EAA2B,EAAE,EACxD,KAEE0a,GAAoBjW,EAAAzF,EAAO,oBAAP,MAAAyF,EAA0B,GAChDnE,EAAoBxB,GAAO4F,EAAA1F,EAAO,oBAAP,YAAA0F,EAA0B,EAAE,EACvD,KAEsB,CAAC,EAAE6X,GAAsB7B,GAI7CyB,EADY3T,IAAA,EACFkS,EAAkB,CAAC,EAAE,GACrB6B,EAAmB,CAAC,EAAE,EADC,GAGjCA,GAA8BJ,EAAAI,EAAmB,CAAC,EAAE,EAAE,EACtD7B,GAA6ByB,EAAAzB,EAAkB,CAAC,EAAE,EAAE,EAEzD,EAAA,CAAC3b,EAAcyJ,EAAa1J,CAAK,CAAC,EAErCyJ,EAAAA,UAAU,IAAM,CACd,GAAI6T,GAAA,MAAAA,EAAW,QAAS,CACtB,MAAM9T,EAA0B8T,EAAU,QACnC,OAAA9T,GAAA,MAAAA,EAAA,iBAAiB,aAAc,IACpC2T,EAAe3T,EAAM,WAAW,GAG3B,IAAM,SAAS,oBAAoB,aAAc,IAAM,CAAA,CAAE,CAClE,CACF,EAAG,CAAE,CAAA,EAGHtK,EAAA,cAAC4d,GAAA,CACC,IAAK,CACH,gBAAiBpZ,EAAc,sBAC/B,UAAWA,EAAc,aACzB,SAAU,UACZ,EACA,cAAY,iBACZ,UAAU,8BAAA,EAEVxE,EAAA,cAAC,QAAA,CACC,GAAG,oBACH,IAAKqc,EAAS,GACd,IAAK+B,EACL,SAAQ,GACR,OAAQ/B,EAAS,OACjB,MAAOA,EAAS,MAChB,YAAY,YACZ,OAAA6B,EACA,MAAO,CACL,UAAW1Z,EAAc,aACzB,SAAU,WACV,OAAQ,GACV,CAAA,EAECwZ,EAAW,IAAK3B,mBACd,SAAO,CAAA,IAAKA,EAAS,GAAI,KAAMA,EAAS,OAAQ,IAAKA,EAAS,GAAI,CACpE,GACArH,GAAA,YAAAA,EAAqB,QAAS,GAC7BA,EAAoB,IAAK/T,GAAmB,CAC1C,MAAMud,EAAqD,CAAA,EAE5C,OAAAvd,EAAA,MAAM,QAASY,GAAe,CACdf,EAAM,IACjCe,EAAW,EAAA,EAGQ,KAAK,QAASiK,GAAS,CAC1C,MAAMhK,EAAiBhB,EAAM,IAC3BgL,EAAK,EAAA,EAEP0S,EAAiB,KAAK1c,CAAc,CAAA,CACrC,CAAA,CACF,EAEM0c,EAAiB,IAAK1S,GAEzB9L,EAAA,cAAC6d,GAAA,CACC,SAAU/R,EACV,oBAAqBtH,EAAc,qBAAuB,CAAC,EAC3D,IAAKsH,EAAK,EAAA,CAAA,CAGf,CAAA,CACF,EAAE,sDAEP,EAECuS,GAAWre,EAAA,cAAC+c,GAAgB,CAAA,IAAKqB,EAAW,CAAA,CAGnD,EC/LMnI,GAAY,IAEdjW,EAAA,cAAC,MAAA,CACC,MAAM,6BACN,kBAAgB,kBAChB,UAAU,QACV,QAAQ,cACR,KAAK,KAAA,EAEJA,EAAA,cAAA,QAAA,CAAM,GAAG,iBAAA,EAAkB,OAAK,EACjCA,EAAA,cAAC,OAAK,CAAA,EAAE,4HAA6H,CAAA,CAAA,EAKrIye,GAAW,CAAC,CAAE,QAAAhC,KAEhBzc,EAAA,cAAC,MAAA,CACC,MAAM,6BACN,kBAAgB,iBAChB,UAAU,QACV,QAAQ,cACR,KAAK,KAAA,EAEJA,EAAA,cAAA,QAAA,CAAM,GAAG,gBAAA,EAAiB,MAAI,EAE9Byc,EACEzc,EAAA,cAAA,OAAA,CAAK,EAAE,gMAAiM,CAAA,EAGvMA,EAAA,cAAAA,EAAA,SAAA,KAAAA,EAAA,cAAC,OAAK,CAAA,EAAE,oYAAoY,EAC5YA,EAAA,cAAC,OAAK,CAAA,EAAE,iYAAkY,CAAA,CAC5Y,CAAA,EAMF0e,GAAgC,CAAC,CACrC,aAAAC,EACA,cAAAC,EACA,QAAAnC,CACF,IAEIzc,EAAA,cAACmZ,GAAA,CACC,QAASwF,EACT,cAAAC,EACA,QAAAnC,EACA,cAAY,oBAAA,EAEXmC,EAAiB5e,EAAA,cAAAiW,GAAA,IAAU,EAAKjW,EAAA,cAACye,IAAS,QAAAhC,EAAkB,CAAA,ECvC7DoC,GAAoC,CAAC,CACzC,aAAA9d,EACA,oBAAAiU,EACA,QAAAyH,EACA,SAAAJ,CACF,IAAM,WACJ,KAAM,CAACyC,EAAiBC,CAAkB,EAAI/e,EAAM,SAAiB,CAAC,EAChE,CAAC4e,EAAejC,CAAgB,EAAI3c,EAAM,SAAS,EAAK,EACxD,CAAE,cAAAwE,EAAe,eAAAwa,EAAgB,MAAAle,GAAUJ,EAAe,EAE1Due,EAAqCne,EAAM,IAAIC,CAAY,EAE3D2b,GAAoB7c,EAAAof,GAAA,YAAAA,EAAkB,oBAAlB,YAAApf,EAAqC,GACzDub,EAAiB,EAAQsB,EACzBwC,GAAoB7C,GAAA,YAAAA,EAAU,QAAS,EACvC8C,EAAkBzC,GAAqB,CAACkC,GAAiB,CAACnC,EAE1DkC,EAAe,IAAMhC,EAAiB,CAACiC,CAAa,EAEpDQ,EAAsB9a,GAAU,CACpC,MAAMiC,EAAQ8V,EAAS,UAAWta,GAAaA,EAAS,KAAOuC,CAAK,EACpEya,EAAmBxY,CAAK,CAAA,EAMpB8Y,EAAgBL,EAAe,KAAMK,GAAkB,OAC3D,IAAIC,EAAQ,GACZ,KAAM,CAAE,SAAAvS,EAAU,eAAAwS,GAAmBF,EAAc,OAMnD,GAJI,MAAM,QAAQtS,CAAQ,GAAKA,EAAS,OAAS,IACvCuS,EAAAvS,EAAS,SAAShM,CAAY,GAGpC,MAAM,QAAQwe,CAAc,GAAKA,EAAe,OAAS,EAAG,CAC9D,MAAMC,IAAS3f,EAAAwc,EAASyC,CAAe,IAAxB,YAAAjf,EAA2B,SAAU,GACpDyf,EAAQ,GAAQE,GAAUD,EAAe,SAASC,CAAM,EAC1D,CACO,OAAAF,CAAA,CACR,EAEKG,GAAkBzd,EAAAqd,GAAA,YAAAA,EAAe,UAAf,YAAArd,EACpB,UAGF,OAAAhC,EAAA,cAACoZ,GAAe,CAAA,UAAU,wBACxB,EAAApZ,EAAA,cAACqZ,GAAA,CACC,MAAO,CACL,gBAAiB7U,EAAc,sBAC/B,UAAWA,EAAc,YAC3B,CAAA,EAECkY,GAAqB,CAACD,GACrBzc,EAAA,cAAC0e,GAAA,CACC,aAAAC,EACA,cAAAC,EACA,QAAAnC,CAAA,CACF,EAED0C,GAAmB,CAAC1C,GACnBzc,EAAA,cAACwc,GAAA,CACC,QAAAC,EACA,MAAOwC,GAAA,YAAAA,EAAkB,MACzB,kBAAAvC,EACA,iBAAAC,CAAA,CACF,EAID,CAACwC,GACA,CAACE,IACA5C,EACCzc,EAAA,cAAC+d,GAAA,CACC,WAAY1B,EACZ,SAAUA,EAASyC,CAAe,EAClC,oBAAA9J,CAAA,CAAA,EAGFqH,GACErc,EAAA,cAACoc,GAAA,CACC,SAAUC,EAASyC,CAAe,EAClC,eAAA1D,EACA,IAAKra,EACL,oBAAAiU,CAAA,CAAA,GAMP,CAACmK,GAAmBM,GACnBzf,EAAA,cAACyf,EAAA,CACC,GAAI1e,EACJ,eAAgBsb,EAASyC,CAAe,EACvC,GAAGO,GAAA,YAAAA,EAAe,QAAQ,cAAA,CAC7B,CAAA,EAIHH,GACClf,EAAA,cAACwZ,GAAA,CACC,OAAO/S,EAAA4V,EAASyC,CAAe,IAAxB,YAAArY,EAA2B,GAClC,cAAe2Y,EACf,UAAW,OAAA,EAEV/C,GAAA,YAAAA,EAAU,IAAKta,GACd/B,EAAA,cAAC0a,GAAA,CACC,MAAO3Y,GAAA,YAAAA,EAAU,GACjB,IAAKA,GAAA,YAAAA,EAAU,GACf,MAAOA,GAAA,YAAAA,EAAU,KAAA,CAAA,EAEpB,CAGP,CAEJ,ECtGM2d,GAA8C,CAAC,CACnD,aAAA3e,EACA,oBAAAiU,EACA,iBAAApH,EACA,yBAAAC,EACA,sBAAAoH,EACA,aAAA0K,EACA,MAAAhV,EACA,SAAA0R,CACF,IAAM,CACJ,KAAM,CAAE,gBAAAuD,EAAiB,cAAApb,CAAc,EAAI9D,EAAe,EACpD,CAAE,iBAAAwU,CAAqB,EAAA1Q,EAOvBqb,GACJ3K,GAAA,YAAAA,EAAkB,eACjBA,GAAA,YAAAA,EAAkB,mBAAoBF,EAAoB,OAAS,GACpEC,EAGA,OAAAjV,EAAA,cAAC4H,GAAA,CACC,UAAU,wBACV,cAAY,uBAAA,kBAEXC,GACC,KAAA7H,EAAA,cAAC6e,GAAA,CACC,aAAA9d,EACA,oBAAAiU,EACA,QAAS2K,EACT,SAAAtD,CAAA,CAAA,EAGDwD,GACC7f,EAAA,cAAC8H,GACC,KAAA9H,EAAA,cAAC,YAAM4f,EAAkB,aAAe,kBAAmB,CAC7D,EAGDjV,EAAM,OAAS,GACd3K,EAAA,cAAC2H,GAAa,CAAA,UAAU,6BACtB,EAAA3H,EAAA,cAACwY,IAAM,MAAA7N,EAAc,WAAY,CAAG,CAAA,CACtC,CAEJ,EACCiV,GAAmBC,GACjB7f,EAAA,cAAAiI,GAAA,qBACED,GACC,KAAAhI,EAAA,cAAC+U,GAAA,CACC,aAAAhU,EACA,oBAAAiU,EACA,iBAAApH,EACA,yBAAAC,EACA,sBAAAoH,CAAA,CAAA,CAEJ,CACF,CAAA,CAIR,EC7FM6K,GAAkB9Y,EAAO4Q,EAAQ,QAAS,CAC9C,MAAO,OACP,QAAS,KACX,CAAC,EAEKmI,GAAmB/Y,EAAO4Q,EAAQ,QAAS,CAC/C,QAAS,OACT,cAAe,SACf,SAAU,YACV,OAAQ,OACR,UAAW,oBACX,OAAQ,IAER,OAAQ,CACN,QAAS,OACT,eAAgB,OAChB,aAAc,QACd,MAAO,aACP,OAAQ,UACR,WAAY,aACZ,OAAQ,OAEP,eAAiB,CAChB,aAAc,GAChB,CACF,CACF,CAAC,EAEKoI,GAAgBhZ,EAAO,OAAQ,CACnC,SAAU,UACV,UAAW,aACX,SAAU,IACV,WAAY,IACZ,QAAS,OAET,MAAO,CACL,SAAU,MACZ,EAEA,oBAAqB,CACnB,SAAU,WACV,MAAO,MACP,OAAQ,MACR,QAAS,IACT,OAAQ,OACR,SAAU,SACV,KAAM,mBACN,WAAY,SACZ,OAAQ,GACV,CACF,CAAC,EAEKiZ,GAASjZ,EAAO,SAAU,CAC9B,QAAS,OACT,gBAAiB,yBACjB,eAAgB,gBAChB,WAAY,aACZ,MAAO,OAEP,CAAC,KAAK4S,EAAY,EAAE,EAAG,CACrB,SAAU,IACV,WAAY,GACd,EAEA,KAAM,CACJ,SAAU,IACV,WAAY,GACd,CACF,CAAC,EAEKsG,GAAgBlZ,EAAO,MAAO,CAClC,QAAS,OACT,WAAY,WACZ,eAAgB,WAChB,QAAS,OACT,WAAY,IACZ,SAAU,GACZ,CAAC,EC3EKmZ,GAAuB,IAAM,OACjC,MAAM3f,EAAgBI,IAChBgL,EAAmBlL,IAEnB,CAAE,eAAA6T,EAAgB,WAAA6L,EAAY,cAAA5b,EAAe,MAAA1D,GAAU8K,EACvDsO,EAAY1V,GAAA,YAAAA,EAAe,aAE3BgR,EAAqB6K,GAAuB,CACvC7f,EAAA,CACP,KAAM,uBACN,WAAA6f,CAAA,CACD,CAAA,EAGH,uBACG,MAAI,CAAA,MAAO,CAAE,OAAQ,YACpBrgB,EAAA,cAACwZ,GAAA,CACC,MAAO4G,EAAW,MAClB,UAAAlG,EACA,MAAO3F,EACP,cAAeiB,CAAA,GAEd3V,EAAAugB,GAAA,YAAAA,EAAY,QAAZ,YAAAvgB,EAAmB,IAAK2B,GACvBxB,EAAA,cAAC0a,GAAA,CACC,MAAOlZ,EAAK,GACZ,IAAKA,EAAK,GACV,UAAWA,GAAA,MAAAA,EAAM,UAAYV,EAAM,IAAIU,GAAA,YAAAA,EAAM,SAAS,EAAI,OAC1D,MAAOA,EAAK,KAAA,CAAA,EAEf,CAEL,CAEJ,ECnCa8e,GAAqB,CAChC1V,EACA2V,EAAgB,OACa,CAC7B,KAAM,CAACC,EAAYC,CAAa,EAAIpW,EAAqB,SAAA,EACnDqW,EAAO7P,EAAAA,YAAY,IAAM,CACnB,UAAA,UAAU,UAAUjG,CAAI,EAAE,KAClC,IAAM6V,EAAc,QAAQ,EAC5B,IAAMA,EAAc,QAAQ,CAAA,CAC9B,EACC,CAAC7V,CAAI,CAAC,EAETL,OAAAA,EAAAA,UAAU,IAAM,CACd,GAAI,CAACiW,EACH,OAGF,MAAMG,EAAY,WAAW,IAAMF,EAAc,MAAS,EAAGF,CAAa,EAEnE,MAAA,IAAM,aAAaI,CAAS,CAAA,EAClC,CAACH,CAAU,CAAC,EAER,CAACA,EAAYE,CAAI,CAC1B,ECvBME,GAAS5Z,EAAO,OAAQ,CAC5B,QAAS,OACT,aAAc,SACd,WAAY,SACZ,QAAS,qBACT,UAAW,YACX,WAAY,SACZ,gBAAiB,UACjB,MAAO,aACP,aAAc,MACd,SAAU,YACV,cAAe,YACf,WAAY,KACd,CAAC,EAEK6Z,GAAmD,CAAC,CAAE,OAAAC,KACrDA,EAEG9gB,EAAA,cAAA4gB,GAAA,CAAO,mBAAkBE,CAAA,EAASA,CAAO,EAF7B,KAKTC,GAAiE,CAAC,CAC7E,WAAAC,EACA,WAAAC,CACF,IAAM,CACJ,KAAM,CAACT,EAAYU,CAAQ,EAAIZ,GAAmBW,CAAU,EAE1D,OAAAjhB,EAAA,cAAC,SAAO,CAAA,QAASkhB,CACd,EAAAF,EAAW,IAAEhhB,EAAA,cAAA6gB,GAAA,CAAe,OAAQL,CAAY,CAAA,CACnD,CAEJ,ECjCMW,GAAsB,IAAM,CAChC,MAAMC,EAAM,UACNC,EAAO,UAEb,uBACG,MAAI,CAAA,QAAQ,0BAA0B,GAAG,YAAY,QAAQ,KAC5D,EAAArhB,EAAA,cAAC,aAAM,uBAAqB,kBAC3B,IAAE,CAAA,UAAU,gDACVA,EAAA,cAAA,IAAA,CAAE,UAAU,YACX,EAAAA,EAAA,cAAC,OAAA,CACC,MAAO,CAAE,KAAMqhB,CAAK,EACpB,EAAE,mEAAA,CAEJ,EAAArhB,EAAA,cAAC,OAAA,CACC,MAAO,CAAE,KAAMqhB,CAAK,EACpB,EAAE,sMAAA,CAEJ,EAAArhB,EAAA,cAAC,OAAA,CACC,MAAO,CAAE,KAAMohB,CAAI,EACnB,EAAE,mEAAA,CAEJ,EAAAphB,EAAA,cAAC,OAAA,CACC,MAAO,CAAE,KAAMohB,CAAI,EACnB,EAAE,2LAAA,CAEJ,EAAAphB,EAAA,cAAC,OAAA,CACC,MAAO,CAAE,KAAMqhB,CAAK,EACpB,EAAE,mEAAA,CAEJ,EAAArhB,EAAA,cAAC,OAAA,CACC,MAAO,CAAE,KAAMqhB,CAAK,EACpB,EAAE,uLAAA,CAEJ,EAAArhB,EAAA,cAAC,OAAA,CACC,MAAO,CAAE,KAAMohB,CAAI,EACnB,EAAE,2KAAA,CAEN,CAAA,CACF,CACF,CAEJ,ECvCME,GAAeta,EAAOua,GAAO,KAAM,CACvC,IAAK,QACL,OAAQ,OACR,MAAO,WACP,gBAAiB,QACjB,aAAc,SACd,SAAU,WACV,wBAAyB,cACzB,OAAQ,UAER,UAAW,CACT,UAAW,yBACb,EAEA,0BAA2B,CACzB,gBAAiB,UACjB,UAAW,yBACb,CACF,CAAC,EAEKC,GAAcxa,EAAOua,GAAO,MAAO,CACvC,QAAS,QACT,OAAQ,oBACR,MAAO,oBACP,gBAAiB,aACjB,aAAc,OACd,UAAW,oBACX,WAAY,OACZ,UAAW,kBACX,WAAY,YAEZ,0BAA2B,CACzB,UAAW,kCACb,CACF,CAAC,EAEK7R,GAAQ1I,EAAO,QAAS,CAC5B,SAAU,YACV,WAAY,MACZ,WAAY,MACZ,WAAY,OACZ,OAAQ,UACR,aAAc,UAChB,CAAC,EAEKya,GAAeza,EAAO,OAAQ,CAClC,QAAS,OACT,WAAY,IACZ,SAAU,IACV,WAAY,SACZ,WAAY,UACd,CAAC,EC9CK0X,GAAS,IAAM,OACb,KAAA,CAAE,cAAAla,GAAkB9D,IACpBF,EAAgBI,IAEhB,CAAC8gB,EAASC,CAAU,EAAItX,EAAS,UAAAxK,EAAA2E,GAAA,YAAAA,EAAe,mBAAf,YAAA3E,EAAiC,IAAI,EAE5E0K,OAAAA,EAAAA,UAAU,IAAM,CACL/J,EAAA,CACP,KAAM,wBACN,gBAAiBkhB,CAAA,CAClB,CAAA,EACA,CAACA,CAAO,CAAC,EAGT1hB,EAAA,cAAAyhB,GAAA,KACEzhB,EAAA,cAAA0P,GAAA,CAAM,QAAQ,qBAAqB,IAAKgS,EAAU,CAAE,QAAS,GAAI,EAAI,CAAA,GAAI,kBAE1E,EACA1hB,EAAA,cAACshB,GAAA,CACC,QAAAI,EACA,gBAAiB,IAAMC,EAAW,CAACD,CAAO,EAC1C,GAAG,qBACH,aAAW,2BACX,KAAK,UAAA,kBAEJF,GAAY,IAAA,CAAA,CAEjB,CAEJ,ECpCaI,GAAiBC,GAAuB,CACnD,MAAMvC,EAAQ,IACP,OAAO,WAGL,OAAO,WAAWuC,CAAU,EAAE,QAF5B,GAKL,CAACC,EAASC,CAAU,EAAI1X,WAAkBiV,CAAK,EAErD/U,OAAAA,EAAAA,UAAU,IAAM,CACR,MAAA1G,EAAU,IAAMke,EAAWzC,CAAK,EAC/B,cAAA,iBAAiB,SAAUzb,CAAO,EAClC,IAAM,OAAO,oBAAoB,SAAUA,CAAO,CAAA,CAC1D,EAEMie,CACT,ECMME,GAAgC,CAAC,CAAE,WAAA3B,EAAY,cAAA4B,KAAoB,CACvE,MAAMrW,EAAkClL,IAClC,CAAE,WAAA0f,EAAY,cAAA5b,CAAkB,EAAAoH,EAEhC,CAAE,UAAAsW,EAAW,cAAAC,EAAe,iBAAAjN,CAAA,EAAqB1Q,EAKjD4d,EAAaD,IAAiBjN,GAAA,YAAAA,EAAkB,cAChDmN,EAAkBT,GAAc7a,GAAM,EAAE,EAE9C,uBACGkZ,GAAO,CAAA,UAAU,wBACfG,GAAA,MAAAA,EAAY,sBACVD,GAAW,IAAA,EAEXngB,EAAA,cAAAggB,GAAA,CAAc,UAAYkC,EAAgC,GAApB,iBACpC,EAAAA,mBAAcxS,EAAM,CAAA,MAAOuS,EAAe,UAAU,QAAQ,CAC/D,EAEDG,GACEpiB,EAAA,cAAAkgB,GAAA,KACEiC,GACEniB,EAAA,cAAA4X,EAAA,KACE5X,EAAA,cAAA8f,GAAA,qBACEqB,GAAU,IAAA,CACb,EACCnhB,EAAA,cAAA+f,GAAA,MACEK,GAAA,YAAAA,EAAY,QACXpgB,EAAA,cAAC,SAAA,CACC,QAAU8M,GAAM,CACdA,EAAE,eAAe,EACV,OAAA,KAAKsT,EAAW,GAAI,QAAQ,CACrC,CAAA,EACD,iBAIH,EAAApgB,EAAA,cAAC,SAAA,CACC,QAAU8M,GAAM,CACdA,EAAE,eAAe,EACV,OAAA,KAAKuT,EAAY,QAAQ,CAClC,CAAA,EACD,eAED,EAAU,KACTD,GAAA,YAAAA,EAAY,QACXpgB,EAAA,cAAC+gB,GAAA,CACC,WAAW,sBACX,WAAYX,EAAW,EAAA,CAG3B,EAAApgB,EAAA,cAAC+gB,GAAA,CACC,WAAW,oBACX,WAAYV,CAAA,CAEhB,CAAA,CACF,GAEDnL,GAAA,YAAAA,EAAkB,eAAgB,CAACmN,GAAmBriB,EAAA,cAAC0e,GAAO,IAAA,CACjE,CAEJ,CAEJ,ECtFa4D,GAAgB,CAACC,EAAgB,KAAsB,CAClE,KAAM,CAACC,EAAQC,CAAS,EAAIpY,WAASkY,CAAa,EAElDG,OAAAA,EAAAA,gBAAgB,IAAM,CACpB,GAAI,CAACF,EACH,OAGI,MAAAG,EAAmB,SAAS,gBAAgB,MAAM,SAE/C,gBAAA,gBAAgB,MAAM,SAAW,SAEnC,IAAM,CACF,SAAA,gBAAgB,MAAM,SAAWA,CAAA,CAC5C,EACC,CAACH,CAAM,CAAC,EAEXjY,EAAAA,UAAU,IAAM,CACViY,IAAWD,GACbE,EAAUF,CAAa,CACzB,EACC,CAACA,CAAa,CAAC,EAEX,CAACC,EAAQC,CAAS,CAC3B,ECeMG,GAAgC,CAAC,CACrC,SAAApO,EACA,MAAA1N,EACA,kBAAA+b,CACF,IAAM,OAIJ,MAAMjX,EAAkClL,IAClCoiB,EAAsBliB,IACtB,CACJ,aAAAG,EACA,gBAAA6e,EACA,MAAA9e,EACA,mBAAAM,EACA,cAAAoD,EACA,oBAAAqH,CACE,EAAAD,EAME,CAACmX,EAAoBC,CAAqB,EAAI3Y,WAAkB,EAAK,EACrE,CAACsV,EAAcsD,CAAe,EAAI5Y,WAAS,EAAK,EAChD,CAACgS,EAAU6G,CAAW,EAAI7Y,EAAA,SAAoC,CAAE,CAAA,EAChE,CAAC2K,EAAqBmO,CAAsB,EAChD9Y,EAAA,SAA8B,CAAE,CAAA,EAC5B,CAAC4K,EAAuBpH,CAAwB,EACpDxD,EAA6B,SAAA,EAEzB,CAAC+Y,EAAcC,CAAe,EAAIf,GAAc,EAAK,EACrDD,EAAkBT,GAAc7a,GAAM,EAAE,EACxC,CAAC6G,EAAkB0V,CAAmB,EAAIjZ,EAAS,SAAA,EAEnDkZ,EAAqB1S,EAAA,YACxB2S,GAAkB,CACFV,EAAA,CACb,KAAM,wBACN,gBAAiBU,CAAA,CAClB,CACH,EACA,CAACV,CAAc,CAAA,EAGjBvY,EAAAA,UAAU,IAAM,QACV1K,EAAA2E,GAAA,YAAAA,EAAe,mBAAf,MAAA3E,EAAiC,MACnC0jB,EAAmB,CAAClB,CAAe,CACrC,EACC,CACDA,GACAxiB,EAAA2E,GAAA,YAAAA,EAAe,mBAAf,YAAA3E,EAAiC,KACjC0jB,CAAA,CACD,EAEDhZ,EAAAA,UAAU,IAAM,CACd,GAAI,CAAC8X,EAAiB,CACpBgB,EAAgB,EAAK,EACrB,MACF,CACAA,EAAgBzD,CAAe,CAC9B,EAAA,CAACA,EAAiByC,EAAiBgB,CAAe,CAAC,EAEtD9Y,EAAAA,UAAU,IAAM,CACR8R,MAAAA,EAAW/Z,EAAoBxB,EAAOC,CAAY,EAEpDsb,IACF4G,EACE,CAAC,QAAS,OAAO,EAAE,QAAQ5G,EAAS,CAAC,EAAE,IAA6B,EAClE,EAEE,EAEN6G,EAAY7G,CAAQ,GAGC8G,EAAAtiB,GAAuBC,EAAOC,CAAY,CAAC,EAE5CiiB,EAAAhO,EAAoB,SAAW,CAAC,GACrD,CAACjU,EAAciU,EAAoB,OAAQlU,CAAK,CAAC,EAGpDyJ,EAAAA,UAAU,IAAM,aACVsY,IAAsB,UACtBhjB,EAAA2E,EAAc,mBAAd,YAAA3E,EAAgC,uBAAwB,IAE5DsB,GACEC,EACAyhB,GACApc,IAAAzE,GAAAwC,EAAc,aAAd,YAAAxC,GAA0B,gBAA1B,YAAAyE,GAAyC,QAAA,EACzC,KAAMgd,IAAkB,CACxB5V,EAAyB4V,EAAa,CAAA,CACvC,CACA,EAAA,CAACZ,EAAmBzhB,EAAoBoD,CAAa,CAAC,EAGzD+F,EAAAA,UAAU,IAAM,CAEd,GADI,CAACsB,GACD,CAACoJ,EAAuB,OAEtB,MAAAjU,EAA2BF,EAAM,IAAI,CACzC,GAAIC,EACJ,KAAM,QAAA,CACP,EAED4F,GAAyBkF,EAAqB,wBAAwB,EACtE6X,GACEtiB,EACA6T,EACApJ,EACA7K,EACAwD,CAAA,CACF,EACC,CACDpD,EACAoD,EACAqH,EACA9K,EACAD,EACAmU,CAAA,CACD,EAEK,MAAA0O,EAAmBnP,EAAS,QAAQ,KACvCzE,GAAiBA,EAAQ,OAAS,gBAAA,EAIrCxF,OAAAA,EAAAA,UAAU,IAAM,CACd,GAAIoZ,EAAkB,CACd,MAAAC,EAAqBpP,EAAS,QAAQ,KACzCzE,IAAiBA,GAAQ,OAAS,gBAAA,EAEjC6T,GACFN,EAAoBM,EAAc,EAAE,CAExC,CAAA,EACC,CAACpP,EAAUmP,CAAgB,CAAC,EAG7B3jB,EAAA,cAAC6jB,GAAc,cAAA,CAAA,kBAAmBrc,EAChC,EAAAxH,EAAA,cAACkI,GAAA,CACC,UAAW,GAAGpB,CAAK,iBACnB,IAAK,CAAE,WAAYtC,GAAA,YAAAA,EAAe,UAAW,EAC7C,mBAAkB4e,EAClB,yBAAwBL,EACxB,8BAA6BnD,CAAA,EAE7B5f,EAAA,cAAC+H,GAAY,KAAZ,CACC,KAAM6X,EACN,aAAc2D,CAAA,EAEdvjB,EAAA,cAACgiB,GAAA,CACC,cAAexN,EAAS,MACxB,WAAYA,EAAS,EAAA,CACvB,EACAxU,EAAA,cAAC0f,GAAA,CACC,aAAA3e,EACA,SAAAsb,EACA,oBAAArH,EACA,iBAAApH,EACA,yBAAAC,EACA,sBAAAoH,EACA,MAAOT,EAAS,MAChB,aAAAmL,CAAA,CACF,CACF,CAAA,CAEJ,CAEJ,EAIA,SAAS+D,GACPtiB,EACAqiB,EACA5X,EACA7K,EACAwD,EACA,OACA,MAAMtC,EAA2C,CAAA,GAClCrC,EAAA4jB,GAAA,YAAAA,EAAA,QAAA,MAAA5jB,EAAO,QAAS2B,GAAS,CACtC,MAAMK,EAAaT,EAAmB,IAAII,EAAK,EAAE,EAE7C,OAAOK,EAAW,QAAW,UAC3BA,EAAW,OAAO,WAAWb,EAAO,EAAE,GACxCkB,EAAY,KAAKL,CAA6C,CAElE,GAGEgK,GACFtH,GACEsH,EACA7K,EACAwD,EACAtC,EACA,wBAAA,CAGN,CC1OO,MAAM4hB,GAA0B,CACrC,YAAa,GACb,QAAS,CACP,OAAQ,+CACV,EACA,QAAS,IACT,gBAAiB,EACnB,EAWA,SAASC,GAAezF,EAAoC,CACnD,MAAA,CACL,GAAIA,EAAI,QAAU,KAAOA,EAAI,OAAS,IACtC,OAAQA,EAAI,OACZ,WAAYA,EAAI,WAChB,QAASA,EAAI,sBAAsB,EACnC,KAAMA,EAAI,aACV,KAAM,IAAS,KAAK,MAAMA,EAAI,YAAY,CAAA,CAE9C,CAEA,SAAS0F,GACP1F,EACA5W,EAAyB,KACV,CACR,MAAA,CACL,GAAI,GACJ,OAAQ4W,EAAI,OACZ,WAAYA,EAAI,WAChB,QAASA,EAAI,sBAAsB,EACnC,KAAM5W,GAAW4W,EAAI,WACrB,KAAM,IAAS,KAAK,MAAM5W,GAAW4W,EAAI,UAAU,CAAA,CAEvD,CAEgB,SAAA2F,GACd/V,EACAmN,EAA0ByI,GAC1B,CACM,MAAAI,EAAU7I,EAAQ,SAAWyI,GAAwB,QAE3D,OAAO,IAAI,QAAuB,CAACK,EAASC,IAAW,CAC/C,MAAA9F,EAAM,IAAI,eACZA,EAAA,KAAK,MAAOpQ,CAAG,EACnBoQ,EAAI,gBAAkBjD,EAAQ,gBAE1B6I,GACK,OAAA,KAAKA,CAAO,EAAE,QAAS7kB,GAC5Bif,EAAI,iBAAiBjf,EAAK6kB,EAAQ7kB,CAAG,CAAC,CAAA,EAI1Cif,EAAI,OAAS,IAAM,CACT6F,EAAAJ,GAAezF,CAAG,CAAC,CAAA,EAG7BA,EAAI,QAAU,IAAM,CACX8F,EAAAJ,GAAc1F,EAAK,yBAAyB,CAAC,CAAA,EAGtDA,EAAI,UAAY,IAAM,CACb8F,EAAAJ,GAAc1F,EAAK,oCAAoC,CAAC,CAAA,EAGjEA,EAAI,KAAK,CAAA,CACV,CACH,CCxDM,MAAA+F,GAA4C,CAAC,CACjD,iBAAAC,EAAmB,IAAM,CAAC,EAC1B,eAAAtF,EAAiB,CAAC,EAClB,YAAAuF,EACA,YAAAC,EACA,GAAAjiB,EACA,WAAA8d,EACA,QAAAhF,EACA,kBAAAwH,CACF,IAAM,OAOJ,IAAI4B,EAAeD,EACf,OAAAjiB,IAAmBkiB,EAAAliB,GACnB8d,IAA2BoE,EAAApE,GAG7BrgB,EAAA,cAACK,GAAA,CACC,aAAc,CACZ,GAAGT,EACH,eAAAof,EACA,gBAAiB,IAAQnf,EAAAwb,GAAA,YAAAA,EAAS,mBAAT,MAAAxb,EAA2B,MACpD,MAAO,IAAIC,GAAAA,MAAM,CACf,cAAgBoO,GACd+V,GAAW/V,EAAK,CACd,gBAAiBmN,GAAA,YAAAA,EAAS,gBAC1B,QAASA,GAAA,YAAAA,EAAS,cAAA,CACnB,EAAE,KAAMnQ,GAAa,KAAK,MAAMA,EAAS,IAAI,CAAC,CAAA,CAClD,CACH,CAAA,EAEAlL,EAAA,cAAC0kB,GAAA,CACC,YAAaD,EACb,iBAAAH,EACA,YAAAC,EACA,QAAAlJ,EACA,kBAAAwH,CAAA,CACF,CAAA,CAGN,EAEM6B,GAA4C,CAAC,CACjD,iBAAAJ,EACA,YAAAC,EACA,YAAAC,EACA,QAAAnJ,EACA,kBAAAwH,CACF,IAAM,CACJ,MAAMriB,EAAgBI,IAMhB+jB,EAAQjkB,IACR,CAAE,aAAAK,EAAc,eAAAwT,EAAgB,SAAAqQ,EAAU,MAAA9jB,GAAU6jB,EACpD,CAACF,EAAcI,CAAe,EAAIxa,EAEtC,SAAA,EACI,CAACmK,EAAUC,CAAW,EAAIpK,EAA6B,SAAA,EAK7D,IAAIvD,EAAQ,CAAA,EAmFZ,OAlFIyd,IAAqBzd,EAAAK,GAAA,YAAY,SAAUod,CAAW,GAM1Dha,EAAAA,UAAU,IAAM,CACV+Z,GAAkBA,EAAiBvjB,CAAY,CAAA,EAClD,CAACA,EAAcujB,CAAgB,CAAC,EAEnC/Z,EAAAA,UAAU,IAAM,CACVgK,GACFzT,EACG,aAAayT,CAAc,EAC3B,KAAMpJ,GAA6B,CAClCsJ,EAAYtJ,CAAI,EACP3K,EAAA,CACP,KAAM,qBACN,SAAU2K,EAAK,MAAM,CAAC,GAAKA,EAAK,MAAM,CAAC,EAAE,EAAA,CAC1C,CAAA,CACF,EACA,MAAO1D,GAAiB,CACf,QAAA,MAAM,4BAA4BA,CAAK,EAAE,CAAA,CAClD,EACA,QAAQ,IAAM,CACJjH,EAAA,CACP,KAAM,iBACN,SAAU,EAAA,CACX,CAAA,CACF,CACJ,EAAA,CAAC+T,EAAgB/T,EAAUM,CAAK,CAAC,EAEpCyJ,EAAAA,UAAU,IAAM,CACL/J,EAAA,CACP,KAAM,sBACN,cAAe6a,CAAA,CAChB,EAEDva,EACG,KAAK0jB,CAAW,EAChB,KAAMrZ,GAAoD,CACzD0Z,EAAgB1Z,CAAI,CAAA,CACrB,EACA,MAAO1D,GAAiB,CACf,QAAA,MACN,qBAAqB+c,CAAW,oBAAoB/c,CAAK,EAAA,CAC3D,CACD,GACF,CAACjH,EAAUgkB,EAAanJ,EAASva,CAAK,CAAC,EAE1CyJ,EAAAA,UAAU,IAAM,CACd,IAAIua,EAAsB,CAAA,GAEtBL,GAAA,YAAAA,EAAc,QAAS,cAChBjkB,EAAA,CACP,KAAM,mBACN,WAAYikB,CAAA,CACb,EAEDK,EAAYL,EAAa,MACtB,OAAQjjB,GAASA,EAAK,OAAS,UAAU,EACzC,IAAKgT,GAAaA,EAAS,EAAE,EAE5BsQ,EAAU,OAAS,GACZtkB,EAAA,CACP,KAAM,uBACN,WAAYskB,EAAU,CAAC,CAAA,CACxB,IAEML,GAAA,YAAAA,EAAc,QAAS,YACvBjkB,EAAA,CACP,KAAM,uBACN,WAAYikB,EAAa,EAAA,CAC1B,CACH,EACC,CAACjkB,EAAUikB,CAAY,CAAC,EAOtBG,EAUD,CAACpQ,GAAY,CAACA,EAAS,OACjB,QAAA,IAAI,qBAAqBgQ,CAAW,kBAAkB,EACrDxkB,EAAA,cAAAA,EAAA,SAAA,IAAA,GASPwU,EAAS,MAAS,SAAW,GACvB,QAAA,IAAI,qBAAqBgQ,CAAW,6BAA6B,EAChExkB,EAAA,cAAAA,EAAA,SAAA,IAAA,GAUTA,EAAA,cAAC4iB,GAAA,CACC,SAAApO,EACA,MAAA1N,EACA,IAAK0N,EAAS,GACd,kBAAAqO,CAAA,CAAA,kCArCoB,SAAO,CAwCjC"}